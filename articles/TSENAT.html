<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TSENAT: Tsallis Entropy Analysis Toolbox • TSENAT</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TSENAT: Tsallis Entropy Analysis Toolbox">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TSENAT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa far fa-file-code fa-lg"></span> Functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT"><span class="fa fab fa-github fa-lg"></span> Source Code</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/issues"><span class="fa fas fa-question-circle fa-lg"></span> Issues</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html"><span class="fa fas fa-file-contract fa-lg"></span> Vignettes</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignette-files" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book fa-lg"></span> Vignette Files</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignette-files">
<li><a class="dropdown-item" href="../articles/TSENAT.pdf">PDF (vignette)</a></li>
    <li><a class="dropdown-item" href="../articles/TSENAT.html">HTML (vignette)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>TSENAT: Tsallis Entropy Analysis Toolbox</h1>
                        <h4 data-toc-skip class="author">Cristóbal
Gallardo <a href="mailto:gallardoalba@pm.me" class="email">gallardoalba@pm.me</a>
</h4>
            
            <h4 data-toc-skip class="date">2026-02-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gallardoalba/TSENAT/blob/HEAD/vignettes/TSENAT.Rmd" class="external-link"><code>vignettes/TSENAT.Rmd</code></a></small>
      <div class="d-none name"><code>TSENAT.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette shows how to compute and apply Tsallis entropy to
transcript-level expression data with <code>TSENAT</code>. It focuses on
three practical goals: (1) computing per-sample, per-gene diversity
measures across a range of sensitivity parameters <code>q</code>; (2)
comparing those measures between sample groups; and (3) visualizing and
inspecting transcript-level patterns that explain observed
differences.</p>
<div class="section level3">
<h3 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h3>
<p>Common RNA-seq tools, such as DESEQ2 o SALMON, focus on changes in
total gene abundance. While powerful, that view can obscure an important
biological phenomenon: genes often change <em>which</em> isoforms they
express without large changes in overall expression. Tsallis entropy
gives you a single, coherent framework to describe those changes. By
tuning the parameter <code>q</code> you slide a lens across abundance
scales—zooming in on rare variants or zooming out to the dominant
isoforms—so you can capture scale-dependent isoform switching that
ordinary summaries overlook.</p>
</div>
<div class="section level3">
<h3 id="high-level-workflow">High-level workflow<a class="anchor" aria-label="anchor" href="#high-level-workflow"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Preprocess counts and filter low-abundance transcripts.</li>
<li>Compute relative transcript proportions within each gene and
evaluate Tsallis entropy across one or more <code>q</code> values.</li>
<li>Summarize per-gene values across samples (mean/median) and test for
differences between groups (Wilcoxon or permutations).</li>
<li>Visualize q-curves and inspect transcript-level counts for top
genes.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="what-is-tsallis-entropy">What is Tsallis entropy?<a class="anchor" aria-label="anchor" href="#what-is-tsallis-entropy"></a>
</h2>
<p>Tsallis entropy is a one-parameter family of diversity measures that
generalizes Shannon entropy via a sensitivity parameter <code>q</code>.
For a discrete probability vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">p=(p_1,\dots,p_n)</annotation></semantics></math>
it is defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>q</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>p</mi><mi>i</mi><mi>q</mi></msubsup></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
S_q(p) = \frac{1-\sum_{i=1}^n p_i^q}{q-1}.
</annotation></semantics></math></p>
<p>In information theory terms, entropy measures the uncertainty when
drawing a single transcript from the gene’s isoform frequency
distribution: higher entropy means the choice is less predictable (many
similarly abundant isoforms), while lower entropy means the distribution
is dominated by one or a few transcripts.</p>
<p>Tsallis entropy allows, throught the <code>q</code> parameter, shifts
emphasis between rare and abundant isoforms: small values of
<code>q</code> make the measure sensitive to low-abundance variants,
while larger <code>q</code> focus on the dominant species. In practice,
computing <code>S_q</code> across a short grid of <code>q</code> values
(a “q-curve”) and combining this with resampling or paired designs
yields a concise, interpretable summary of isoform heterogeneity.</p>
<p><strong>Essential limiting cases</strong>:</p>
<ul>
<li>Limit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q\to 1</annotation></semantics></math>:
Shannon entropy,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">lim</mi><mo>⁡</mo></mrow><mrow><mi>q</mi><mo>→</mo><mn>1</mn></mrow></msub><msub><mi>S</mi><mi>q</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>−</mi><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>p</mi><mi>i</mi></msub><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\lim_{q\to1} S_q(p) = -\sum_i p_i\log
p_i</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">q=0</annotation></semantics></math>:
richness-like (number of expressed isoforms minus one).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">q=2</annotation></semantics></math>:
Gini–Simpson / collision index,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mo>∑</mo><mi>i</mi></msub><msubsup><mi>p</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">S_2 = 1-\sum_i p_i^2</annotation></semantics></math>.</li>
<li>Uniform maximum: for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
expressed isoforms,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>q</mi><mo>,</mo><mi mathvariant="normal">max</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mi>m</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msup><mi>m</mi><mrow><mn>1</mn><mo>−</mo><mi>q</mi></mrow></msup></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_{q,\max}(m)=\frac{1-m^{1-q}}{q-1}</annotation></semantics></math>
and normalized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>S</mi><mo accent="true">̃</mo></mover><mi>q</mi></msub><mo>=</mo><msub><mi>S</mi><mi>q</mi></msub><mi>/</mi><msub><mi>S</mi><mrow><mi>q</mi><mo>,</mo><mi mathvariant="normal">max</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mi>m</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\tilde S_q = S_q / S_{q,\max}(m)</annotation></semantics></math>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-dataset">Example dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h2>
<p>An example dataset is included for demonstration.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gallardoalba.github.io/TSENAT">TSENAT</a></span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="load-data-and-metadata">Load data and metadata<a class="anchor" aria-label="anchor" href="#load-data-and-metadata"></a>
</h3>
<p>Now we will load the example dataset and associated metadata:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required files</span></span>
<span><span class="va">coldata_tsv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"coldata.tsv"</span>, package <span class="op">=</span> <span class="st">"TSENAT"</span><span class="op">)</span></span>
<span><span class="va">tx2gene_tsv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tx2gene.tsv"</span>, package <span class="op">=</span> <span class="st">"TSENAT"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tcga_brca_luma_dataset"</span>, package <span class="op">=</span> <span class="st">"TSENAT"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract gene names and read count data</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">tcga_brca_luma_dataset</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">readcounts</span> <span class="op">&lt;-</span> <span class="va">tcga_brca_luma_dataset</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Read sample metadata</span></span>
<span><span class="va">coldata_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">coldata_tsv</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The next step is to inspect the loaded data to ensure it looks
correct.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check gene names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MXRA8"   "MXRA8"   "MXRA8"   "MXRA8"   "MXRA8"   "C1orf86"</span></span>
<span></span>
<span><span class="co"># Check read count dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">readcounts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1100   40</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">readcounts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   TCGA-A7-A0CH_N TCGA-A7-A0CH_T TCGA-A7-A0D9_N</span></span>
<span><span class="co">#&gt; 1        2858.04         743.56         812.59</span></span>
<span><span class="co">#&gt; 2         127.82          21.28          50.87</span></span>
<span><span class="co">#&gt; 3         370.22          94.38         368.76</span></span>
<span><span class="co">#&gt; 4        7472.00        3564.87        7647.76</span></span>
<span></span>
<span><span class="co"># Check the metadata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">coldata_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Sample Condition</span></span>
<span><span class="co">#&gt; 1 TCGA-A7-A0CH_N    Normal</span></span>
<span><span class="co">#&gt; 2 TCGA-A7-A0D9_N    Normal</span></span>
<span><span class="co">#&gt; 3 TCGA-A7-A0DB_N    Normal</span></span>
<span><span class="co">#&gt; 4 TCGA-A7-A0DC_N    Normal</span></span>
<span><span class="co">#&gt; 5 TCGA-A7-A13G_N    Normal</span></span>
<span><span class="co">#&gt; 6 TCGA-AC-A2FB_N    Normal</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preprocessing-and-filtering">Data preprocessing and filtering<a class="anchor" aria-label="anchor" href="#data-preprocessing-and-filtering"></a>
</h3>
<p>If the transcript IDs in <code>readcounts</code> are not already set
as rownames, we need to map them. This step could be skipped if the
dataset already has transcript IDs as rownames, but in this case we need
to assign them.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign transcript IDs as rownames of `readcounts`</span></span>
<span><span class="va">readcounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_tx_to_readcounts.html">map_tx_to_readcounts</a></span><span class="op">(</span><span class="va">readcounts</span>, <span class="va">tx2gene_tsv</span><span class="op">)</span></span></code></pre></div>
<p>Next, we will create a a <code>SummarizedExperiment</code> data
container, a standard Bioconductor class for storing high-throughput
assay data along with associated metadata. You can read more about it in
the <a href="https://bioconductor.org/packages/release/bioc/html/SummarizedExperiment.html" class="external-link">Bioconductor
documentation</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Build a `SummarizedExperiment` from readcounts + tx2gene mapping</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_se.html">build_se</a></span><span class="op">(</span><span class="va">tx2gene_tsv</span>, <span class="va">readcounts</span>, <span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<p>Before computing the Tsallis diversity, you might want to filter out
genes with a low overall expression or limit the analysis to transcripts
with a sufficient minimum expression level. Expression estimates of
transcript isoforms with zero or low expression might be highly
variable. For more details on the effect of transcript isoform
prefiltering on differential transcript usage, see <a href="https://doi.org/10.1186/s13059-015-0862-3" class="external-link">this paper</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Filter lowly-expressed transcripts and report counts</span></span>
<span><span class="co"># Keep transcripts with &gt;5 reads in more than 5 samples using `filter_se()`</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_se.html">filter_se</a></span><span class="op">(</span><span class="va">se</span>, min_count <span class="op">=</span> <span class="fl">5</span>, min_samples <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Transcripts: before = 1100, after = 848</span></span></code></pre></div>
<p>We filtered lowly-expressed transcripts to reduce noise and improve
the stability of diversity estimates.</p>
</div>
</div>
<div class="section level2">
<h2 id="compute-normalized-tsallis-entropy-">Compute normalized Tsallis entropy.<a class="anchor" aria-label="anchor" href="#compute-normalized-tsallis-entropy-"></a>
</h2>
<p>Now we will compute Tsallis entropy for a single <code>q</code>, and
inspect the resulting assay.</p>
<p>Note: For single‑condition studies (no comparison groups), Tsallis
entropy can still be computed and used for descriptive analyses and
quality control; formal group‑comparison tests are not applicable in
this setting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute Tsallis entropy for a single q value (normalized)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">ts_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_diversity.html">calculate_diversity</a></span><span class="op">(</span><span class="va">se</span>, q <span class="op">=</span> <span class="va">q</span>, norm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ts_se</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         TCGA-A7-A0CH_N TCGA-A7-A0CH_T TCGA-A7-A0D9_N</span></span>
<span><span class="co">#&gt; MXRA8        0.8616275      0.6609111      0.8156972</span></span>
<span><span class="co">#&gt; C1orf86      0.0000000      0.0000000      0.0000000</span></span>
<span><span class="co">#&gt; PDPN         0.2657489      0.2588286      0.0000000</span></span>
<span><span class="co">#&gt; ALDH4A1      0.8111864      0.4667361      0.8621495</span></span></code></pre></div>
<p>An additional important technical factor is the data normalization,
which makes values comparable across genes with different numbers of
isoforms.</p>
<p>Now we should map the sample metadata into the
<code>SummarizedExperiment</code> object (ts_se), so plotting functions
and downstream helpers can rely on it.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_metadata.html">map_metadata</a></span><span class="op">(</span><span class="va">ts_se</span>, <span class="va">coldata_df</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="differential-analysis">Differential analysis<a class="anchor" aria-label="anchor" href="#differential-analysis"></a>
</h2>
<p>This section summarizes practical guidance for hypothesis testing and
reporting when comparing diversity measures across sample groups.</p>
<p>The package integrate diverse tests for comparing per-gene diversity
summaries between two groups. Two common choices are Wilcoxon-based
tests and label-shuffle tests.</p>
<p>Here we will use the <strong>Wilcoxon test</strong>; it is the
appropriate choice for speed when sample sizes support asymptotic
approximations, and it is robust to non-normality. The
<strong>label-shuffling test</strong> is a non-parametric alternative
that does not rely on distributional assumptions and can be more
accurate for small sample sizes, but it is computationally
intensive.</p>
<p>For the analyses shown in this vignette we recommend using the
<strong>median</strong> in the <strong>Wilcoxon</strong> rank-sum test
for comparisons. The reason is that Tsallis entropy values are often
skewed and sensitive to outliers, and the median provides in this
condition a more robust summary of central tendency than the mean.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute differences between groups using the Wilcoxon test</span></span>
<span><span class="co"># with median aggregation</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_difference.html">calculate_difference</a></span><span class="op">(</span></span>
<span>    <span class="va">ts_se</span>,</span>
<span>    control <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    test <span class="op">=</span> <span class="st">"wilcoxon"</span>,</span>
<span>    paired <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># sort results by adjusted p-value</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">adjusted_p_values</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;        genes Tumor_median Normal_median median_difference log2_fold_change</span></span>
<span><span class="co">#&gt; 6   C1orf213   0.07256896    0.98702527       -0.91445631     -3.765662496</span></span>
<span><span class="co">#&gt; 17     S1PR1   0.99315946    0.99930867       -0.00614921     -0.008904999</span></span>
<span><span class="co">#&gt; 88      MBD2   0.55929534    0.07256896        0.48672638      2.946185792</span></span>
<span><span class="co">#&gt; 99      OSR1   0.79339202    0.66364511        0.12974692      0.257621943</span></span>
<span><span class="co">#&gt; 102    GFPT1   0.07256896    0.58345094       -0.51088198     -3.007186825</span></span>
<span><span class="co">#&gt; 128     KIF9   0.58141625    0.37105427        0.21036198      0.647941169</span></span>
<span><span class="co">#&gt;     raw_p_values adjusted_p_values</span></span>
<span><span class="co">#&gt; 6   0.0002357454        0.02721101</span></span>
<span><span class="co">#&gt; 17  0.0007285418        0.02721101</span></span>
<span><span class="co">#&gt; 88  0.0006535852        0.02721101</span></span>
<span><span class="co">#&gt; 99  0.0005801974        0.02721101</span></span>
<span><span class="co">#&gt; 102 0.0008919014        0.02721101</span></span>
<span><span class="co">#&gt; 128 0.0006356242        0.02721101</span></span></code></pre></div>
<p>After the statistical test, in order to visualize the results and
inspect the most significant genes, we can generate two kind of
diagnostic plots: MA and volcano plots.</p>
<p>First we will plot a <strong>Tsallis-based MA</strong>, which uses
the Tsallis entropy values directly to compute fold changes and mean
expression. This plot provides a direct view of how diversity
differences relate to overall expression levels.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MA plot (Tsallis-based)</span></span>
<span><span class="va">p_ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_ma_tsallis.html">plot_ma_tsallis</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_ma</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/ma-tsallis-1.png" class="r-plt" alt="" width="960"></p>
<p>Second, we will plot an <strong>expression/readcount-based
MA</strong>, which uses the original read counts to compute fold changes
and mean expression. This plot helps to contextualize diversity
differences in terms of overall gene expression levels.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MA plot (expression/readcount-based)</span></span>
<span><span class="va">p_ma_read</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_ma_expression.html">plot_ma_expression</a></span><span class="op">(</span></span>
<span>    <span class="va">res</span>,</span>
<span>    se <span class="op">=</span> <span class="va">ts_se</span>,</span>
<span>    control <span class="op">=</span> <span class="st">"Normal"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_ma_read</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/ma-readcounts-1.png" class="r-plt" alt="" width="960"></p>
<p>On the other hands, the <strong>volcano plot</strong> displays the
relationship between the magnitude of diversity differences (mean
difference) and their statistical significance (adjusted p-value). This
plot helps to identify genes with both large effect sizes and strong
statistical support.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Volcano plot: mean difference vs -log10(adjusted p-value)</span></span>
<span><span class="va">p_volcano</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_volcano.html">plot_volcano</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_volcano</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/volcanoplot-1.png" class="r-plt" alt="" width="960"></p>
<div class="section level3">
<h3 id="plot-top-3-genes-from-the-single-q-differential-analysis">Plot top 3 genes from the single-q differential analysis<a class="anchor" aria-label="anchor" href="#plot-top-3-genes-from-the-single-q-differential-analysis"></a>
</h3>
<p>Here we will visualize the transcript-level expression for the most
significant genes identified in the previous step.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot using median aggregation; let the function pick top genes from `res`</span></span>
<span><span class="va">p_median</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_top_transcripts.html">plot_top_transcripts</a></span><span class="op">(</span><span class="va">ts_se</span>,</span>
<span>    res <span class="op">=</span> <span class="va">res</span>, top_n <span class="op">=</span> <span class="fl">3</span>, metric <span class="op">=</span> <span class="st">"median"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_median</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/top-transcripts-singleq-1.png" class="r-plt" alt="" width="960"></p>
<p>We can also plot the same top genes but using variance aggregation
instead of median. This allows us to see how transcript-level expression
variability differs between groups for these genes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot using variance aggregation</span></span>
<span><span class="va">p_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_top_transcripts.html">plot_top_transcripts</a></span><span class="op">(</span><span class="va">ts_se</span>,</span>
<span>    res <span class="op">=</span> <span class="va">res</span>, top_n <span class="op">=</span> <span class="fl">3</span>, metric <span class="op">=</span> <span class="st">"variance"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/top-transcripts-singleq-variance-1.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="compare-between-q-values">Compare between q values<a class="anchor" aria-label="anchor" href="#compare-between-q-values"></a>
</h2>
<p>Now we are going to try a different approach. In instead of evaluate
the sificant estatistical differences by using single Tsalis
<code>q</code> values, we will compute the normalized Tsallis entropy
for two <code>q</code> values (0.1 and 2) to studiy potential
scale-dependent patterns.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute Tsallis entropy for q = 1 (normalized)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">ts_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_diversity.html">calculate_diversity</a></span><span class="op">(</span><span class="va">se</span>,</span>
<span>    q <span class="op">=</span> <span class="va">q</span>, norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ts_se</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         TCGA-A7-A0CH_N_q=0.1 TCGA-A7-A0CH_N_q=2 TCGA-A7-A0CH_T_q=0.1</span></span>
<span><span class="co">#&gt; MXRA8              0.8616275          0.6063802            0.6609111</span></span>
<span><span class="co">#&gt; C1orf86            0.0000000          0.0000000            0.0000000</span></span>
<span><span class="co">#&gt; PDPN               0.2657489          0.6205367            0.2588286</span></span>
<span><span class="co">#&gt; ALDH4A1            0.8111864          0.7478309            0.4667361</span></span></code></pre></div>
<p>Once again, we should map the sample metadata into the multi-q
<code>SummarizedExperiment</code>. This step is important to ensure that
functions located downstream in the workflow can access the sample
metadata correctly.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_metadata.html">map_metadata</a></span><span class="op">(</span><span class="va">ts_se</span>, <span class="va">coldata_df</span><span class="op">)</span></span></code></pre></div>
<p>In order to show the distributional differences between groups, we
are going to create <strong>violin and density plots</strong>.</p>
<p>The violin plot shows the distribution of Tsallis entropy values for
each group and q value, allowing us to visually assess differences in
diversity patterns between groups at different sensitivity levels.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_violin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tsallis_violin_multq.html">plot_tsallis_violin_multq</a></span><span class="op">(</span><span class="va">ts_se</span>, assay_name <span class="op">=</span> <span class="st">"diversity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_violin</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/plots-violin-1.png" class="r-plt" alt="" width="960"></p>
<p>The density plot provides a equivalent view of the distribution of
Tsallis entropy values, showing the density of samples across the range
of diversity values for each group and q value.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tsallis_density_multq.html">plot_tsallis_density_multq</a></span><span class="op">(</span><span class="va">ts_se</span>, assay_name <span class="op">=</span> <span class="st">"diversity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_density</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/plots-density-1.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level2">
<h2 id="tsallis-q-sequence-and-linear-model-interaction-tests">Tsallis q-sequence and linear-model interaction tests<a class="anchor" aria-label="anchor" href="#tsallis-q-sequence-and-linear-model-interaction-tests"></a>
</h2>
<p>FInally, we can test for interactions between <code>q</code> and
sample groups across a sequence of <code>q</code> values
(<code>q-sequence</code>), that is, whether the shape of the q-curve
differs between groups. This approach is a powerful way to detect
scale-dependent diversity differences that may not be apparent at a
single <code>q</code> value.</p>
<p>Computing Tsallis entropy across a sequence of <code>q</code> values
is important because <code>q</code> acts as a sensitivity lens that
shifts emphasis between rare and dominant isoforms. Thus, the resulting
<strong>q-curve</strong> can help us identify at which scales (i.e. for
which <code>q</code> values) the diversity differences between groups
are most pronounced.</p>
<p>The Tsallis q-sequence can also be help with quality control and
outlier detection. By examining the q-curves of individual samples, we
can identify samples that deviate from expected patterns, which may
indicate technical issues or biological outliers.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute Tsallis entropy for a sequence of values (normalized)</span></span>
<span><span class="va">qvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">ts_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_diversity.html">calculate_diversity</a></span><span class="op">(</span><span class="va">se</span>,</span>
<span>    q <span class="op">=</span> <span class="va">qvec</span>, norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">ts_se</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         TCGA-A7-A0CH_N_q=0.1 TCGA-A7-A0CH_N_q=0.15 TCGA-A7-A0CH_N_q=0.2</span></span>
<span><span class="co">#&gt; MXRA8              0.8616275             0.8073925            0.7611249</span></span>
<span><span class="co">#&gt; C1orf86            0.0000000             0.0000000            0.0000000</span></span>
<span><span class="co">#&gt; PDPN               0.2657489             0.2738368            0.2820625</span></span>
<span><span class="co">#&gt; ALDH4A1            0.8111864             0.7506492            0.7056995</span></span></code></pre></div>
<p>Map once again the sample metadata into the multi-q
<code>SummarizedExperiment</code> as before.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For paired designs ensure sample_base is created so LMMs can use it</span></span>
<span><span class="va">ts_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_metadata.html">map_metadata</a></span><span class="op">(</span><span class="va">ts_se</span>, <span class="va">coldata_df</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Once we have the <code>q-sequence</code> computed, we can test for
interactions between <code>q</code> and sample groups using one of four
methods implemented in <code><a href="../reference/calculate_lm_interaction.html">calculate_lm_interaction()</a></code>:</p>
<ul>
<li>
<strong>linear</strong>: fits a simple linear model. This is fast
and interpretable and is appropriate when the q–response is
approximately linear and samples are independent.</li>
<li>
<strong>lmm</strong>: fits a linear mixed model which accounts for
subject-level random effects (paired or repeated measures).</li>
<li>
<strong>gam</strong>: fits a generalized additive model. This method
allows to capture nonlinear q–response shapes.</li>
<li>
<strong>fpca</strong>: uses a functional-data approach to reduce
each gene’s q-curve to principal component scores. This is recommended
when q is densely sampled or when q-curves exhibit complex,
high-dimensional variation.</li>
</ul>
<p>Below we demonstrate a practical <code>lmm</code> example using the
<strong>Satterthwaite</strong> approximation for per-term inference.
This method is preferable for small or moderately sized paired RNA‑seq
studies when per-term inference is required (for example, the q:group
interaction).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Linear-model interaction test across q values: detect q x group interaction</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"lme4"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Compute and show top hits (by adjusted p-value)</span></span>
<span>    <span class="va">lm_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_lm_interaction.html">calculate_lm_interaction</a></span><span class="op">(</span><span class="va">ts_se</span>,</span>
<span>        sample_type_col <span class="op">=</span> <span class="st">"sample_type"</span>, method <span class="op">=</span> <span class="st">"lmm"</span>,</span>
<span>        pvalue <span class="op">=</span> <span class="st">"satterthwaite"</span>,</span>
<span>        subject_col <span class="op">=</span> <span class="st">"sample_base"</span><span class="op">)</span></span>
<span>    <span class="co"># show the top entries</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lm_res</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;      gene p_interaction         p_lrt p_satterthwaite fit_method singular</span></span>
<span><span class="co">#&gt; 1  HAPLN3 2.319271e-111 2.139688e-111   2.319271e-111       lmer    FALSE</span></span>
<span><span class="co">#&gt; 2  COL1A2  8.713853e-97  8.123588e-97    8.713853e-97       lmer    FALSE</span></span>
<span><span class="co">#&gt; 3   EEF2K  3.093021e-87  2.903439e-87    3.093021e-87       lmer    FALSE</span></span>
<span><span class="co">#&gt; 4 C1orf86  8.733394e-83  8.224552e-83    8.733394e-83       lmer    FALSE</span></span>
<span><span class="co">#&gt; 5  LRRC15  7.474347e-79  7.058969e-79    7.474347e-79       lmer    FALSE</span></span>
<span><span class="co">#&gt; 6    PI16  5.493773e-73  5.210643e-73    5.493773e-73       lmer    FALSE</span></span>
<span><span class="co">#&gt;   adj_p_interaction</span></span>
<span><span class="co">#&gt; 1     4.615350e-109</span></span>
<span><span class="co">#&gt; 2      8.670284e-95</span></span>
<span><span class="co">#&gt; 3      2.051704e-85</span></span>
<span><span class="co">#&gt; 4      4.344863e-81</span></span>
<span><span class="co">#&gt; 5      2.974790e-77</span></span>
<span><span class="co">#&gt; 6      1.822101e-71</span></span></code></pre></div>
<div class="section level3">
<h3 id="tsallis-q-sequence-plot">Tsallis q-sequence plot<a class="anchor" aria-label="anchor" href="#tsallis-q-sequence-plot"></a>
</h3>
<p>With the <strong>Tsallis q-sequence</strong> we can produce a q-curve
per sample and gene. These curves show how diversity emphasis shifts
from rare to dominant isoforms as <code>q</code> increases and form the
basis for interaction tests. The q-curve shows entropy as a function of
<code>q</code>. Diverging curves between groups indicate
<strong>scale-dependent diversity differences</strong>: separation at
low <code>q</code> implies differences in rare isoforms, while
separation at high <code>q</code> signals differences in dominant
isoforms.</p>
<p>Now we will plot the q-curve profile for the top gene identified by
the linear-model interaction test. We will start with
<code>HAPLN3</code>, which codifies member of the hyaluronan and
proteoglycan link protein family expressed in the extracellular matrix,
and closely associated with the development and occurrence of various
malignant tumors (<a href="https://doi.org/10.1007/s00432-022-04421-3" class="external-link">source</a>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot q-curve profile for top linear-model gene</span></span>
<span><span class="va">plot_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tsallis_gene_profile.html">plot_tsallis_gene_profile</a></span><span class="op">(</span><span class="va">ts_se</span>, gene <span class="op">=</span> <span class="st">"HAPLN3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot_target</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/hapln3-gene-qprofile-1.png" class="r-plt" alt="" width="960"></p>
<p>Now let’s look at <code>COL1A2</code>, encodes the pro-alpha2 chain
of type I collagen, a fibril-forming collagen found in most connective
tissues.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot q-curve profile for top linear-model gene</span></span>
<span><span class="va">plot_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tsallis_gene_profile.html">plot_tsallis_gene_profile</a></span><span class="op">(</span><span class="va">ts_se</span>, gene <span class="op">=</span> <span class="st">"COL1A2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot_target</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/colia2-gene-qprofile-1.png" class="r-plt" alt="" width="960"></p>
<p>Finally, we can visualize the gene <code>PI16</code>, which is
emerging as an important regulator in the vascular system.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot q-curve profile for top linear-model gene</span></span>
<span><span class="va">plot_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tsallis_gene_profile.html">plot_tsallis_gene_profile</a></span><span class="op">(</span><span class="va">ts_se</span>, gene <span class="op">=</span> <span class="st">"PI16"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot_target</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/pi16-gene-qprofile-1.png" class="r-plt" alt="" width="960"></p>
<p>We can also plot the <strong>overall Tsallis q-curve for all
genes</strong>. This plot provides a global view of how diversity
changes across the <code>q</code> spectrum for the entire dataset and
can reveal general trends in isoform diversity.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot top tsallis q curve</span></span>
<span><span class="va">p_qcurve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tsallis_q_curve.html">plot_tsallis_q_curve</a></span><span class="op">(</span><span class="va">ts_se</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_qcurve</span><span class="op">)</span></span></code></pre></div>
<p><img src="TSENAT_files/figure-html/tsallis-q-curve-1.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="practical-notes-and-recommendations">Practical notes and recommendations<a class="anchor" aria-label="anchor" href="#practical-notes-and-recommendations"></a>
</h2>
<p>Accurate isoform quantification is the foundation of reliable entropy
analysis. Small counts introduce noise; missing data distorts
proportions. Some important elements to keep in mind:</p>
<ul>
<li>
<strong>Transcript abundance filtering</strong>: Remove very
low-count transcripts to reduce technical noise (typical rule: drop
transcripts with &lt;5 reads in &gt;5 samples, but adjust to sequencing
depth).</li>
<li>
<strong>Pseudocounts</strong>: If zeros create numerical issues, you
coud add a small pseudocount (e.g. 1e-10). You can find more information
about pseudocoints in this <a href="https://doi.org/10.1093/bioinformatics/bty471" class="external-link">paper</a>.</li>
<li>
<strong>Quantification &amp; normalization</strong>: use bias-aware
quantifiers, such Salmon or kallisto.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-conda-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS/LAPACK: /home/nouser/miniconda3/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=de_DE.UTF-8        LC_COLLATE=es_ES.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=es_ES.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=de_DE.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Berlin</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] mgcv_1.9-4                  nlme_3.1-168               </span></span>
<span><span class="co">#&gt;  [3] SummarizedExperiment_1.40.0 Biobase_2.70.0             </span></span>
<span><span class="co">#&gt;  [5] GenomicRanges_1.62.1        Seqinfo_1.0.0              </span></span>
<span><span class="co">#&gt;  [7] IRanges_2.44.0              S4Vectors_0.48.0           </span></span>
<span><span class="co">#&gt;  [9] BiocGenerics_0.56.0         generics_0.1.4             </span></span>
<span><span class="co">#&gt; [11] MatrixGenerics_1.22.0       matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt; [13] ggplot2_4.0.2               TSENAT_0.99.0              </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6        xfun_0.56           bslib_0.10.0       </span></span>
<span><span class="co">#&gt;  [4] htmlwidgets_1.6.4   lattice_0.22-7      numDeriv_2016.8-1.1</span></span>
<span><span class="co">#&gt;  [7] Rdpack_2.6.6        vctrs_0.7.1         tools_4.5.2        </span></span>
<span><span class="co">#&gt; [10] tibble_3.3.1        pkgconfig_2.0.3     Matrix_1.7-4       </span></span>
<span><span class="co">#&gt; [13] RColorBrewer_1.1-3  S7_0.2.1            desc_1.4.3         </span></span>
<span><span class="co">#&gt; [16] lifecycle_1.0.5     compiler_4.5.2      farver_2.1.2       </span></span>
<span><span class="co">#&gt; [19] textshaping_1.0.4   lmerTest_3.2-0      htmltools_0.5.9    </span></span>
<span><span class="co">#&gt; [22] sass_0.4.10         yaml_2.3.12         nloptr_2.2.1       </span></span>
<span><span class="co">#&gt; [25] pkgdown_2.2.0       pillar_1.11.1       jquerylib_0.1.4    </span></span>
<span><span class="co">#&gt; [28] tidyr_1.3.2         MASS_7.3-65         DelayedArray_0.36.0</span></span>
<span><span class="co">#&gt; [31] cachem_1.1.0        reformulas_0.4.4    boot_1.3-32        </span></span>
<span><span class="co">#&gt; [34] abind_1.4-8         tidyselect_1.2.1    digest_0.6.39      </span></span>
<span><span class="co">#&gt; [37] dplyr_1.2.0         purrr_1.2.1         labeling_0.4.3     </span></span>
<span><span class="co">#&gt; [40] splines_4.5.2       fastmap_1.2.0       grid_4.5.2         </span></span>
<span><span class="co">#&gt; [43] cli_3.6.5           SparseArray_1.10.8  magrittr_2.0.4     </span></span>
<span><span class="co">#&gt; [46] patchwork_1.3.2     S4Arrays_1.10.1     withr_3.0.2        </span></span>
<span><span class="co">#&gt; [49] scales_1.4.0        rmarkdown_2.30      XVector_0.50.0     </span></span>
<span><span class="co">#&gt; [52] lme4_1.1-38         otel_0.2.0          ragg_1.5.0         </span></span>
<span><span class="co">#&gt; [55] evaluate_1.0.5      knitr_1.51          rbibutils_2.4.1    </span></span>
<span><span class="co">#&gt; [58] viridisLite_0.4.3   rlang_1.1.7         Rcpp_1.1.1         </span></span>
<span><span class="co">#&gt; [61] glue_1.8.0          minqa_1.2.8         jsonlite_2.0.0     </span></span>
<span><span class="co">#&gt; [64] R6_2.6.1            systemfonts_1.3.1   fs_1.6.6</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gallardoalba" class="external-link">Cristóbal Gallardo</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
