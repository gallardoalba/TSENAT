# TSENAT: Tsallis Entropy Analysis Toolbox

TSENAT analyze expression/transcript differences and compute diversity
metrics.

## Badges

- GitHub Actions (CI):

  ``` R
    [![R-CMD-check](https://github.com/gallardoalba/TSENAT/actions/workflows/check-standard.yaml/badge.svg)](https://github.com/gallardoalba/TSENAT/actions)
  ```

- Español README:
  [README.es.md](https://gallardoalba.github.io/TSENAT/README.es.md)

- Deutsch README:
  [README.de.md](https://gallardoalba.github.io/TSENAT/README.de.md)

## Origin and attribution

TSENAT builds upon and adapts substantial portions of code from the
[SplicingFactory package](https://github.com/esebesty/SplicingFactory).
The codebase has been extended with additional utilities, bug fixes and
plotting helpers focused on Tsallis based transcript-level diversity
analysis.

## Tsallis theory

Tsallis entropy generalizes Shannon entropy and is defined as S_q = (1 -
sum p^q) / (q - 1) for a probability vector p. In the limit q -\> 1 it
recovers Shannon entropy. In TSENAT we compute Tsallis entropy and the
related Hill numbers (D_q) per gene to measure isoform diversity. The
parameter `q` tunes sensitivity to rare vs abundant isoforms (q \< 1
emphasizes rare isoforms; q \> 1 emphasizes abundant ones).

## Integrated features

- Tsallis entropy and diversity calculations: -
  `calculate_tsallis_entropy`: computes S_q and/or D_q for a numeric
  vector of expression values (supports normalization, multiple `q`
  values and the q→1 limit). Returns numeric vectors or a list depending
  on `what`. - `calculate_diversity`: applies the calculation across
  transcripts/genes for matrices, `tximport`-style lists or
  `SummarizedExperiment` objects and returns a `SummarizedExperiment`
  with assay `diversity` (S_q) or `hill` (D_q).

- Differential and statistical analyses: - `calculate_difference` and
  helpers in `difference_functions` compute group means, differences (or
  log2 fold-changes), p-values and adjusted p-values. These functions
  are designed to work with diversity summaries as well as expression
  matrices.

- Method wrappers and utilities: - `calculate_method` provides a wrapper
  to run the chosen diversity method per gene, format outputs and
  evaluate multiple `q` values in one pass.

- Plotting and visualization: - `plot_tsallis_q_curve`: median ± IQR of
  Tsallis entropy across q-values by group. -
  `plot_tsallis_violin_multq`: violin plots of Tsallis entropy for
  multiple q-values and groups. - `plot_diversity_density`: density
  plots of diversity by sample type. - `plot_mean_violin`: violin plot
  of per-gene mean diversity by sample type. - `plot_ma`: MA-plot for
  differential results. - `plot_volcano`: volcano plot with labeling of
  top genes. - `plot_top_transcripts`: summary/visualization for top
  transcripts.

## Installation and documentation

Install from GitHub during development:

``` r

if (!requireNamespace("remotes", quietly = TRUE)) install.packages("remotes")
remotes::install_github("gallardoalba/TSENAT")

## Development / Reproducible setup
## Recommended (reproducible): use `renv`.

install.packages("renv")
renv::init()
# when dependencies are set, record lock
renv::snapshot()
```

## Quick start

``` r

library(TSENAT)
data("tcga_brca_luma_dataset", package = "TSENAT")

res <- calculate_difference(tcga_brca_luma_dataset$counts,
                            group = tcga_brca_luma_dataset$group)
head(res)
```

The complete documentation can be found at
[inst/doc/TSENAT.html](https://gallardoalba.github.io/TSENAT/inst/doc/TSENAT.md).

## Citation and license

This project is licensed under the GNU General Public License v3.0
(GPL-3). A copy of the full license text is included in the repository
at `LICENSE` and is installed with the package under `inst/LICENSE`.

See `citation("TSENAT")` or
[inst/CITATION](https://gallardoalba.github.io/TSENAT/inst/CITATION).
License in [LICENSE](https://gallardoalba.github.io/TSENAT/LICENSE).

# Package index

## All functions

- [`calculate_difference()`](https://gallardoalba.github.io/TSENAT/reference/calculate_difference.md)
  : Calculate splicing diversity changes between two conditions.
- [`calculate_diversity()`](https://gallardoalba.github.io/TSENAT/reference/calculate_diversity.md)
  : Calculate Tsallis diversity per gene across samples
- [`calculate_fc()`](https://gallardoalba.github.io/TSENAT/reference/calculate_fc.md)
  : Calculate splicing diversity changes between two conditions.
- [`calculate_lm_interaction()`](https://gallardoalba.github.io/TSENAT/reference/calculate_lm_interaction.md)
  : Linear-model interaction test for Tsallis entropy
- [`calculate_method()`](https://gallardoalba.github.io/TSENAT/reference/calculate_method.md)
  : Calculate Tsallis diversity values for transcripts grouped by gene
- [`calculate_tsallis_entropy()`](https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.md)
  : Calculate Tsallis entropy for a vector of transcript-level
  expression values of one gene.
- [`infer_sample_group()`](https://gallardoalba.github.io/TSENAT/reference/infer_sample_group.md)
  : Infer sample group from sample names
- [`label_shuffling()`](https://gallardoalba.github.io/TSENAT/reference/label_shuffling.md)
  : Calculate p-values using label shuffling.
- [`map_coldata_to_se()`](https://gallardoalba.github.io/TSENAT/reference/map_coldata_to_se.md)
  : Map external coldata into a SummarizedExperiment
- [`plot_diversity_density()`](https://gallardoalba.github.io/TSENAT/reference/plot_diversity_density.md)
  : Plot diversity distributions (density) by sample type
- [`plot_ma()`](https://gallardoalba.github.io/TSENAT/reference/plot_ma.md)
  : Plot MA plot for difference results
- [`plot_mean_violin()`](https://gallardoalba.github.io/TSENAT/reference/plot_mean_violin.md)
  : Plot violin of per-gene mean diversity by sample type
- [`plot_top_transcripts`](https://gallardoalba.github.io/TSENAT/reference/plot_top_transcripts.md)
  : Plot top transcripts for a gene
- [`plot_tsallis_density_multq()`](https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_density_multq.md)
  : Density plot of Tsallis entropy for multiple q values
- [`plot_tsallis_q_curve()`](https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_q_curve.md)
  : Plot median +- IQR of Tsallis entropy across q values by group
- [`plot_tsallis_violin_multq()`](https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_violin_multq.md)
  : Violin plot of Tsallis entropy for multiple q values
- [`plot_volcano()`](https://gallardoalba.github.io/TSENAT/reference/plot_volcano.md)
  : Volcano plot for differential results
- [`tcga_brca_luma_dataset`](https://gallardoalba.github.io/TSENAT/reference/tcga_brca_luma_dataset.md)
  : TCGA Luminal A breast cancer dataset
- [`wilcoxon()`](https://gallardoalba.github.io/TSENAT/reference/wilcoxon.md)
  : Calculate p-values using Wilcoxon rank sum test.

# Articles

### All vignettes

- [TSENAT: Tsallis entropy
  workflow](https://gallardoalba.github.io/TSENAT/articles/TSENAT.md):
