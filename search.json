[{"path":"https://gallardoalba.github.io/TSENAT/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Code of Conduct","title":"Code of Conduct","text":"project follows Contributor Covenant. respectful, constructive kind. See full policy link .","code":""},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"vignette demonstrates compute apply Tsallis entropy transcript-level expression data using TSENAT. focuses three practical goals: (1) compute per-sample, per-gene diversity measures across range sensitivity parameters q; (2) compare measures sample groups; (3) visualize inspect transcript-level patterns explain differences.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"motivation","dir":"Articles","previous_headings":"Overview","what":"Motivation","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Many genes express multiple isoforms whose relative abundances can multimodal heavy-tailed. Standard mean-based comparisons may miss changes isoform dominance heterogeneity. Tsallis entropy provides tunable way weight rare versus dominant isoforms varying q, producing “q-curve” reveals scale-dependent diversity differences.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"high-level-workflow","dir":"Articles","previous_headings":"Overview","what":"High-level workflow","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Preprocess counts filter low-abundance transcripts. Compute relative transcript proportions within gene evaluate Tsallis entropy across one q values. Summarize per-gene values across samples (mean/median) test differences groups (Wilcoxon permutations). Visualize q-curves inspect transcript-level counts top genes.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"what-is-tsallis-entropy","dir":"Articles","previous_headings":"","what":"What is Tsallis entropy?","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Tsallis entropy one-parameter family diversity measures generalizes Shannon entropy via sensitivity parameter q. discrete probability vector p=(p1,…,pn)p=(p_1,\\dots,p_n) defined Sq(p)=1−∑=1npiqq−1. S_q(p) = \\frac{1-\\sum_{=1}^n p_i^q}{q-1}. use Tsallis entropy gene-expression data? Tsallis entropy provides compact, flexible summary isoform-level heterogeneity particularly useful biological signals act different abundance scales; combined careful preprocessing resampling-based uncertainty quantification practical interpretable tool transcriptomics analyses. Key advantages: Tunable sensitivity: changing q shifts emphasis rare dominant isoforms. Use small q (<1<1) probe rare-isoform heterogeneity larger q (>1>1) focus dominant-isoform behaviour; plotting S_q across compact q grid (“q-curve”) reveals scale-dependent differences conditions. Interpretability: Tsallis maps several familiar indices limits (Shannon q=1, richness-like q=0, Gini–Simpson q=2), unifies multiple perspectives isoform diversity within one framework. Robust summary diagnostics: combined Hill numbers q-curves, S_q supports concise reporting (effective isoform counts, slope/AUC summaries) targeted follow-(transcript-level plots). Essential limiting cases: Limit q→1q\\1: Shannon entropy, lim⁡q→1Sq(p)=−∑ipilog⁡pi\\lim_{q\\to1} S_q(p) = -\\sum_i p_i\\log p_i. q=0q=0: richness-like (number expressed isoforms minus one). q=2q=2: Gini–Simpson / collision index, S2=1−∑ipi2S_2 = 1-\\sum_i p_i^2. Uniform maximum: mm expressed isoforms, Sq,max(m)=1−m1−qq−1S_{q,\\max}(m)=\\frac{1-m^{1-q}}{q-1} normalized S̃q=Sq/Sq,max(m)\\tilde S_q = S_q / S_{q,\\max}(m). Use cases interpretation: gene group separation low q suggests differences low-abundance (rare) isoforms; separation high q indicates changes dominant isoforms. regimes differ, q-curve show divergence across entire q range. Report S_q Hill numbers D_q appropriate clarity: D_q converts entropies “effective number isoforms” easy interpret.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"example-dataset","dir":"Articles","previous_headings":"","what":"Example dataset","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"example dataset included demonstration. Load package data:","code":"# Load packages suppressPackageStartupMessages({     library(TSENAT)     library(ggplot2)     library(SummarizedExperiment)     library(mgcv) })"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"sample-naming-and-pairing-requirements","dir":"Articles","previous_headings":"Example dataset","what":"Sample naming and pairing requirements","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"TSENAT requires consistent, exact mapping assay column names values coldata$Sample. following rules recommendations make mapping reliable avoid surprises running paired analyses. Naming convention: paired comparisons use shared base identifier role suffix, e.g. SAMPLE_N / SAMPLE_T SAMPLE_Normal / SAMPLE_Tumor. helper infer_sample_group() recognizes common underscore suffixes (like _N / _T) common TCGA-style tokens. Validation metadata: perform paired analyses call map_coldata_to_se(..., paired = TRUE). paired = TRUE function reorder columns follow coldata, add sample_type sample_base colData(ts_se), check sample_base entries groups, returning informative error . following example coldata_df illustrates correct format:","code":"Sample  Condition TCGA-A7-A0CH_N  Normal TCGA-A7-A0D9_N  Normal TCGA-A7-A0CH_T  Tumor TCGA-A7-A0D9_T  Tumor"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"load-data-and-metadata","dir":"Articles","previous_headings":"Example dataset","what":"Load data and metadata","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Now load example dataset associated metadata: next step inspect loaded data ensure looks correct.","code":"# Load required files coldata_tsv <- system.file(\"extdata\", \"coldata.tsv\", package = \"TSENAT\") tx2gene_tsv <- system.file(\"extdata\", \"tx2gene.tsv\", package = \"TSENAT\") data(\"tcga_brca_luma_dataset\", package = \"TSENAT\", envir = globalenv())  # Extract gene names and read count data (do not reference ts_se yet) genes <- tcga_brca_luma_dataset[, 1] readcounts <- tcga_brca_luma_dataset[, -1]  # Assign transcript IDs as rownames of `readcounts` # so downstream transcript-level plotting functions can use them. txmap <- utils::read.delim(tx2gene_tsv, header = TRUE, stringsAsFactors = FALSE) rownames(readcounts) <- as.character(txmap$Transcript)  # Read sample metadata coldata_df <- read.table(coldata_tsv,     header = TRUE,     sep = \"\\t\",     stringsAsFactors = FALSE ) # Check gene names head(genes) #> [1] \"MXRA8\"   \"MXRA8\"   \"MXRA8\"   \"MXRA8\"   \"MXRA8\"   \"C1orf86\"  # Check read count dataset dim(readcounts) #> [1] 1100   40 head(readcounts[, 1:5]) #>           TCGA-A7-A0CH_N TCGA-A7-A0CH_T TCGA-A7-A0D9_N TCGA-A7-A0D9_T #> MXRA8.1          2858.04         743.56         812.59           0.00 #> MXRA8.2           127.82          21.28          50.87          38.21 #> MXRA8.3           370.22          94.38         368.76          98.12 #> MXRA8.4          7472.00        3564.87        7647.76        3236.28 #> MXRA8.5            25.44          16.91           4.07           7.55 #> C1orf86.1           0.00           0.00           0.00           0.00 #>           TCGA-A7-A0DB_T #> MXRA8.1          1508.90 #> MXRA8.2            30.10 #> MXRA8.3           167.89 #> MXRA8.4          6360.80 #> MXRA8.5            34.74 #> C1orf86.1           0.00  # Check the metadata head(coldata_df) #>           Sample Condition #> 1 TCGA-A7-A0CH_N    Normal #> 2 TCGA-A7-A0D9_N    Normal #> 3 TCGA-A7-A0DB_N    Normal #> 4 TCGA-A7-A0DC_N    Normal #> 5 TCGA-A7-A13G_N    Normal #> 6 TCGA-AC-A2FB_N    Normal"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"data-filtering-and-preprocessing","dir":"Articles","previous_headings":"Example dataset","what":"Data filtering and preprocessing","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"first step, diversity calculation, might want filter genes low overall expression limit analysis transcripts sufficient minimum expression level. Expression estimates transcript isoforms zero low expression might highly variable. details effect transcript isoform prefiltering differential transcript usage, see paper. Filter transcripts fewer 5 reads 5 samples update genes vector accordingly. filter lowly-expressed transcripts reduce noise improve stability diversity estimates.","code":"## Filter lowly-expressed transcripts and report counts n_before <- nrow(readcounts) tokeep <- rowSums(readcounts > 5) > 5 readcounts <- readcounts[tokeep, ] genes <- genes[tokeep] n_after <- nrow(readcounts)  message(sprintf(     \"Transcripts: before = %d, after = %d\",     n_before, n_after )) #> Transcripts: before = 1100, after = 833"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"compute-normalized-tsallis-entropy-","dir":"Articles","previous_headings":"","what":"Compute normalized Tsallis entropy.","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Compute Tsallis entropy single q inspect resulting assay. Now map sample metadata (available) SummarizedExperiment plotting functions can use sample_type grouping. mapping, inspect colData(ts_se) confirm sample_type sample_base present correctly populated.","code":"# compute Tsallis entropy for a single q value (normalized) q <- 0.1 ts_se <- calculate_diversity(readcounts, genes, q = q, norm = TRUE) head(assay(ts_se)[1:5, 1:5]) #>         TCGA-A7-A0CH_N TCGA-A7-A0CH_T TCGA-A7-A0D9_N TCGA-A7-A0D9_T #> MXRA8        0.8616275      0.6609111      0.8156972      0.6633580 #> C1orf86      0.0000000      0.0000000      0.0000000      0.0000000 #> PDPN         0.3486679      0.3395884      0.0000000      0.3481643 #> ALDH4A1      0.8111864      0.4667361      0.8621495      0.5069312 #> HNRNPR       0.5204909      0.6683829      0.7395887      0.6537834 #>         TCGA-A7-A0DB_T #> MXRA8        0.8036333 #> C1orf86      0.0000000 #> PDPN         0.3467400 #> ALDH4A1      0.5046596 #> HNRNPR       0.8287792 ts_se <- map_coldata_to_se(ts_se, coldata_df, paired = TRUE) # Quick checks on mapped sample metadata cd <- colData(ts_se) colnames(cd) # list available metadata columns #> [1] \"samples\"     \"sample_type\" \"sample_base\" head(cd) # preview metadata for first samples #> DataFrame with 6 rows and 3 columns #>                       samples sample_type    sample_base #>                   <character> <character>    <character> #> TCGA-A7-A0CH_N TCGA-A7-A0CH_N      Normal TCGA-A7-A0CH_N #> TCGA-A7-A0CH_T TCGA-A7-A0CH_T       Tumor TCGA-A7-A0CH_T #> TCGA-A7-A0D9_N TCGA-A7-A0D9_N      Normal TCGA-A7-A0D9_N #> TCGA-A7-A0D9_T TCGA-A7-A0D9_T       Tumor TCGA-A7-A0D9_T #> TCGA-A7-A0DB_N TCGA-A7-A0DB_N      Normal TCGA-A7-A0DB_N #> TCGA-A7-A0DB_T TCGA-A7-A0DB_T       Tumor TCGA-A7-A0DB_T"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"differential-analysis","dir":"Articles","previous_headings":"","what":"Differential analysis","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"section summarizes practical guidance hypothesis testing reporting comparing diversity measures across sample groups. package exposes pragmatic pairwise tests comparing per-gene diversity summaries two groups. Two common choices Wilcoxon-based tests label-shuffle tests. Guidance: Wilcoxon rank-sum (unpaired) / Wilcoxon signed-rank (paired): Use want distribution-free test comparing central tendency (ranks/median) sample sizes moderate (typically ≥10 per group stable asymptotic p-values). Assumptions: independent observations within groups (matched pairs signed-rank test); exchangeability null. Handle ties: software returns approximate p-values many ties exist; consider permutation p-values ties discreteness extreme (small counts, many zeros). Report effect sizes (median difference, Hodges–Lehmann estimator) confidence intervals possible; rely p-values alone. Label-shuffle tests: Use sample sizes small, distributional assumptions questionable, prefer exact/empirical null constructed observed data. Randomly shuffle group labels many times recompute test statistic (difference medians means). Exchangeability requirement: permutations valid labels exchangeable null (e.g., independent samples). paired designs use paired permutations shuffle within pairs use sign flips paired differences. Practical settings: set randomizations ≥1000 routine use 5000+ estimating small p-values applying FDR across many genes. possible, compute exact permutations (labelings) small datasets. paired designs exact sign-flip test enumerates possible combinations within-pair label flips. Use paired = TRUE paired_method = \"signflip\" set randomizations = 0 trigger exact enumeration small numbers pairs. use Wilcoxon test; appropriate choice speed sample sizes support asymptotic approximations. Use permutation tests small-sample accuracy exact control null distribution important. Recommendation: summary & test choice: analyses shown vignette recommend using median Wilcoxon rank-sum test comparisons. Tsallis entropy values often skewed sensitive outliers; median robust Wilcoxon test assume normality, combination well suited analysis. running differential tests summarize per-gene diversity values across samples explicitly define sample groups. previos code-block pseudocount used address zero values gene expression datasets. adding pseudocount,zeros can treated low values, enabling meaningful analyses. approach helps clarify biological variations might otherwise overlooked, ensuring reliable insights gene expression abundance. Using small pseudocount, 1e-6, maintains data integrity providing necessary stability calculations. Now generate diagnostic plots summarize per-gene effect sizes: MA plot shows relationship mean expression log-fold change, helping spot genes large effect sizes across expression levels. volcano plot displays effect size versus significance, useful highlighting candidates thresholding magnitude adjusted p-value.","code":"# create a sample grouping vector inferred from sample names # account for per-q column names like 'Sample_q=0.01' sample_base_names <- sub(     \"_q=.*\", \"\",     colnames(assay(ts_se)) ) samples <- as.character(colData(ts_se)$sample_type)  # prepare diversity table as data.frame with gene names in first column div_df <- as.data.frame(assay(ts_se)) div_df <- cbind(genes = rowData(ts_se)$genes, div_df)  # samples are matched pairs (Normal/Tumor), so use a paired test res <- calculate_difference(div_df, samples,     control = \"Normal\",     method = \"median\", test = \"wilcoxon\",     paired = TRUE,     pseudocount = 1e-6 # small pseudocount to stabilize zeros if needed ) # sort results by adjusted p-value res <- res[order(res$adjusted_p_values), , drop = FALSE] head(res) #>        genes Tumor_median Normal_median median_difference log2_fold_change #> 6   C1orf213    0.0000010     0.9870253       -0.98702427    -19.912727492 #> 17     S1PR1    0.9931595     0.9993087       -0.00614921     -0.008904999 #> 87      MBD2    0.5592953     0.0000010        0.55929434     19.093250788 #> 98      OSR1    0.7933920     0.6636451        0.12974692      0.257621943 #> 101    GFPT1    0.0000010     0.5834509       -0.58344994    -19.154251821 #> 126     KIF9    0.5814162     0.3710543        0.21036198      0.647941169 #>     raw_p_values adjusted_p_values #> 6   0.0002357454         0.0269389 #> 17  0.0007285418         0.0269389 #> 87  0.0006535852         0.0269389 #> 98  0.0005801974         0.0269389 #> 101 0.0008919014         0.0269389 #> 126 0.0006356242         0.0269389 # MA plot using helper p_ma <- plot_ma(res) print(p_ma) # Volcano plot: mean difference vs -log10(adjusted p-value) p_volcano <- plot_volcano(res) print(p_volcano)"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"plot-top-3-genes-from-the-single-q-differential-analysis","dir":"Articles","previous_headings":"Differential analysis","what":"Plot top 3 genes from the single-q differential analysis","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"visualize transcript-level expression significant genes identified previous step. plot_top_transcripts() helper expects transcript-level counts (rows = transcripts) rownames matching tx2gene mapping. plot top three genes significance inspect isoform-level patterns may explain diversity differences.  Now, plot top genes using variance aggregation instead median. allows us see transcript-level expression variability differs groups genes.  Using concrete comparisons help distinguish consistent isoform-level regulation, outlier-driven artifacts, reciprocal isoform switching, subgroup heterogeneity.","code":"sig_res <- res[res$adjusted_p_values < 0.05, , drop = FALSE] top_genes <- head(sig_res$genes, 3) sample_base_names <- sub(     \"_q=.*\",     \"\",     colnames(assay(ts_se)) ) samples_vec <- as.character(colData(ts_se)$sample_type) # Plot using median aggregation p_median <- plot_top_transcripts(readcounts,     gene = top_genes,     samples = samples_vec, tx2gene = txmap,     top_n = NULL, metric = \"median\" ) print(p_median) # Plot using variance aggregation p_var <- plot_top_transcripts(readcounts,     gene = top_genes,     samples = samples_vec, tx2gene = txmap,     top_n = NULL, metric = \"variance\" ) print(p_var)"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"compare-between-q-values","dir":"Articles","previous_headings":"","what":"Compare between q values","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Compute normalized Tsallis entropy two q values (0.1 2) compare scale-dependent behavior. allows comparison across q gene determine whether diversity differences scale-dependent (example, significance q = 0.1 q = 2 suggests rare-isoform-driven changes). Map optional sample metadata multi-q SummarizedExperiment plotting helpers access sample_type grouping. Create violin density plots summarizing diversity across multiple q values show distributional differences groups.","code":"# compute Tsallis entropy for q = 1 (normalized) q <- c(0.1, 2) ts_se <- calculate_diversity(readcounts, genes,     q = q, norm = TRUE ) head(assay(ts_se)[1:5, 1:5]) #>         TCGA-A7-A0CH_N_q=0.1 TCGA-A7-A0CH_N_q=2 TCGA-A7-A0CH_T_q=0.1 #> MXRA8              0.8616275          0.6063802            0.6609111 #> C1orf86            0.0000000          0.0000000            0.0000000 #> PDPN               0.3486679          0.6619058            0.3395884 #> ALDH4A1            0.8111864          0.7478309            0.4667361 #> HNRNPR             0.5204909          0.6176153            0.6683829 #>         TCGA-A7-A0CH_T_q=2 TCGA-A7-A0D9_N_q=0.1 #> MXRA8            0.3925463            0.8156972 #> C1orf86          0.0000000            0.0000000 #> PDPN             0.5044987            0.0000000 #> ALDH4A1          0.2841620            0.8621495 #> HNRNPR           0.6856195            0.7395887 ts_se <- map_coldata_to_se(ts_se, coldata_df) p_violin <- plot_tsallis_violin_multq(ts_se, assay_name = \"diversity\") print(p_violin) p_density <- plot_tsallis_density_multq(ts_se, assay_name = \"diversity\") print(p_density)"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"linear-model-interaction-and-shape-tests-for-q-curves","dir":"Articles","previous_headings":"","what":"Linear-model interaction and shape tests for q-curves","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Now compute normalized Tsallis entropy across sequence q values. Map sample metadata multi-q SummarizedExperiment . q-sequence computed, can test interactions q sample groups using mixed models include random intercept per subject account paired samples. One practical approach Satterthwaite method. method preferable small moderately sized paired RNA‑seq studies per-term inference required (example, q:group interaction).","code":"# compute Tsallis entropy for a sequence of values (normalized) qvec <- seq(0.01, 2, by = 0.1) ts_se <- calculate_diversity(readcounts, genes,     q = qvec, norm = TRUE ) head(assay(ts_se)[1:5, 1:5]) #>         TCGA-A7-A0CH_N_q=0.01 TCGA-A7-A0CH_N_q=0.11 TCGA-A7-A0CH_N_q=0.21 #> MXRA8               0.9840684             0.8500785             0.7527194 #> C1orf86             0.0000000             0.0000000             0.0000000 #> PDPN                0.3348515             0.3502196             0.3659083 #> ALDH4A1             0.9759153             0.7976183             0.6982381 #> HNRNPR              0.5653272             0.5164881             0.4849368 #>         TCGA-A7-A0CH_N_q=0.31 TCGA-A7-A0CH_N_q=0.41 #> MXRA8               0.6818220             0.6303117 #> C1orf86             0.0000000             0.0000000 #> PDPN                0.3818895             0.3981326 #> ALDH4A1             0.6447807             0.6181672 #> HNRNPR              0.4655343             0.4548022 # For paired designs ensure sample_base is created so LMMs can use it ts_se <- map_coldata_to_se(ts_se, coldata_df, paired = TRUE) # Linear-model interaction test across q values:  # detect q x group interaction # Compute and show top hits (by adjusted p-value) lm_res <- calculate_lm_interaction(ts_se,     sample_type_col = \"sample_type\", method = \"lmm\",     pvalue = \"satterthwaite\",     subject_col = \"sample_base\",     nthreads = 1,     verbose = FALSE) print(head(lm_res, 6)) #>      gene p_interaction        p_lrt p_satterthwaite adj_p_interaction #> 1  HAPLN3  1.858060e-50 1.729070e-50    1.858060e-50      3.660378e-48 #> 2  COL1A2  6.454700e-47 6.037249e-47    6.454700e-47      6.357879e-45 #> 3    PI16  2.694297e-42 2.536901e-42    2.694297e-42      1.769255e-40 #> 4  LRRC15  1.853900e-39 1.752784e-39    1.853900e-39      9.130457e-38 #> 5 C1orf86  7.293099e-39 6.901271e-39    7.293099e-39      2.873481e-37 #> 6   EEF2K  5.959578e-38 5.646863e-38    5.959578e-38      1.956728e-36"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"tsallis-q-sequence-plot","dir":"Articles","previous_headings":"Linear-model interaction and shape tests for q-curves","what":"Tsallis q-sequence plot","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Tsallis q-sequence can produce q-curve per sample gene. curves show diversity emphasis shifts rare dominant isoforms q increases form basis interaction tests. q-curve shows entropy function q. Diverging curves groups indicate scale-dependent diversity differences: separation low q implies differences rare isoforms, separation high q signals differences dominant isoforms. Now plot q-curve profile top gene identified linear-model interaction test. start HAPLN3.  Now let’s look COL1A2, encodes protein involved immune cell biology reported differentially regulated cancer studies.  plot might infer , dataset, rare transcripts appear prevalent cancer samples. Finally, can visualize gene PI16, emerging important regulator vascular system.  can also plot overall Tsallis q-curve genes. plot provides global view diversity changes across q spectrum entire dataset can reveal general trends isoform diversity.","code":"# Plot q-curve profile for top linear-model gene     # Prefer GFPT1 if present; otherwise use top LM hit plot_target <- plot_tsallis_gene_profile(ts_se, gene = \"HAPLN3\",     sample_type_col = \"sample_type\", show_samples = FALSE) print(plot_target) # Plot q-curve profile for top linear-model gene     # Prefer GFPT1 if present; otherwise use top LM hit plot_target <- plot_tsallis_gene_profile(ts_se, gene = \"COL1A2\",     sample_type_col = \"sample_type\", show_samples = FALSE) print(plot_target) # Plot q-curve profile for top linear-model gene     # Prefer GFPT1 if present; otherwise use top LM hit plot_target <- plot_tsallis_gene_profile(ts_se, gene = \"PI16\",     sample_type_col = \"sample_type\", show_samples = FALSE) print(plot_target) # Plot top tsallis q curve p_qcurve <- plot_tsallis_q_curve(ts_se) print(p_qcurve)"},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"practical-notes-and-recommendations","dir":"Articles","previous_headings":"","what":"Practical notes and recommendations","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"Quick checklist (): Preprocess: filter transcripts never observed add small, documented pseudocount (e.g., +1) — stabilizes proportions avoids undefined powers computing p_i^q. Choose q grid: pick compact set spanning rare → dominant regimes (suggested: 0.1, 0.5, 1, 1.5, 2). Plot q-curves inspect groups diverge rather relying single q. Reporting scale: present Hill numbers D_q (intuitive “effective isoforms”) /normalized entropy S̃q\\tilde S_q; report effect size (median/mean difference) variability (CI bootstrap SE). Hypothesis testing: use Wilcoxon speed (asymptotic) label-shuffle (permutation) small samples exact inference. permutations use randomizations ≥1000 (≥5000 estimating small p-values); use paired permutations matched designs. Multiple testing: apply FDR correction (Benjamini–Hochberg) show raw/adjusted p-values alongside effect sizes readers can judge practical relevance. Interaction testing: explore slopes/AUC first; use linear interaction simple slope differences, GAMs nonlinear shapes, FPCA fast low-dimensional summaries — always report key parameters (k, randomizations). Design & technical tips: prefer paired/matched designs available, ensure adequate biological replication, use accurate quantifiers (Salmon/kallisto UMI-based methods), correct confounders include models. Design examples: time-series longitudinal sampling capture dynamics; perturbation gradients (dose–response) reveal transitions; single-cell spatial (UMI-based) study heterogeneity; paired/matched designs control subject-level variability. Technical checklist: use accurate transcript quantifiers, aim sufficient sequencing depth isoform inference, filter pseudocount low-abundance transcripts, apply batch/confounder correction prior downstream testing. Test across compact q grid report grid.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/articles/TSENAT.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"TSENAT: Tsallis Entropy Analysis Toolbox","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-conda-linux-gnu #> Running under: Ubuntu 22.04.5 LTS #>  #> Matrix products: default #> BLAS/LAPACK: /home/nouser/miniconda3/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C               #>  [3] LC_TIME=de_DE.UTF-8        LC_COLLATE=es_ES.UTF-8     #>  [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=es_ES.UTF-8    #>  [7] LC_PAPER=de_DE.UTF-8       LC_NAME=C                  #>  [9] LC_ADDRESS=C               LC_TELEPHONE=C             #> [11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C        #>  #> time zone: Europe/Berlin #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] mgcv_1.9-4                  nlme_3.1-168                #>  [3] SummarizedExperiment_1.40.0 Biobase_2.70.0              #>  [5] GenomicRanges_1.62.1        Seqinfo_1.0.0               #>  [7] IRanges_2.44.0              S4Vectors_0.48.0            #>  [9] BiocGenerics_0.56.0         generics_0.1.4              #> [11] MatrixGenerics_1.22.0       matrixStats_1.5.0           #> [13] ggplot2_4.0.2               TSENAT_0.99.0               #>  #> loaded via a namespace (and not attached): #>  [1] gtable_0.3.6        xfun_0.56           bslib_0.10.0        #>  [4] htmlwidgets_1.6.4   ggrepel_0.9.6       lattice_0.22-7      #>  [7] numDeriv_2016.8-1.1 Rdpack_2.6.5        vctrs_0.7.1         #> [10] tools_4.5.2         tibble_3.3.1        pkgconfig_2.0.3     #> [13] Matrix_1.7-4        RColorBrewer_1.1-3  S7_0.2.1            #> [16] desc_1.4.3          lifecycle_1.0.5     compiler_4.5.2      #> [19] farver_2.1.2        textshaping_1.0.4   lmerTest_3.2-0      #> [22] htmltools_0.5.9     sass_0.4.10         yaml_2.3.12         #> [25] nloptr_2.2.1        pkgdown_2.2.0       pillar_1.11.1       #> [28] jquerylib_0.1.4     tidyr_1.3.2         MASS_7.3-65         #> [31] DelayedArray_0.36.0 cachem_1.1.0        reformulas_0.4.4    #> [34] boot_1.3-32         abind_1.4-8         tidyselect_1.2.1    #> [37] digest_0.6.39       dplyr_1.1.4         purrr_1.2.1         #> [40] labeling_0.4.3      splines_4.5.2       fastmap_1.2.0       #> [43] grid_4.5.2          cli_3.6.5           SparseArray_1.10.8  #> [46] magrittr_2.0.4      patchwork_1.3.2     S4Arrays_1.10.1     #> [49] withr_3.0.2         scales_1.4.0        rmarkdown_2.30      #> [52] XVector_0.50.0      lme4_1.1-38         otel_0.2.0          #> [55] ragg_1.5.0          evaluate_1.0.5      knitr_1.51          #> [58] rbibutils_2.4.1     viridisLite_0.4.3   rlang_1.1.7         #> [61] Rcpp_1.1.1          glue_1.8.0          minqa_1.2.8         #> [64] jsonlite_2.0.0      R6_2.6.1            systemfonts_1.3.1   #> [67] fs_1.6.6"},{"path":"https://gallardoalba.github.io/TSENAT/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Cristóbal Gallardo. Author, maintainer.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gallardo C (2026). TSENAT: Tsallis Entropy Analysis Toolbox. R package version 0.99.0, https://github.com/gallardoalba/TSENAT. Danko et al., SplicingFactory - Splicing diversity analysis transcriptome data. Bioinformatics, 2022, 38, 384-390","code":"@Manual{,   title = {TSENAT: Tsallis Entropy Analysis Toolbox},   author = {Cristobal Gallardo},   year = {2026},   note = {R package version 0.99.0},   url = {https://github.com/gallardoalba/TSENAT}, } @Article{,   title = {SplicingFactory - Splicing diversity analysis for transcriptome data},   author = {Benedek Danko and Peter Szikora and Tamas Por and Alexa Szeifert and Endre Sebestyen},   journal = {Bioinformatics},   volume = {38},   number = {2},   pages = {384-390},   year = {2022},   doi = {10.1093/bioinformatics/btab648},   url = {https://doi.org/10.1093/bioinformatics/btab648}, }"},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"tsenat-tsallis-entropy-analysis-toolbox","dir":"","previous_headings":"","what":"TSENAT","title":"TSENAT","text":"TSENAT analyzes expression transcript differences computes diversity metrics.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"tsallis-theory","dir":"","previous_headings":"","what":"Tsallis theory","title":"TSENAT","text":"Tsallis entropy generalizes Shannon entropy. probability vector p=(p1,…,pn)p = (p_1, \\dots, p_n) (pi≥0p_i \\ge 0 ∑ipi=1\\sum_i p_i = 1) Tsallis entropy order qq defined q≠1q \\ne 1 Sq(p)=1−∑ipiqq−1. S_q(p) = \\frac{1 - \\sum_{} p_i^q}{q - 1}. limit q→1q \\1 recovers Shannon entropy limq→1Sq(p)=−∑ipilog⁡pi. \\lim_{q \\1} S_q(p) = -\\sum_i p_i \\log p_i. transcript-expression data compute Tsallis entropy per gene isoform-level relative abundances. gene isoform counts expression values x_i, convert proportions pi=xi/∑jxj p_i = x_i / \\sum_j x_j pi≥0p_i \\ge 0 ∑ipi=1\\sum_i p_i = 1. parameter q controls entropy weights isoforms abundance: values q<1q < 1 emphasize low-abundance (rare) isoforms therefore capture richness, values q>1q > 1 emphasize high-abundance (dominant) isoforms therefore capture dominance. Practical choices: q = 0 counts expressed isoforms (richness), q = 1 recovers Shannon entropy (overall uncertainty isoform usage), q = 2 closely related inverse Simpson index (sensitive dominance). practice, choose smaller q highlight rare isoforms, q near 1 general diversity, larger q focus dominant isoforms.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"integrated-features","dir":"","previous_headings":"","what":"Integrated features","title":"TSENAT","text":"calculate_tsallis_entropy: computes S_q /D_q numeric vector expression values (supports normalization, multiple q values q→1 limit). Returns numeric vectors list depending . calculate_diversity: applies calculation across transcripts/genes matrices, tximport-style lists SummarizedExperiment objects returns SummarizedExperiment assay diversity (S_q) hill (D_q). calculate_difference helpers difference_functions compute group means, differences (log2 fold-changes), p-values adjusted p-values. functions designed work diversity summaries well expression matrices. plot_tsallis_q_curve: median ± IQR Tsallis entropy across q-values group.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"installation-and-documentation","dir":"","previous_headings":"","what":"Installation and documentation","title":"TSENAT","text":"Install GitHub development:","code":"if (!requireNamespace(\"remotes\", quietly = TRUE)) install.packages(\"remotes\") remotes::install_github(\"gallardoalba/TSENAT\")  ## Recommended (reproducible): use `renv`. install.packages(\"renv\") renv::init() # when dependencies are set, record lock renv::snapshot()"},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"TSENAT","text":"Compute Tsallis diversity single q plot q-curve across multiple q values (small, focused example taken vignette): detailed, reproducible example see package vignette: HTML | PDF.","code":"library(TSENAT) data(\"tcga_brca_luma_dataset\", package = \"TSENAT\")  # compute for q = 0.1 and normalize readcounts <- as.matrix(tcga_brca_luma_dataset[, -1, drop = FALSE]) genes <- tcga_brca_luma_dataset$genes ts_se <- calculate_diversity(readcounts, genes, q = 0.1, norm = TRUE)  # compute for multiple q values and plot the q-curve qvec <- seq(0.01, 2, by = 0.1) ts_multi <- calculate_diversity(readcounts, genes, q = qvec, norm = TRUE) ts_se <- map_coldata_to_se(ts_se, coldata_df) p3 <- plot_tsallis_q_curve(ts_se)"},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"ci-and-local-checks","dir":"","previous_headings":"","what":"CI and local checks","title":"TSENAT","text":"Continuous integration repository configured install packages listed Suggests (example lme4 lmerTest) vignette builds example code using mixed models run CI builders. reproduce CI-like local environment, install suggested packages running R CMD check: install just mixed-model packages used vignette:","code":"# install all suggested packages from DESCRIPTION if (!requireNamespace(\"remotes\", quietly = TRUE)) install.packages(\"remotes\") remotes::install_deps(dependencies = c(\"Suggests\")) install.packages(c(\"lme4\", \"lmerTest\"))"},{"path":"https://gallardoalba.github.io/TSENAT/index.html","id":"license-citation-and-attribution","dir":"","previous_headings":"","what":"License, citation and attribution","title":"TSENAT","text":"project licensed GNU General Public License v3.0 (GPL-3). copy full license text included repository LICENSE installed package inst/LICENSE. cite TSENAT publications, run following R: command shows recommended bibliographic entry; machine-readable inst/CITATION file included package easy citation export. TSENAT builds upon adapts substantial portions code SplicingFactory package. codebase extended additional utilities, bug fixes plotting helpers focused Tsallis based transcript-level diversity analysis.","code":"citation(\"TSENAT\")"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_difference.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate splicing diversity changes between two conditions. — calculate_difference","title":"Calculate splicing diversity changes between two conditions. — calculate_difference","text":"Calculate splicing diversity changes two conditions.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_difference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate splicing diversity changes between two conditions. — calculate_difference","text":"","code":"calculate_difference(   x,   samples,   control,   method = \"mean\",   test = \"wilcoxon\",   randomizations = 100,   pcorr = \"BH\",   assayno = 1,   verbose = FALSE,   paired = FALSE,   exact = FALSE,   pseudocount = 0 )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_difference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate splicing diversity changes between two conditions. — calculate_difference","text":"x SummarizedExperiment splicing diversity values gene sample data.frame gene names  first column splicing diversity values sample additional  columns. samples vector length one, specifying column name colData annotation column SummarizedExperiment object, used category column character vector equal length number columns input dataset, specifying category sample case data.frame input. control Name control sample category, defined samples vector, e.g. control = 'Normal' control = 'WT'. method Method use calculating average splicing diversity value condition. Can 'mean' 'median'. test Method use p-value calculation: use 'wilcoxon' Wilcoxon rank sum test 'shuffle' label shuffling test. randomizations Number random shuffles, used label shuffling test (default = 100). pcorr P-value correction method applied Wilcoxon rank sum test label shuffling test results, defined p.adjust  function. assayno integer value. case multiple assays SummarizedExperiment input, argument specifies assay number use difference calculations. verbose TRUE, function print additional diagnostic messages. paired Logical; `TRUE`, run paired versions tests supported (default: `FALSE`). exact Logical; passed Wilcoxon test request exact p-values supported (default: `FALSE`). pseudocount Numeric scalar. Passed calculate_fc used add small value non-positive group summaries computing differences log2 fold-changes. Default 1e-6. Rows excluded low sample counts remain NA.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_difference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate splicing diversity changes between two conditions. — calculate_difference","text":"data.frame mean median values splicing diversity across sample categories samples, log2(fold change)  two different conditions, raw corrected p-values.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_difference.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate splicing diversity changes between two conditions. — calculate_difference","text":"function calculates diversity changes two sample conditions. uses output diversity calculation function, SummarizedExperiment object splicing diversity values. Additionally, can use data.frame input, first column contains gene names, additional columns contain splicing diversity values sample. vector sample conditions also serves input, used aggregating samples condition.   calculates mean median splicing diversity data per sample  condition, difference values log2 fold change two  conditions. Furthermore, user can select statistical method  calculate significance changes. p-values adjusted p-values  calculated using Wilcoxon sum rank test label shuffling test.   function exclude genes low sample size significance  calculation, depending statistical test applied.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_difference.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate splicing diversity changes between two conditions. — calculate_difference","text":"","code":"x <- data.frame(Genes = letters[seq_len(10)], matrix(runif(80), ncol = 8)) samples <- c(rep(\"Healthy\", 4), rep(\"Pathogenic\", 4)) calculate_difference(x, samples,     control = \"Healthy\", method = \"mean\", test =         \"wilcoxon\" ) #>    genes Pathogenic_mean Healthy_mean mean_difference log2_fold_change #> 1      a       0.3536153    0.4177882    -0.064172864      -0.24059093 #> 2      b       0.4983910    0.3275041     0.170886910       0.60576503 #> 3      c       0.3939888    0.4673230    -0.073334138      -0.24626521 #> 4      d       0.4391230    0.4589390    -0.019816020      -0.06367737 #> 5      e       0.5746470    0.4147989     0.159848098       0.47026392 #> 6      f       0.7016257    0.4580544     0.243571275       0.61518255 #> 7      g       0.6093560    0.4994365     0.109919512       0.28698410 #> 8      h       0.3516991    0.6633813    -0.311682200      -0.91549669 #> 9      i       0.5652513    0.4689715     0.096279798       0.26939212 #> 10     j       0.3903022    0.3944323    -0.004130123      -0.01518619 #>    raw_p_values adjusted_p_values #> 1     0.6650055         1.0000000 #> 2     0.1939309         0.9696543 #> 3     1.0000000         1.0000000 #> 4     1.0000000         1.0000000 #> 5     0.6650055         1.0000000 #> 6     0.1939309         0.9696543 #> 7     0.6650055         1.0000000 #> 8     0.3123214         1.0000000 #> 9     0.8852339         1.0000000 #> 10    0.8852339         1.0000000"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_diversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Tsallis diversity per gene across samples — calculate_diversity","title":"Calculate Tsallis diversity per gene across samples — calculate_diversity","text":"Calculate Tsallis diversity per gene across samples","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_diversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Tsallis diversity per gene across samples — calculate_diversity","text":"","code":"calculate_diversity(   x,   genes = NULL,   norm = TRUE,   tpm = FALSE,   assayno = 1,   verbose = FALSE,   q = 2,   what = c(\"S\", \"D\") )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_diversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Tsallis diversity per gene across samples — calculate_diversity","text":"x numeric matrix data.frame transcript-level expression values (rows = transcripts, columns = samples), SummarizedExperiment- like object. genes Character vector assigning transcript (row) gene. Must length equal nrow(x) number transcripts `x`. norm Logical; TRUE, normalize Tsallis entropy [0,1] per gene. tpm Logical. TRUE `x` tximport-style list, use `$abundance` matrix instead `$counts`. assayno Integer assay index use `x` SummarizedExperiment. verbose Logical; print diagnostic messages TRUE. q Numeric scalar vector Tsallis q values evaluate (q > 0). length(q) > 1, result contain separate columns per sample q. quantity return: \"S\" Tsallis entropy \"D\" Hill numbers.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_diversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Tsallis diversity per gene across samples — calculate_diversity","text":"SummarizedExperiment assay `diversity` containing per-gene diversity values.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_diversity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Tsallis diversity per gene across samples — calculate_diversity","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = 0.1, norm = TRUE) SummarizedExperiment::assay(se)[1:3, 1:3] #>         TCGA-A7-A0CH_N TCGA-A7-A0CH_T TCGA-A7-A0D9_N #> MXRA8        0.8409985      0.8149525      0.7861211 #> C1orf86      0.0000000      0.0000000      0.0000000 #> PDPN         0.3486679      0.3395884      0.0000000"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_fc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate splicing diversity changes between two conditions. — calculate_fc","title":"Calculate splicing diversity changes between two conditions. — calculate_fc","text":"Calculate splicing diversity changes two conditions.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_fc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate splicing diversity changes between two conditions. — calculate_fc","text":"","code":"calculate_fc(x, samples, control, method = \"mean\", pseudocount = 0)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_fc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate splicing diversity changes between two conditions. — calculate_fc","text":"x matrix splicing diversity values. samples Character vector equal length number columns input dataset, specifying category sample. control Name control sample category, defined samples vector, e.g. control = 'Normal' control = 'WT'. method Method use calculating average splicing diversity value condition. Can 'mean' 'median'. pseudocount Numeric scalar. Small value added non-positive observed group summaries avoid zeros computing differences log2 fold-changes. pseudocount = 0 (default) function choose small value equal half smallest positive observed value, 1e-6 positive values present. Rows insufficient observations remain NA imputed.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_fc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate splicing diversity changes between two conditions. — calculate_fc","text":"data.frame mean median value splicing diversity across sample categories, difference values log2 fold change values.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_fc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate splicing diversity changes between two conditions. — calculate_fc","text":"function uses matrix splicing diversity values order calculate mean median differences log2 fold changes two conditions.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_lm_interaction.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear-model interaction test for Tsallis entropy For each gene, fit a linear model of the form `entropy ~ q * group` and extract the p-value for the interaction term (whether the effect of `q` differs between groups). The function expects a `SummarizedExperiment` produced by `calculate_diversity()` when multiple `q` values have been computed (column names contain `_q=`). — calculate_lm_interaction","title":"Linear-model interaction test for Tsallis entropy For each gene, fit a linear model of the form `entropy ~ q * group` and extract the p-value for the interaction term (whether the effect of `q` differs between groups). The function expects a `SummarizedExperiment` produced by `calculate_diversity()` when multiple `q` values have been computed (column names contain `_q=`). — calculate_lm_interaction","text":"Linear-model interaction test Tsallis entropy   gene, fit linear model form `entropy ~ q * group`  extract p-value interaction term (whether effect `q`  differs groups). function expects `SummarizedExperiment`  produced `calculate_diversity()` multiple `q` values  computed (column names contain `_q=`).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_lm_interaction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear-model interaction test for Tsallis entropy For each gene, fit a linear model of the form `entropy ~ q * group` and extract the p-value for the interaction term (whether the effect of `q` differs between groups). The function expects a `SummarizedExperiment` produced by `calculate_diversity()` when multiple `q` values have been computed (column names contain `_q=`). — calculate_lm_interaction","text":"","code":"calculate_lm_interaction(   se,   sample_type_col = NULL,   min_obs = 10,   method = c(\"linear\", \"lmm\", \"gam\", \"fpca\"),   pvalue = c(\"satterthwaite\", \"lrt\", \"both\"),   subject_col = NULL,   paired = FALSE,   nthreads = 1,   assay_name = \"diversity\",   verbose = TRUE )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_lm_interaction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear-model interaction test for Tsallis entropy For each gene, fit a linear model of the form `entropy ~ q * group` and extract the p-value for the interaction term (whether the effect of `q` differs between groups). The function expects a `SummarizedExperiment` produced by `calculate_diversity()` when multiple `q` values have been computed (column names contain `_q=`). — calculate_lm_interaction","text":"se `SummarizedExperiment` containing `diversity` assay produced `calculate_diversity(..., q = <vector>)`. sample_type_col Optional column name `colData(se)` contains grouping factor samples (character). `NULL`, function attempt infer group column names (suffix `_N` interpreted \"Normal\"). min_obs Minimum number non-NA observations required fit model gene (default: 10). method Modeling method use interaction testing: one c(\"linear\", \"gam\", \"fpca\"). nthreads Number threads (mc.cores) use parallel processing (default: 1). assay_name Name assay SummarizedExperiment use (default: \"diversity\").","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_lm_interaction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear-model interaction test for Tsallis entropy For each gene, fit a linear model of the form `entropy ~ q * group` and extract the p-value for the interaction term (whether the effect of `q` differs between groups). The function expects a `SummarizedExperiment` produced by `calculate_diversity()` when multiple `q` values have been computed (column names contain `_q=`). — calculate_lm_interaction","text":"data.frame columns `gene`, `p_interaction`, `adj_p_interaction`, ordered ascending `p_interaction`.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_lm_interaction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear-model interaction test for Tsallis entropy For each gene, fit a linear model of the form `entropy ~ q * group` and extract the p-value for the interaction term (whether the effect of `q` differs between groups). The function expects a `SummarizedExperiment` produced by `calculate_diversity()` when multiple `q` values have been computed (column names contain `_q=`). — calculate_lm_interaction","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = c(0.1, 1), norm = TRUE) # Provide a minimal sample-type mapping so the example runs during checks SummarizedExperiment::colData(se) <- S4Vectors::DataFrame(   sample_type = rep(c(\"Normal\", \"Tumor\"), length.out = ncol(se)),   row.names = colnames(se) ) calculate_lm_interaction(se, sample_type_col = \"sample_type\") #> [calculate_lm_interaction] method=linear #> [calculate_lm_interaction] parsed samples and groups #> data frame with 0 columns and 0 rows"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_method.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Tsallis diversity values for transcripts grouped by gene — calculate_method","title":"Calculate Tsallis diversity values for transcripts grouped by gene — calculate_method","text":"Calculate Tsallis diversity values transcripts grouped gene","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Tsallis diversity values for transcripts grouped by gene — calculate_method","text":"","code":"calculate_method(   x,   genes,   norm = TRUE,   verbose = FALSE,   q = 2,   what = c(\"S\", \"D\") )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Tsallis diversity values for transcripts grouped by gene — calculate_method","text":"x Numeric matrix data.frame transcript-level expression values (rows = transcripts, columns = samples). genes Character vector length equal nrow(x) assigning transcript gene. norm Logical; TRUE normalize Tsallis entropy values per gene. verbose Logical; show diagnostic messages TRUE. q Numeric scalar vector q values evaluate. quantity return `calculate_tsallis_entropy`: \"S\" (Tsallis entropy) \"D\" (Hill numbers) (default: \"S\").","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Tsallis diversity values for transcripts grouped by gene — calculate_method","text":"data.frame genes first column per-sample (per-q) Tsallis entropy values subsequent columns.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","title":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","text":"Calculate Tsallis entropy vector transcript-level expression values one gene.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","text":"","code":"calculate_tsallis_entropy(   x,   q = 2,   norm = TRUE,   what = c(\"S\", \"D\", \"both\"),   log_base = exp(1) )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","text":"x Vector (non-negative) expression values. q Tsallis entropy parameter (q > 0). Scalar numeric vector (default: 2). norm Logical; TRUE, normalize entropy theoretical maximum (values [0,1]). quantity return: \"S\" (Tsallis entropy), \"D\" (Hill numbers), \"\". log_base Base logarithm used Shannon limits normalization (default: exp(1)).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","text":"`= \"S\"` `= \"D\"`: numeric vector (named length(q) > 1). `= \"\"`: list components `$S` `$D`.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","text":"Implements S_q = (1 - sum p^q)/(q - 1) D_q = (sum p^q)^(1/(1-q)). Uses q->1 limits (Shannon entropy exponential). Natural logarithms used q->1 limit normalization.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/calculate_tsallis_entropy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Tsallis entropy for a vector of transcript-level expression values of one gene. — calculate_tsallis_entropy","text":"","code":"x <- c(10, 5, 0) calculate_tsallis_entropy(x, q = c(0.5, 1, 2), norm = TRUE) #>     q=0.5       q=1       q=2  #> 0.5380048 0.5793802 0.6666667"},{"path":"https://gallardoalba.github.io/TSENAT/reference/infer_sample_group.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer sample group from sample names — infer_sample_group","title":"Infer sample group from sample names — infer_sample_group","text":"Infer sample group sample names","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/infer_sample_group.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer sample group from sample names — infer_sample_group","text":"","code":"infer_sample_group(   sample_names,   suffix_sep = \"_\",   suffix_map = NULL,   tcga_map = NULL,   coldata = NULL,   coldata_sample_col = \"Sample\",   coldata_condition_col = \"Condition\",   prefer_suffix = TRUE,   default = NA_character_ )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/infer_sample_group.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer sample group from sample names — infer_sample_group","text":"sample_names Character vector sample names. suffix_sep Character separator detect suffix groups (default \"_\"). suffix_map Named character vector mapping suffix tokens (case- insensitive)  group labels, e.g. c(N = \"Normal\", T = \"Tumor\"). tcga_map Named character vector mapping TCGA two-digit codes group labels, e.g. c(\"01\" = \"Tumor\", \"11\" = \"Normal\"). coldata Optional data.frame named vector providing mapping sample names conditions. data.frame, specify `coldata_sample_col` `coldata_condition_col` relevant columns. coldata_sample_col Column name `coldata` indicating sample IDs (default \"Sample\"). coldata_condition_col Column name `coldata` condition/label (default \"Condition\"). prefer_suffix Logical; TRUE, prefer suffix-based inference patterns match. default Character scalar returned mapping applies (default NA_character_).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/infer_sample_group.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer sample group from sample names — infer_sample_group","text":"Character vector group labels (`default` value) length `sample_names`.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/infer_sample_group.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Infer sample group from sample names — infer_sample_group","text":"","code":"infer_sample_group(c(\"S1_N\", \"TCGA-XX-01A\")) #> [1] \"N\"  \"01\" infer_sample_group(c(\"S1_N\", \"S2_T\"), suffix_map = c(     N = \"Normal\", T =         \"Tumor\" )) #> [1] \"Normal\" \"Tumor\"  tcga_map <- c(\"01\" = \"Tumor\") infer_sample_group(c(\"TCGA-XX-01A\", \"Sample_N\"),     tcga_map = tcga_map,     prefer_suffix = FALSE ) #> [1] \"Tumor\" \"N\""},{"path":"https://gallardoalba.github.io/TSENAT/reference/label_shuffling.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate p-values using label shuffling. — label_shuffling","title":"Calculate p-values using label shuffling. — label_shuffling","text":"Calculate p-values using label shuffling.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/label_shuffling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate p-values using label shuffling. — label_shuffling","text":"","code":"label_shuffling(   x,   samples,   control,   method,   randomizations = 100,   pcorr = \"BH\",   paired = FALSE,   paired_method = c(\"swap\", \"signflip\") )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/label_shuffling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate p-values using label shuffling. — label_shuffling","text":"x matrix splicing diversity values. samples Character vector equal length number columns input dataset, specifying category sample. control Name control sample category, defined samples vector, e.g. control = 'Normal' control = 'WT'. method Method use calculating average splicing diversity value condition. Can 'mean' 'median'. randomizations number random shuffles. pcorr P-value correction method applied results, defined \\codep.adjust function. paired Logical; TRUE perform paired permutation scheme (default: FALSE). paired TRUE, permutations preserve pairing samples; function currently permutes sample labels therefore paired analyses meaningful caller arranged samples accordingly. paired_method Character; method paired permutations. One \"swap\" (randomly swap labels within pairs) \"signflip\" (perform sign-flip permutations; can enumerate 2^n_pairs combinations exact test randomizations = 0 randomizations >= 2^n_pairs).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/label_shuffling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate p-values using label shuffling. — label_shuffling","text":"Raw corrected p-values.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/label_shuffling.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate p-values using label shuffling. — label_shuffling","text":"permutation p-values computed two-sided proportion permuted log2 fold-changes least extreme observed value, pseudocount added: (count + 1) / (n_perm + 1).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/label_shuffling.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Calculate p-values using label shuffling. — label_shuffling","text":"permutation test returns two-sided empirical p-values using pseudocount avoid zero p-values small numbers permutations. See function documentation details.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/map_coldata_to_se.html","id":null,"dir":"Reference","previous_headings":"","what":"Map external coldata into a SummarizedExperiment — map_coldata_to_se","title":"Map external coldata into a SummarizedExperiment — map_coldata_to_se","text":"Map external `coldata` table (sample IDs condition/label column) `SummarizedExperiment` produced `calculate_diversity()`. helper sets `colData(ts_se)$sample_type` possible records `sample_base` identifier column. Unmatched entries remain NA automatic inference attempted.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/map_coldata_to_se.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map external coldata into a SummarizedExperiment — map_coldata_to_se","text":"","code":"map_coldata_to_se(   ts_se,   coldata,   coldata_sample_col = \"Sample\",   coldata_condition_col = \"Condition\",   paired = FALSE )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/map_coldata_to_se.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map external coldata into a SummarizedExperiment — map_coldata_to_se","text":"ts_se `SummarizedExperiment` whose assay columns named sample identifiers. Names may include per-sample annotations; mapping exact case-sensitive unless normalize identifiers beforehand. coldata data.frame sample metadata (`NULL`). coldata_sample_col Name column `coldata` containing sample identifiers (default: \"Sample\"). coldata_condition_col Name column `coldata` condition/labels (default: \"Condition\"). paired Logical; `TRUE`, validate pairing reorder columns matched samples base adjacent (default: `FALSE`). Use `paired = TRUE` paired analyses downstream paired tests see aligned samples regardless original `coldata` order.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/map_coldata_to_se.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map external coldata into a SummarizedExperiment — map_coldata_to_se","text":"input `ts_se` `colData(ts_se)$sample_type` populated possible. `colData(ts_se)$sample_base` also added containing base sample identifier; rownames `colData(ts_se)` aligned assay column names.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/map_coldata_to_se.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map external coldata into a SummarizedExperiment — map_coldata_to_se","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = 0.1, norm = TRUE) sample_names <- sub(\"_q=.*\", \"\", colnames(SummarizedExperiment::assay(se))) coldata_df <- data.frame(Sample = sample_names, Condition = rep(c(\"A\", \"B\"),     length.out = ncol(se) )) map_coldata_to_se(se, coldata_df) #> class: SummarizedExperiment  #> dim: 6 40  #> metadata(4): method norm q what #> assays(1): diversity #> rownames(6): MXRA8 C1orf86 ... HNRNPR C1orf213 #> rowData names(1): genes #> colnames(40): TCGA-A7-A0CH_N TCGA-A7-A0CH_T ... TCGA-BH-A0BV_T #>   TCGA-BH-A0BV_N #> colData names(3): samples sample_type sample_base # Optionally validate pairs when appropriate map_coldata_to_se(se, coldata_df, paired = TRUE) #> class: SummarizedExperiment  #> dim: 6 40  #> metadata(4): method norm q what #> assays(1): diversity #> rownames(6): MXRA8 C1orf86 ... HNRNPR C1orf213 #> rowData names(1): genes #> colnames(40): TCGA-A7-A0CH_N TCGA-A7-A0CH_T ... TCGA-BH-A0BV_T #>   TCGA-BH-A0BV_N #> colData names(3): samples sample_type sample_base"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_diversity_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diversity distributions (density) by sample type — plot_diversity_density","title":"Plot diversity distributions (density) by sample type — plot_diversity_density","text":"Plot diversity distributions (density) sample type","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_diversity_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diversity distributions (density) by sample type — plot_diversity_density","text":"","code":"plot_diversity_density(se, assay_name = \"diversity\", sample_type_col = NULL)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_diversity_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diversity distributions (density) by sample type — plot_diversity_density","text":"se `SummarizedExperiment` returned `calculate_diversity`. assay_name Name assay use (default: \"diversity\"). sample_type_col Optional column name `colData(se)` sample types.  missing, sample types inferred column names (suffix last underscore) set 'Group'.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_diversity_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diversity distributions (density) by sample type — plot_diversity_density","text":"`ggplot` object layered density plots.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_diversity_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diversity distributions (density) by sample type — plot_diversity_density","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = 0.1, norm = TRUE) plot_diversity_density(se)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_ma.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot MA plot for difference results — plot_ma","title":"Plot MA plot for difference results — plot_ma","text":"Plot MA plot difference results","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_ma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot MA plot for difference results — plot_ma","text":"","code":"plot_ma(   diff_df,   mean_cols = NULL,   fold_col = \"log2_fold_change\",   padj_col = \"adjusted_p_values\",   sig_alpha = 0.05 )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_ma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot MA plot for difference results — plot_ma","text":"diff_df Data.frame `calculate_difference()` containing mean columns, `log2_fold_change` column, `adjusted_p_values`. mean_cols Optional character vector length 2 naming mean columns.  Defaults first two columns end `_mean`. fold_col Name fold-change column (default: `log2_fold_change`). padj_col Name adjusted p-value column (default: `adjusted_p_values`). sig_alpha Threshold significance (default: 0.05).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_ma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot MA plot for difference results — plot_ma","text":"`ggplot` MA-plot object.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_ma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot MA plot for difference results — plot_ma","text":"","code":"df <- data.frame(     gene = paste0(\"g\", seq_len(10)),     sampleA_mean = runif(10),     sampleB_mean = runif(10),     log2_fold_change = rnorm(10),     adjusted_p_values = runif(10) ) plot_ma(df)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_mean_violin.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot violin of per-gene mean diversity by sample type — plot_mean_violin","title":"Plot violin of per-gene mean diversity by sample type — plot_mean_violin","text":"Plot violin per-gene mean diversity sample type","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_mean_violin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot violin of per-gene mean diversity by sample type — plot_mean_violin","text":"","code":"plot_mean_violin(se, assay_name = \"diversity\", sample_type_col = NULL)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_mean_violin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot violin of per-gene mean diversity by sample type — plot_mean_violin","text":"se `SummarizedExperiment` returned `calculate_diversity`. assay_name Name assay use (default: \"diversity\"). sample_type_col Optional column name `colData(se)` containing sample types.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_mean_violin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot violin of per-gene mean diversity by sample type — plot_mean_violin","text":"`ggplot` violin plot object.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_mean_violin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot violin of per-gene mean diversity by sample type — plot_mean_violin","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = 0.1, norm = TRUE) plot_mean_violin(se)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_top_transcripts.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot top transcripts for a gene #' For a given gene, find transcripts using a tx->gene mapping, compute per- Plot top transcripts for a gene For a given gene, find transcripts using a tx->gene mapping, compute per- transcript statistics between two sample groups, select the top N transcripts by p-value and plot their expression across groups. — plot_top_transcripts","title":"Plot top transcripts for a gene #' For a given gene, find transcripts using a tx->gene mapping, compute per- Plot top transcripts for a gene For a given gene, find transcripts using a tx->gene mapping, compute per- transcript statistics between two sample groups, select the top N transcripts by p-value and plot their expression across groups. — plot_top_transcripts","text":"Plot top transcripts gene   #' given gene, find transcripts using tx->gene mapping, compute per-  Plot top transcripts gene   given gene, find transcripts using tx->gene mapping, compute per- transcript statistics two sample groups, select top N transcripts p-value plot expression across groups.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_top_transcripts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot top transcripts for a gene #' For a given gene, find transcripts using a tx->gene mapping, compute per- Plot top transcripts for a gene For a given gene, find transcripts using a tx->gene mapping, compute per- transcript statistics between two sample groups, select the top N transcripts by p-value and plot their expression across groups. — plot_top_transcripts","text":"counts Matrix data.frame transcript counts. Rows transcripts columns samples. gene Character; gene symbol inspect. samples Character vector sample group labels (length = ncol(counts)). tx2gene Path data.frame mapping transcripts genes. Must contain columns `Transcript` `Gen`. top_n Integer number transcripts show (default = 3). Use NULL plot transcripts gene. pseudocount Numeric pseudocount added log2 (default = 1e-6) avoid division zero. output_file Optional file path save plot. `NULL`, `ggplot` object returned. metric Aggregation metric used summarize transcript expression per group plotting. One c(\"median\", \"mean\", \"variance\"). Defaults \"median\" preserve previous behavior.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_top_transcripts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot top transcripts for a gene #' For a given gene, find transcripts using a tx->gene mapping, compute per- Plot top transcripts for a gene For a given gene, find transcripts using a tx->gene mapping, compute per- transcript statistics between two sample groups, select the top N transcripts by p-value and plot their expression across groups. — plot_top_transcripts","text":"`ggplot` object (invisibly saved file `output_file` provided).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_top_transcripts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot top transcripts for a gene #' For a given gene, find transcripts using a tx->gene mapping, compute per- Plot top transcripts for a gene For a given gene, find transcripts using a tx->gene mapping, compute per- transcript statistics between two sample groups, select the top N transcripts by p-value and plot their expression across groups. — plot_top_transcripts","text":"","code":"tx_counts <- matrix(     sample(1:100, 24, replace = TRUE),     nrow = 6 ) rownames(tx_counts) <- paste0(\"tx\", seq_len(nrow(tx_counts))) colnames(tx_counts) <- paste0(\"S\", seq_len(ncol(tx_counts)))  tx2gene <- data.frame(     Transcript = rownames(tx_counts),     Gen = rep(paste0(\"G\", seq_len(3)), each = 2),     stringsAsFactors = FALSE )  samples <- rep(c(\"Normal\", \"Tumor\"), length.out = ncol(tx_counts))  plot_top_transcripts(     tx_counts,     gene = c(\"G1\", \"G2\"),     samples = samples,     tx2gene = tx2gene,     top_n = 2 )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_density_multq.html","id":null,"dir":"Reference","previous_headings":"","what":"Density plot of Tsallis entropy for multiple q values — plot_tsallis_density_multq","title":"Density plot of Tsallis entropy for multiple q values — plot_tsallis_density_multq","text":"Density plot Tsallis entropy multiple q values","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_density_multq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density plot of Tsallis entropy for multiple q values — plot_tsallis_density_multq","text":"","code":"plot_tsallis_density_multq(se, assay_name = \"diversity\")"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_density_multq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density plot of Tsallis entropy for multiple q values — plot_tsallis_density_multq","text":"se `SummarizedExperiment` returned `calculate_diversity` multiple q values (column names contain `_q=`). assay_name Name assay use (default: \"diversity\").","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_density_multq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density plot of Tsallis entropy for multiple q values — plot_tsallis_density_multq","text":"`ggplot` density plot object faceted q colored group.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_density_multq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Density plot of Tsallis entropy for multiple q values — plot_tsallis_density_multq","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = c(0.1, 1), norm = TRUE) plot_tsallis_density_multq(se)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_gene_profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot q-curve profile for a single gene comparing groups — plot_tsallis_gene_profile","title":"Plot q-curve profile for a single gene comparing groups — plot_tsallis_gene_profile","text":"selected gene, plot per-sample Tsallis entropy across q values overlay per-group median +/- IQR ribbons group-level differences easy compare. Expects `SummarizedExperiment` produced `calculate_diversity()` `_q=` suffixes column names.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_gene_profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot q-curve profile for a single gene comparing groups — plot_tsallis_gene_profile","text":"","code":"plot_tsallis_gene_profile(   se,   gene,   assay_name = \"diversity\",   sample_type_col = \"sample_type\",   show_samples = FALSE )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_gene_profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot q-curve profile for a single gene comparing groups — plot_tsallis_gene_profile","text":"se `SummarizedExperiment` `calculate_diversity()`. gene Character scalar; gene symbol plot. assay_name Name assay use (default: \"diversity\"). sample_type_col Column name `colData(se)` sample type labels (default: \"sample_type\"). missing, single-group fallback used. show_samples Logical; TRUE, draw per-sample lines background (default: FALSE).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_gene_profile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot q-curve profile for a single gene comparing groups — plot_tsallis_gene_profile","text":"`ggplot` object showing gene q-curve profile group.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_q_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot median +- IQR of Tsallis entropy across q values by group — plot_tsallis_q_curve","title":"Plot median +- IQR of Tsallis entropy across q values by group — plot_tsallis_q_curve","text":"reproduces `tsallis-q-curve-mean-sd` plot vignette: q value, compute per-gene Tsallis entropy per sample, summarize across genes group (median IQR) plot median ribbon spanning median +- IQR/2.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_q_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot median +- IQR of Tsallis entropy across q values by group — plot_tsallis_q_curve","text":"","code":"plot_tsallis_q_curve(   se,   assay_name = \"diversity\",   sample_type_col = \"sample_type\" )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_q_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot median +- IQR of Tsallis entropy across q values by group — plot_tsallis_q_curve","text":"se `SummarizedExperiment` returned `calculate_diversity`. assay_name Name assay use (default: \"diversity\"). sample_type_col Column name `colData(se)` containing sample type labels (default: \"sample_type\").","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_q_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot median +- IQR of Tsallis entropy across q values by group — plot_tsallis_q_curve","text":"`ggplot` object showing median +- IQR across q values group.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_q_curve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot median +- IQR of Tsallis entropy across q values by group — plot_tsallis_q_curve","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:40, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:40] se <- calculate_diversity(rc, gs,    q = seq(0.01, 0.1, by = 0.03), norm = TRUE) p <- plot_tsallis_q_curve(se) p"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_top_lm_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot q-curves for top linear-model genes — plot_tsallis_top_lm_genes","title":"Plot q-curves for top linear-model genes — plot_tsallis_top_lm_genes","text":"Select top genes lm interaction result (`lm_res`) adjusted p-value (robust common column names). Compute median ± IQR across samples per gene plot q-curve selected gene. Returns `ggplot` object.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_top_lm_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot q-curves for top linear-model genes — plot_tsallis_top_lm_genes","text":"","code":"plot_tsallis_top_lm_genes(   se,   lm_res = NULL,   lm_res2 = NULL,   top_n = 6,   assay_name = \"diversity\",   sample_type_col = \"sample_type\" )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_top_lm_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot q-curves for top linear-model genes — plot_tsallis_top_lm_genes","text":"se `SummarizedExperiment` produced `calculate_diversity()`. lm_res Optional data.frame linear-model results. provided, function try find p-value column select top genes smallest adjusted p-value. top_n Number top genes plot `lm_res` used (default: 6). assay_name Assay name `se` use `hill` available (default: \"diversity\"). sample_type_col Column name `colData(se)` containing group labels (default: \"sample_type\").","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_top_lm_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot q-curves for top linear-model genes — plot_tsallis_top_lm_genes","text":"`ggplot` object plotting median ± IQR q-curves selected genes.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_violin_multq.html","id":null,"dir":"Reference","previous_headings":"","what":"Violin plot of Tsallis entropy for multiple q values — plot_tsallis_violin_multq","title":"Violin plot of Tsallis entropy for multiple q values — plot_tsallis_violin_multq","text":"Violin plot Tsallis entropy multiple q values","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_violin_multq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Violin plot of Tsallis entropy for multiple q values — plot_tsallis_violin_multq","text":"","code":"plot_tsallis_violin_multq(se, assay_name = \"diversity\")"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_violin_multq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Violin plot of Tsallis entropy for multiple q values — plot_tsallis_violin_multq","text":"se `SummarizedExperiment` returned `calculate_diversity` multiple q values (column names contain `_q=`). assay_name Name assay use (default: \"diversity\").","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_violin_multq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Violin plot of Tsallis entropy for multiple q values — plot_tsallis_violin_multq","text":"`ggplot` violin plot object faceted/colored group q.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_tsallis_violin_multq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Violin plot of Tsallis entropy for multiple q values — plot_tsallis_violin_multq","text":"","code":"data(\"tcga_brca_luma_dataset\", package = \"TSENAT\") rc <- as.matrix(tcga_brca_luma_dataset[1:20, -1, drop = FALSE]) gs <- tcga_brca_luma_dataset$genes[1:20] se <- calculate_diversity(rc, gs, q = c(0.1, 1), norm = TRUE) plot_tsallis_violin_multq(se)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_volcano.html","id":null,"dir":"Reference","previous_headings":"","what":"Volcano plot for differential results — plot_volcano","title":"Volcano plot for differential results — plot_volcano","text":"Volcano plot differential results","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_volcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Volcano plot for differential results — plot_volcano","text":"","code":"plot_volcano(   diff_df,   x_col = \"mean_difference\",   padj_col = \"adjusted_p_values\",   label_thresh = 0.1,   padj_thresh = 0.05,   top_n = 5 )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_volcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Volcano plot for differential results — plot_volcano","text":"diff_df Data.frame `calculate_difference()` containing least `mean_difference` adjusted p-value column (default `adjusted_p_values`). x_col Column name x-axis (default `mean_difference`). padj_col Column name adjusted p-values (default `adjusted_p_values`). label_thresh Absolute x threshold mark significance (default 0.1). padj_thresh Adjusted p-value cutoff (default 0.05). top_n Integer; number top genes annotate smallest adjusted p-value (default: 5).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_volcano.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Volcano plot for differential results — plot_volcano","text":"ggplot volcano plot.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/plot_volcano.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Volcano plot for differential results — plot_volcano","text":"","code":"df <- data.frame(     gene = paste0(\"g\", seq_len(10)),     mean_difference = runif(10),     adjusted_p_values = runif(10) ) plot_volcano(df, x_col = \"mean_difference\", padj_col = \"adjusted_p_values\")"},{"path":"https://gallardoalba.github.io/TSENAT/reference/tcga_brca_luma_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"TCGA Luminal A breast cancer dataset — tcga_brca_luma_dataset","title":"TCGA Luminal A breast cancer dataset — tcga_brca_luma_dataset","text":"Data Cancer Genome Atlas, downloaded 08th September, 2020. contains transcript level read counts 20 patients Luminal type breast cancer (primary tumor solid normal samples).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/tcga_brca_luma_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TCGA Luminal A breast cancer dataset — tcga_brca_luma_dataset","text":"","code":"data(tcga_brca_luma_dataset)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/tcga_brca_luma_dataset.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"TCGA Luminal A breast cancer dataset — tcga_brca_luma_dataset","text":"data frame 996 rows 41 columns. first column contains gene names, additional columns contain RNA-sequencing read counts samples.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/tcga_brca_luma_dataset.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"TCGA Luminal A breast cancer dataset — tcga_brca_luma_dataset","text":"TCGA via GDC","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/tcga_brca_luma_dataset.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"TCGA Luminal A breast cancer dataset — tcga_brca_luma_dataset","text":"Cancer Genome Atlas Network (2012) Nature 490, 61–70 doi:10.1038/nature11412","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/test_differential.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a differential test by name: Wilcoxon or label-shuffle — test_differential","title":"Run a differential test by name: Wilcoxon or label-shuffle — test_differential","text":"Thin wrapper selects `wilcoxon()` `label_shuffling()`.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/test_differential.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a differential test by name: Wilcoxon or label-shuffle — test_differential","text":"","code":"test_differential(   x,   samples,   control = NULL,   method = c(\"wilcoxon\", \"shuffle\"),   fc_method = \"mean\",   paired = FALSE,   exact = FALSE,   randomizations = 100,   pcorr = \"BH\",   seed = 123L,   paired_method = c(\"swap\", \"signflip\") )"},{"path":"https://gallardoalba.github.io/TSENAT/reference/test_differential.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a differential test by name: Wilcoxon or label-shuffle — test_differential","text":"x matrix splicing diversity values (rows = features). samples Character vector sample group labels (length = ncol(x)). control Name control group (required label-shuffle). method Character; one `\"wilcoxon\"` `\"shuffle\"`. fc_method Character; aggregation method used permutation test `method = \"shuffle\"` (\"mean\" \"median\"). paired Logical passed `wilcoxon()` using Wilcoxon test. exact Logical passed `wilcoxon()` request exact p-values. randomizations Integer number permutations `label_shuffling()`. pcorr P-value adjustment method (passed `p.adjust`). seed Integer seed used make permutations reproducible (default 123). function calls `set.seed(seed)` running `label_shuffling()` `method = \"shuffle\"`. paired_method Character; forwarded `label_shuffling()` `method = \"shuffle\"`. See `label_shuffling()` details.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/test_differential.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a differential test by name: Wilcoxon or label-shuffle — test_differential","text":"two-column matrix raw adjusted p-values (returned   underlying functions).","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/wilcoxon.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate p-values using Wilcoxon rank sum test. — wilcoxon","title":"Calculate p-values using Wilcoxon rank sum test. — wilcoxon","text":"Calculate p-values using Wilcoxon rank sum test.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/wilcoxon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate p-values using Wilcoxon rank sum test. — wilcoxon","text":"","code":"wilcoxon(x, samples, pcorr = \"BH\", paired = FALSE, exact = FALSE)"},{"path":"https://gallardoalba.github.io/TSENAT/reference/wilcoxon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate p-values using Wilcoxon rank sum test. — wilcoxon","text":"x matrix splicing diversity values. samples Character vector equal length number columns input dataset, specifying category sample. pcorr P-value correction method applied results, defined p.adjust function. paired TRUE, Wilcox-test paired, therefore signed rank test instead rank sum test. exact TRUE, exact p-value computed.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/reference/wilcoxon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate p-values using Wilcoxon rank sum test. — wilcoxon","text":"Raw corrected p-values matrix.","code":""},{"path":"https://gallardoalba.github.io/TSENAT/news/index.html","id":"tsenat-0990","dir":"Changelog","previous_headings":"","what":"TSENAT 0.99.0","title":"TSENAT 0.99.0","text":"TSENAT computes Tsallis entropy (S_q) related Hill numbers (D_q) quantify isoform/transcript-level diversity per gene. package accepts matrices, tximport-style lists, SummarizedExperiment objects, returns per-gene diversity assays, provides plotting simple differential-analysis helpers. vignette demonstrates full workflow TCGA Luminal example. Highlights:","code":"Core: calculate_tsallis_entropy() — compute S_q and D_q (supports multiple q values and the q->1 Shannon limit). Batch processing: calculate_diversity() applies the calculation across transcripts/genes and returns a SummarizedExperiment with a \"diversity\" assay. Differential helpers: group comparisons, fold changes and simple tests. Visualizations: density, violin, q-curve, MA, volcano, and top-transcripts plots (return ggplot objects)."}]
