Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity... OK
Checking R version dependency... OK
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews...
Consider adding these automatically suggested biocViews: GeneExpression, DifferentialExpression
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer...
Use Authors@R field not Author/Maintainer fields. Do not use both.
Consider adding the maintainer's ORCID iD in 'Authors@R' with 'comment=c(ORCID="...")'
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking NAMESPACE... OK
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders...
Remove 'inst/doc' folder from the package source
Checking vignette directory...
Potential intermediate files found:
vignettes/tsenat.html
Checking package installation calls in R code... OK
Checking for library/require of TSENAT... OK
Checking coding practice... OK
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths...
The recommended function length is 50 lines or less. There are 12 functions greater than 50 lines.
The longest 5 functions are:
plot_top_transcripts() (R/generate_plots.R): 230 lines
calculate_lm_interaction() (R/calculate_difference.R): 160 lines
calculate_difference() (R/calculate_difference.R): 128 lines
calculate_diversity() (R/calculate_diversity.R): 115 lines
fit_one() (R/calculate_difference.R): 111 lines
Checking man page documentation... OK
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 142 lines (6%) are > 80 characters long.
First few lines:
R/calculate_difference.R#L56 #' calculate_difference(x, samples, cont ...
R/calculate_difference.R#L63     if (inherits(x, "RangedSummarizedExp ...
R/calculate_difference.R#L64       if (length(samples) != 1) stop("Fo ...
R/calculate_difference.R#L66       if (!is.numeric(assayno) || length ...
R/calculate_difference.R#L76   .tsenat_sample_matrix <- function(dfr) ...
R/calculate_difference.R#L84   if (!(is.data.frame(x) || inherits(x,  ...
R/calculate_difference.R#L95   if (ncol(df) - 1 != length(samples)) s ...
R/calculate_difference.R#L102              different sample conditions ...
R/calculate_difference.R#L104   if (length(groups) < 2) stop("The numb ...
R/calculate_difference.R#L105            different sample conditions,  ...
R/calculate_difference.R#L106   if (!(control %in% samples)) stop("Thi ...
R/calculate_difference.R#L107   if (!(method %in% c("mean", "median")) ...
R/calculate_difference.R#L109   if (!(test %in% c("wilcoxon", "shuffle ...
R/calculate_difference.R#L111   valid_pcorr <- c("holm", "hochberg", " ...
R/calculate_difference.R#L112   if (!(pcorr %in% valid_pcorr)) stop("I ...
R/calculate_difference.R#L119       message("Note: The 'randomizations ...
R/calculate_difference.R#L124             three samples in a given cat ...
R/calculate_difference.R#L125                           theoretical p- ...
R/calculate_difference.R#L130       warning("Low sample size, not enou ...
R/calculate_difference.R#L146     keep_mask <- (df$cond_1 >= 3 & df$co ...
R/calculate_difference.R#L156   # Helper to extract the numeric matrix ...
R/calculate_difference.R#L160     if (nrow(df_small) > 0 && verbose) m ...
R/calculate_difference.R#L169     result_list$tested <- data.frame(gen ...
R/calculate_difference.R#L174     result_list$small <- data.frame(gene ...
R/calculate_difference.R#L217                                      met ...
R/calculate_difference.R#L221   if (!requireNamespace("SummarizedExper ...
R/calculate_difference.R#L224   if (is.null(mat)) stop(sprintf("`%s` a ...
R/calculate_difference.R#L227   if (is.null(sample_q) || length(sample ...
R/calculate_difference.R#L232   if (all(is.na(q_vals))) stop("Could no ...
R/calculate_difference.R#L235   if (!is.null(sample_type_col) && sampl ...
R/calculate_difference.R#L238     # when user provides a sample_type_c ...
R/calculate_difference.R#L241     # infer group from sample names usin ...
R/calculate_difference.R#L245   message("[calculate_lm_interaction] pa ...
R/calculate_difference.R#L268       return(data.frame(gene = g, p_inte ...
R/calculate_difference.R#L272       if (!requireNamespace("mgcv", quie ...
R/calculate_difference.R#L276       fit_null <- try(mgcv::gam(entropy  ...
R/calculate_difference.R#L277       fit_alt <- try(mgcv::gam(entropy ~ ...
R/calculate_difference.R#L285       # anova.gam returns a table; p-val ...
R/calculate_difference.R#L292         } else if ("p-value" %in% colnam ...
R/calculate_difference.R#L294       return(data.frame(gene = g, p_inte ...
R/calculate_difference.R#L302       message(sprintf("[fpca] uq=%s samp ...
R/calculate_difference.R#L304       # assign rownames defensively; avo ...
R/calculate_difference.R#L306       message(sprintf("[fpca] created cu ...
R/calculate_difference.R#L314         if (s %in% rownames(curve_mat))  ...
R/calculate_difference.R#L317       good_rows <- which(rowSums(!is.na( ...
R/calculate_difference.R#L324       for (r in seq_len(nrow(mat_sub)))  ...
R/calculate_difference.R#L326       pca <- try(stats::prcomp(mat_sub,  ...
R/calculate_difference.R#L354       return(data.frame(gene = g, p_inte ...
R/calculate_difference.R#L360     if (!requireNamespace("parallel", qu ...
R/calculate_diversity.R#L31                                 tpm = FA ...
R/calculate_diversity.R#L66       stop("The package cannot find any  ...
R/calculate_diversity.R#L71     if (!is.numeric(assayno) || length(S ...
R/calculate_diversity.R#L72       stop("Please give a valid number t ...
R/calculate_diversity.R#L97     stop("The number of rows is not equa ...
R/calculate_diversity.R#L101   result <- calculate_method(x, genes, n ...
R/calculate_method.R#L14 calculate_method <- function(x, genes, n ...
R/calculate_method.R#L26         v <- calculate_tsallis_entropy(x ...
R/calculate_method.R#L27         if (length(v) == length(q) && al ...
R/calculate_method.R#L30     result_mat <- t(vapply(gene_levels,  ...
R/calculate_method.R#L43       message(sprintf("Note: There are % ...
R/calculate_method.R#L52         both <- calculate_tsallis_entrop ...
R/calculate_method.R#L53         if (!is.null(both$S) && length(b ...
R/calculate_method.R#L59         both <- calculate_tsallis_entrop ...
R/calculate_method.R#L60         if (!is.null(both$D) && length(b ...
R/calculate_method.R#L63     S_mat <- t(vapply(gene_levels, S_row ...
R/calculate_method.R#L64     D_mat <- t(vapply(gene_levels, D_row ...
R/difference_functions.R#L33   result <- data.frame(value, ifelse(as. ...
R/difference_functions.R#L36   ]), ifelse(as.matrix(is.na(value[, 1]) ...
R/difference_functions.R#L39   colnames(result) <- c(paste0(sorted[1, ...
R/difference_functions.R#L62     p_values[i] <- wilcox.test(x[i, as.n ...
R/difference_functions.R#L66   raw_p_values <- ifelse(is.na(vapply(p_ ...
R/difference_functions.R#L98   permuted <- replicate(randomizations,  ...
R/difference_functions.R#L99   # each element is a data.frame/matrix; ...
R/difference_functions.R#L102   # compute two-sided permutation p-valu ...
R/diversity_functions.R#L28 calculate_tsallis_entropy <- function(x, ...
R/diversity_functions.R#L35   # If all counts sum to zero, return NA ...
R/generate_plots.R#L44   # Map sample names (without '_q=...')  ...
R/generate_plots.R#L103     if (!is.null(sample_type_col) && sam ...
R/generate_plots.R#L128   # Internal small helper: prepare long- ...
R/generate_plots.R#L145     long <- tidyr::pivot_longer(df, -Gen ...
R/generate_plots.R#L323   p <- ggplot2::ggplot(df, ggplot2::aes( ...
R/generate_plots.R#L325     ggplot2::scale_color_manual(values = ...
R/generate_plots.R#L368   if (!is.matrix(readcounts)) stop("`rea ...
R/generate_plots.R#L369   if (length(genes) != nrow(readcounts)) ...
R/generate_plots.R#L587     ggplot2::geom_hline(yintercept = -lo ...
R/generate_plots.R#L588     ggplot2::geom_vline(xintercept = c(l ...
R/generate_plots.R#L597   genes_col <- if ("genes" %in% colnames ...
R/generate_plots.R#L604       p <- p + ggrepel::geom_text_repel( ...
R/generate_plots.R#L606       p <- p + ggplot2::geom_text(data = ...
R/generate_plots.R#L621 #' @param samples Character vector of sa ...
R/generate_plots.R#L630 #' @return A `ggplot` object (or invisib ...
R/generate_plots.R#L662   utils::globalVariables(c("tx", "expr", ...
R/generate_plots.R#L731     df_long <- tidyr::pivot_longer(df_al ...
R/generate_plots.R#L735     df_summary <- aggregate(expr ~ tx +  ...
R/generate_plots.R#L740     p <- ggplot2::ggplot(df_summary, ggp ...
R/generate_plots.R#L776   # Produce plots (single or multiple).  ...
R/generate_plots.R#L789       df_long <- tidyr::pivot_longer(df_ ...
R/generate_plots.R#L791       df_summary <- aggregate(expr ~ tx  ...
R/generate_plots.R#L799     plots <- lapply(gene, function(g) ma ...
R/generate_plots.R#L808       legend <- cowplot::get_legend(plot ...
R/generate_plots.R#L809       plots_nolegend <- lapply(plots, fu ...
R/generate_plots.R#L810       grid <- cowplot::plot_grid(plotlis ...
R/generate_plots.R#L811       result_plot <- cowplot::plot_grid( ...
R/generate_plots.R#L815       plots_nolegend <- lapply(plots, fu ...
R/generate_plots.R#L819       legend_idx <- which(vapply(g_full$ ...
R/generate_plots.R#L820       legend_grob <- if (length(legend_i ...
R/generate_plots.R#L844           vp_leg <- grid::viewport(layou ...
R/generate_plots.R#L873           vp_leg <- grid::viewport(layou ...
R/globals.R#L3   utils::globalVariables(c("genes", "xva ...
R/map_functions.R#L10 #' @param coldata_condition_col Name of  ...
R/map_functions.R#L11 #' @return The input `ts_se` with `colDa ...
R/map_functions.R#L19 #' coldata_df <- data.frame(Sample = sam ...
R/map_functions.R#L21 map_coldata_to_se <- function(ts_se, col ...
R/map_functions.R#L25   if (!is.data.frame(coldata) || !all(c( ...
R/map_functions.R#L28   sample_base_names <- sub("_q=.*", "",  ...
R/map_functions.R#L29   st_map <- setNames(as.character(coldat ...
R/map_functions.R#L33     sample_types[missing_idx] <- infer_s ...
R/map_functions.R#L65 #' # Basic usage: returns raw suffix tok ...
R/map_functions.R#L68 #' infer_sample_group(c("S1_N", "S2_T"), ...
R/map_functions.R#L71 #' infer_sample_group(c("TCGA-XX-01A", " ...
R/map_functions.R#L107     if (is.data.frame(coldata) && all(c( ...
R/map_functions.R#L108       map <- setNames(as.character(colda ...
R/map_functions.R#L121   if (!is.null(suffix_sep) && nzchar(suf ...
vignettes/TSENAT.Rmd#L36 Many genes express multiple isoforms who ...
vignettes/TSENAT.Rmd#L37 heavy-tailed. Standard mean-based compar ...
vignettes/TSENAT.Rmd#L38 or heterogeneity. Tsallis entropy provid ...
vignettes/TSENAT.Rmd#L39 isoforms by varying `q`, producing a "q- ...
vignettes/TSENAT.Rmd#L85 - Limit $q\to 1$: Shannon entropy, \(\li ...
vignettes/TSENAT.Rmd#L115 ## Note: `map_coldata_to_se()` is provid ...
vignettes/TSENAT.Rmd#L128 # Assign transcript IDs as rownames of ` ...
vignettes/TSENAT.Rmd#L134 coldata_df <- read.table(coldata_tsv, he ...
vignettes/TSENAT.Rmd#L224 sample sizes support asymptotic approxim ...
vignettes/TSENAT.Rmd#L237 sample_base_names <- sub("_q=.*", "", co ...
vignettes/TSENAT.Rmd#L259 - The MA plot shows the relationship bet ...
vignettes/TSENAT.Rmd#L287 sample_base_names <- sub("_q=.*", "", co ...
vignettes/TSENAT.Rmd#L314 It allows to compare values across `q` f ...
vignettes/TSENAT.Rmd#L360 With the q-sequence we can produces a q- ...
vignettes/TSENAT.Rmd#L361 emphasis shifts from rare to dominant is ...
vignettes/TSENAT.Rmd#L362 tests. The q-curve shows entropy as a fu ...
vignettes/TSENAT.Rmd#L363 indicate scale-dependent diversity diffe ...
vignettes/TSENAT.Rmd#L364 in rare isoforms; separation at high `q` ...
vignettes/TSENAT.Rmd#L419 lm_res <- calculate_lm_interaction(ts_se ...
Consider multiples of 4 spaces for line indents; 841 lines (35%) are not.
First few lines:
R/calculate_difference.R#L58                                  test =  ...
R/calculate_difference.R#L59                                  pcorr = ...
R/calculate_difference.R#L60                                  ...) { ...
R/calculate_difference.R#L61   # internal small helpers (kept here to ...
R/calculate_difference.R#L62   .tsenat_prepare_df <- function(x, samp ...
R/calculate_difference.R#L64       if (length(samples) != 1) stop("Fo ...
R/calculate_difference.R#L65       samples <- SummarizedExperiment::c ...
R/calculate_difference.R#L66       if (!is.numeric(assayno) || length ...
R/calculate_difference.R#L67       df <- as.data.frame(SummarizedExpe ...
R/calculate_difference.R#L68       genes <- rownames(df) ...
R/calculate_difference.R#L69       df <- cbind(genes = genes, df) ...
R/calculate_difference.R#L71       df <- as.data.frame(x) ...
R/calculate_difference.R#L74   } ...
R/calculate_difference.R#L76   .tsenat_sample_matrix <- function(dfr) ...
R/calculate_difference.R#L78   # Validate input container ...
R/calculate_difference.R#L79   # Reject matrices explicitly (tests ex ...
R/calculate_difference.R#L80   if (is.matrix(x)) { ...
R/calculate_difference.R#L82              to see the possible argumen ...
R/calculate_difference.R#L83   } ...
R/calculate_difference.R#L84   if (!(is.data.frame(x) || inherits(x,  ...
R/calculate_difference.R#L86              to see the possible argumen ...
R/calculate_difference.R#L87   } ...
R/calculate_difference.R#L89   # prepare data.frame and sample vector ...
R/calculate_difference.R#L90   pd <- .tsenat_prepare_df(x, samples, a ...
R/calculate_difference.R#L91   df <- pd$df ...
R/calculate_difference.R#L92   samples <- pd$samples ...
R/calculate_difference.R#L94   # Basic consistency checks ...
R/calculate_difference.R#L95   if (ncol(df) - 1 != length(samples)) s ...
R/calculate_difference.R#L96   groups <- levels(as.factor(samples)) ...
R/calculate_difference.R#L97   # capture dots early and initialize 'c ...
R/calculate_difference.R#L98   dots <- list(...) ...
R/calculate_difference.R#L99   case <- if (!is.null(dots$case)) dots$ ...
R/calculate_difference.R#L100   if (length(groups) > 2) { ...
R/calculate_difference.R#L102              different sample conditions ...
R/calculate_difference.R#L103   } ...
R/calculate_difference.R#L104   if (length(groups) < 2) stop("The numb ...
R/calculate_difference.R#L105            different sample conditions,  ...
R/calculate_difference.R#L106   if (!(control %in% samples)) stop("Thi ...
R/calculate_difference.R#L107   if (!(method %in% c("mean", "median")) ...
R/calculate_difference.R#L108            arguments and details.", call ...
R/calculate_difference.R#L109   if (!(test %in% c("wilcoxon", "shuffle ...
R/calculate_difference.R#L110            possible arguments and detail ...
R/calculate_difference.R#L111   valid_pcorr <- c("holm", "hochberg", " ...
R/calculate_difference.R#L112   if (!(pcorr %in% valid_pcorr)) stop("I ...
R/calculate_difference.R#L113            possible arguments and detail ...
R/calculate_difference.R#L115   # Informational warnings about sample  ...
R/calculate_difference.R#L116   tab <- table(samples) ...
R/calculate_difference.R#L117   if (test == "wilcoxon") { ...
R/calculate_difference.R#L119       message("Note: The 'randomizations ...
R/calculate_difference.R#L123       warning("Low sample size. Wilcoxon ...
R/calculate_difference.R#L125                           theoretical p- ...
R/calculate_difference.R#L127   } ...
R/calculate_difference.R#L128   if (test == "shuffle") { ...
R/calculate_difference.R#L130       warning("Low sample size, not enou ...
R/calculate_difference.R#L133       warning("Low sample size, label sh ...
R/calculate_difference.R#L136   } ...
R/calculate_difference.R#L138   # Count non-NA observations per gene p ...
R/calculate_difference.R#L139   idx1 <- which(samples == groups[1]) ...
R/calculate_difference.R#L140   idx2 <- which(samples == groups[2]) ...
R/calculate_difference.R#L141   df$cond_1 <- rowSums(!is.na(df[, idx1  ...
R/calculate_difference.R#L142   df$cond_2 <- rowSums(!is.na(df[, idx2  ...
R/calculate_difference.R#L144   # Partition genes by sufficient observ ...
R/calculate_difference.R#L145   if (test == "wilcoxon") { ...
R/calculate_difference.R#L147   } else { ...
R/calculate_difference.R#L149   } ...
R/calculate_difference.R#L151   df_keep <- df[keep_mask, , drop = FALS ...
R/calculate_difference.R#L152   df_small <- df[!keep_mask, , drop = FA ...
R/calculate_difference.R#L154   result_list <- list() ...
R/calculate_difference.R#L156   # Helper to extract the numeric matrix ...
R/calculate_difference.R#L157   sample_matrix <- .tsenat_sample_matrix ...
R/calculate_difference.R#L159   if (nrow(df_keep) > 0) { ...
R/calculate_difference.R#L164       ptab <- wilcoxon(ymat, samples, .. ...
R/calculate_difference.R#L165       # wilcoxon should return a data.fr ...
R/calculate_difference.R#L167       ptab <- label_shuffling(ymat, samp ...
R/calculate_difference.R#L170   } ...
R/calculate_difference.R#L172   if (nrow(df_small) > 0) { ...
R/calculate_difference.R#L175   } ...
R/calculate_difference.R#L177   # Combine results preserving tested ro ...
R/calculate_difference.R#L178   if (length(result_list) == 0) { ...
R/calculate_difference.R#L180   } ...
R/calculate_difference.R#L181   res <- do.call(rbind, result_list) ...
R/calculate_difference.R#L182   rownames(res) <- NULL ...
R/calculate_difference.R#L183   return(res) ...
R/calculate_difference.R#L217                                      met ...
R/calculate_difference.R#L218                                      ass ...
R/calculate_difference.R#L219   method <- match.arg(method) ...
R/calculate_difference.R#L220   message("[calculate_lm_interaction] me ...
R/calculate_difference.R#L221   if (!requireNamespace("SummarizedExper ...
R/calculate_difference.R#L223   mat <- SummarizedExperiment::assay(se, ...
R/calculate_difference.R#L224   if (is.null(mat)) stop(sprintf("`%s` a ...
R/calculate_difference.R#L226   sample_q <- colnames(mat) ...
R/calculate_difference.R#L227   if (is.null(sample_q) || length(sample ...
R/calculate_difference.R#L229   # parse sample names and q values from ...
R/calculate_difference.R#L230   sample_names <- sub("_q=.*", "", sampl ...
R/calculate_difference.R#L231   q_vals <- as.numeric(sub(".*_q=", "",  ...
R/calculate_difference.R#L232   if (all(is.na(q_vals))) stop("Could no ...
R/calculate_difference.R#L234   # determine group for each sample ...
R/calculate_difference.R#L235   if (!is.null(sample_type_col) && sampl ...
R/calculate_difference.R#L240   } else { ...
R/calculate_difference.R#L243   } ...
R/calculate_difference.R#L245   message("[calculate_lm_interaction] pa ...
R/calculate_difference.R#L246   all_results <- list() ...
R/calculate_difference.R#L247   fit_one <- function(g) { ...
R/calculate_difference.R#L251       return(NULL) ...
R/calculate_difference.R#L254       return(NULL) ...
R/calculate_difference.R#L258       fit <- try(stats::lm(entropy ~ q * ...
R/calculate_difference.R#L259       if (inherits(fit, "try-error")) { ...
R/calculate_difference.R#L261       } ...
R/calculate_difference.R#L262       coefs <- summary(fit)$coefficients ...
R/calculate_difference.R#L263       ia_idx <- grep("^q:group", rowname ...
R/calculate_difference.R#L264       if (length(ia_idx) == 0) { ...
R/calculate_difference.R#L266       } ...
R/calculate_difference.R#L267       p_interaction <- coefs[ia_idx[1],  ...
R/calculate_difference.R#L268       return(data.frame(gene = g, p_inte ...
R/calculate_difference.R#L272       if (!requireNamespace("mgcv", quie ...
R/calculate_difference.R#L273       # choose smoothing basis dimension ...
R/calculate_difference.R#L274       uq_len <- length(unique(na.omit(q_ ...
R/calculate_difference.R#L275       k_q <- max(2, min(10, uq_len - 1)) ...
R/calculate_difference.R#L276       fit_null <- try(mgcv::gam(entropy  ...
R/calculate_difference.R#L277       fit_alt <- try(mgcv::gam(entropy ~ ...
R/calculate_difference.R#L278       if (inherits(fit_null, "try-error" ...
R/calculate_difference.R#L280       } ...
R/calculate_difference.R#L281       an <- try(mgcv::anova.gam(fit_null ...
R/calculate_difference.R#L282       if (inherits(an, "try-error")) { ...
R/calculate_difference.R#L284       } ...
R/calculate_difference.R#L285       # anova.gam returns a table; p-val ...
R/calculate_difference.R#L286       p_interaction <- NA_real_ ...
R/calculate_difference.R#L287       if (nrow(an) >= 2) { ...
R/calculate_difference.R#L289           p_interaction <- an[2, "Pr(F)" ...
R/calculate_difference.R#L291           p_interaction <- an[2, "Pr(>F) ...
R/calculate_difference.R#L293       } ...
R/calculate_difference.R#L294       return(data.frame(gene = g, p_inte ...
R/calculate_difference.R#L298       message("[fpca] processing gene: " ...
R/calculate_difference.R#L299       # Build per-sample curves across q ...
R/calculate_difference.R#L300       uq <- sort(unique(q_vals)) ...
R/calculate_difference.R#L301       samples_u <- unique(sample_names) ...
R/calculate_difference.R#L302       message(sprintf("[fpca] uq=%s samp ...
R/calculate_difference.R#L303       curve_mat <- matrix(NA_real_, nrow ...
R/calculate_difference.R#L304       # assign rownames defensively; avo ...
R/calculate_difference.R#L305       if (length(samples_u) > 0) rowname ...
R/calculate_difference.R#L306       message(sprintf("[fpca] created cu ...
R/calculate_difference.R#L307       for (i in seq_along(sample_names)) ...
R/calculate_difference.R#L315       } ...
R/calculate_difference.R#L316       # keep samples with at least half  ...
R/calculate_difference.R#L317       good_rows <- which(rowSums(!is.na( ...
R/calculate_difference.R#L318       if (length(good_rows) < min_obs) { ...
R/calculate_difference.R#L320       } ...
R/calculate_difference.R#L321       mat_sub <- curve_mat[good_rows, ,  ...
R/calculate_difference.R#L322       # simple imputation for remaining  ...
R/calculate_difference.R#L323       col_means <- apply(mat_sub, 2, fun ...
R/calculate_difference.R#L324       for (r in seq_len(nrow(mat_sub)))  ...
R/calculate_difference.R#L325       # perform PCA across q (observatio ...
R/calculate_difference.R#L326       pca <- try(stats::prcomp(mat_sub,  ...
R/calculate_difference.R#L327       if (inherits(pca, "try-error")) { ...
R/calculate_difference.R#L329       } ...
R/calculate_difference.R#L330       if (ncol(pca$x) < 1) { ...
R/calculate_difference.R#L332       } ...
R/calculate_difference.R#L333       pc1 <- pca$x[, 1] ...
R/calculate_difference.R#L334       # map groups to the rows used ...
R/calculate_difference.R#L335       used_samples <- rownames(mat_sub) ...
R/calculate_difference.R#L336       grp_vals <- group_vec[match(used_s ...
R/calculate_difference.R#L337       # require two groups ...
R/calculate_difference.R#L338       if (length(unique(na.omit(grp_vals ...
R/calculate_difference.R#L340       } ...
R/calculate_difference.R#L341       # simple t-test between two groups ...
R/calculate_difference.R#L342       g1 <- unique(na.omit(grp_vals))[1] ...
R/calculate_difference.R#L343       g2 <- unique(na.omit(grp_vals))[2] ...
R/calculate_difference.R#L344       x1 <- pc1[grp_vals == g1] ...
R/calculate_difference.R#L345       x2 <- pc1[grp_vals == g2] ...
R/calculate_difference.R#L346       if (length(x1) < 2 || length(x2) < ...
R/calculate_difference.R#L348       } ...
R/calculate_difference.R#L349       t_res <- try(stats::t.test(x1, x2) ...
R/calculate_difference.R#L350       if (inherits(t_res, "try-error"))  ...
R/calculate_difference.R#L352       } ...
R/calculate_difference.R#L353       pval <- as.numeric(t_res$p.value) ...
R/calculate_difference.R#L354       return(data.frame(gene = g, p_inte ...
R/calculate_difference.R#L357   } ...
R/calculate_difference.R#L359   if (nthreads > 1 && .Platform$OS.type  ...
R/calculate_difference.R#L362   } else { ...
R/calculate_difference.R#L364   } ...
R/calculate_difference.R#L365   all_results <- Filter(Negate(is.null), ...
R/calculate_difference.R#L367   if (length(all_results) == 0) { ...
R/calculate_difference.R#L369   } ...
R/calculate_difference.R#L370   res <- do.call(rbind, all_results) ...
R/calculate_difference.R#L371   res$adj_p_interaction <- stats::p.adju ...
R/calculate_difference.R#L372   res <- res[order(res$p_interaction), , ...
R/calculate_difference.R#L373   rownames(res) <- NULL ...
R/calculate_difference.R#L374   return(res) ...
R/calculate_diversity.R#L32   if (!(is.matrix(x) || is.data.frame(x) ...
R/calculate_diversity.R#L36   } ...
R/calculate_diversity.R#L38   if (is(x, "data.frame")) { ...
R/calculate_diversity.R#L40   } ...
R/calculate_diversity.R#L42   if (tpm == TRUE && !is.list(x) && verb ...
R/calculate_diversity.R#L45   } ...
R/calculate_diversity.R#L47   if (is.list(x)) { ...
R/calculate_diversity.R#L49       if (tpm == FALSE) { ...
R/calculate_diversity.R#L51       } ...
R/calculate_diversity.R#L52       if (tpm == TRUE) { ...
R/calculate_diversity.R#L54       } ...
R/calculate_diversity.R#L56       x <- as.matrix(x$counts) ...
R/calculate_diversity.R#L57       if (verbose == TRUE) { ...
R/calculate_diversity.R#L60       } ...
R/calculate_diversity.R#L61       if (tpm == TRUE && verbose == TRUE ...
R/calculate_diversity.R#L63               tximport lists.") ...
R/calculate_diversity.R#L64       } ...
R/calculate_diversity.R#L66       stop("The package cannot find any  ...
R/calculate_diversity.R#L68   } ...
R/calculate_diversity.R#L70   if (is(x, "RangedSummarizedExperiment" ...
R/calculate_diversity.R#L72       stop("Please give a valid number t ...
R/calculate_diversity.R#L74       x <- as.matrix(SummarizedExperimen ...
R/calculate_diversity.R#L77       genes <- rownames(x) ...
R/calculate_diversity.R#L78       rownames(x) <- NULL ...
R/calculate_diversity.R#L79       if (is.null(genes)) { ...
R/calculate_diversity.R#L81           call. = FALSE ...
R/calculate_diversity.R#L83       } ...
R/calculate_diversity.R#L85   } ...
R/calculate_diversity.R#L87   if (!is.numeric(x)) { ...
R/calculate_diversity.R#L89   } ...
R/calculate_diversity.R#L91   if (any(is.na(x))) { ...
R/calculate_diversity.R#L93          input.", call. = FALSE) ...
R/calculate_diversity.R#L94   } ...
R/calculate_diversity.R#L96   if (nrow(x) != length(genes)) { ...
R/calculate_diversity.R#L98   } ...
R/calculate_diversity.R#L100   what <- match.arg(what) ...
R/calculate_diversity.R#L101   result <- calculate_method(x, genes, n ...
R/calculate_diversity.R#L103   # Prepare assay and row/col data ...
R/calculate_diversity.R#L104   result_assay <- result[, -1, drop = FA ...
R/calculate_diversity.R#L105   result_rowData <- data.frame(genes = r ...
R/calculate_diversity.R#L107   if (length(q) > 1) { ...
R/calculate_diversity.R#L112       samples = as.character(col_split[, ...
R/calculate_diversity.R#L113       q = as.numeric(col_split[, 2]), ...
R/calculate_diversity.R#L114       row.names = col_ids, ...
R/calculate_diversity.R#L115       stringsAsFactors = FALSE ...
R/calculate_diversity.R#L119   } else { ...
R/calculate_diversity.R#L125   } ...
R/calculate_diversity.R#L127   result_metadata <- list(method = "tsal ...
R/calculate_diversity.R#L129   assays_list <- list() ...
R/calculate_diversity.R#L130   if (what == "S") { ...
R/calculate_diversity.R#L132   } else if (what == "D") { ...
R/calculate_diversity.R#L134   } ...
R/calculate_diversity.R#L136   result <- SummarizedExperiment::Summar ...
R/calculate_diversity.R#L141   ) ...
R/calculate_diversity.R#L143   return(result) ...
R/calculate_method.R#L15   what <- match.arg(what) ...
R/calculate_method.R#L16   # cannot use aggregate because calcula ...
R/calculate_method.R#L17   # multiple values when length(q) > 1 ...
R/calculate_method.R#L18   gene_levels <- unique(genes) ...
R/calculate_method.R#L19   coln <- as.vector(outer(colnames(x), q ...
R/calculate_method.R#L20   rown <- gene_levels ...
R/calculate_method.R#L22   if (what != "both") { ...
R/calculate_method.R#L24       idx <- which(genes == gene) ...
R/calculate_method.R#L25       unlist(lapply(seq_len(ncol(x)), fu ...
R/calculate_method.R#L28       })) ...
R/calculate_method.R#L35       out_df <- data.frame(Gene = charac ...
R/calculate_method.R#L36       for (nm in coln) out_df[[nm]] <- n ...
R/calculate_method.R#L37       x <- out_df ...
R/calculate_method.R#L38       return(x) ...
R/calculate_method.R#L43       message(sprintf("Note: There are % ...
R/calculate_method.R#L47   } else { ...
R/calculate_method.R#L50       idx <- which(genes == gene) ...
R/calculate_method.R#L51       unlist(lapply(seq_len(ncol(x)), fu ...
R/calculate_method.R#L54       })) ...
R/calculate_method.R#L57       idx <- which(genes == gene) ...
R/calculate_method.R#L58       unlist(lapply(seq_len(ncol(x)), fu ...
R/calculate_method.R#L61       })) ...
R/calculate_method.R#L74   } ...
R/difference_functions.R#L19   if (method == "mean") { ...
R/difference_functions.R#L21   } ...
R/difference_functions.R#L23   if (method == "median") { ...
R/difference_functions.R#L25   } ...
R/difference_functions.R#L27   sorted <- value[value$Group.1 != contr ...
R/difference_functions.R#L28   sorted[2, ] <- value[value$Group.1 ==  ...
R/difference_functions.R#L29   value <- t(sorted[, -1]) ...
R/difference_functions.R#L30   value[is.na(value[, 1]), c(1)] <- NA ...
R/difference_functions.R#L31   value[is.na(value[, 2]), c(2)] <- NA ...
R/difference_functions.R#L33   result <- data.frame(value, ifelse(as. ...
R/difference_functions.R#L36   ]), ifelse(as.matrix(is.na(value[, 1]) ...
R/difference_functions.R#L38   )))) ...
R/difference_functions.R#L39   colnames(result) <- c(paste0(sorted[1, ...
R/difference_functions.R#L42   ), "log2_fold_change") ...
R/difference_functions.R#L43   return(result) ...
R/difference_functions.R#L59   p_values <- vector("list", nrow(x)) ...
R/difference_functions.R#L61   for (i in seq_len(nrow(x))) { ...
R/difference_functions.R#L63       unique(sort(samples))[2]))], paire ...
R/difference_functions.R#L64   } ...
R/difference_functions.R#L66   raw_p_values <- ifelse(is.na(vapply(p_ ...
R/difference_functions.R#L67   adjusted_p_values <- p.adjust(raw_p_va ...
R/difference_functions.R#L68   return(cbind(raw_p_values, adjusted_p_ ...
R/difference_functions.R#L94   # observed log2 fold changes ...
R/difference_functions.R#L95   log2_fc <- calculate_fc(x, samples, co ...
R/difference_functions.R#L97   # build permutation/null distribution  ...
R/difference_functions.R#L98   permuted <- replicate(randomizations,  ...
R/difference_functions.R#L99   # each element is a data.frame/matrix; ...
R/difference_functions.R#L100   perm_mat <- vapply(permuted, function( ...
R/difference_functions.R#L102   # compute two-sided permutation p-valu ...
R/difference_functions.R#L103   raw_p_values <- vapply(seq_len(nrow(pe ...
R/difference_functions.R#L107       return(1) ...
R/difference_functions.R#L112       return(1) ...
R/difference_functions.R#L116       return(1) ...
R/difference_functions.R#L121   }, numeric(1)) ...
R/difference_functions.R#L123   adjusted_p_values <- p.adjust(raw_p_va ...
R/difference_functions.R#L124   return(cbind(raw_p_values, adjusted_p_ ...
R/diversity_functions.R#L29   what <- match.arg(what) ...
R/diversity_functions.R#L30   if (!is.numeric(q)) stop("q must be nu ...
R/diversity_functions.R#L31   if (any(q <= 0)) stop("q must be great ...
R/diversity_functions.R#L32   if (!is.numeric(x)) stop("x must be nu ...
R/diversity_functions.R#L34   n <- length(x) ...
R/diversity_functions.R#L35   # If all counts sum to zero, return NA ...
R/diversity_functions.R#L36   if (sum(x, na.rm = TRUE) <= 0) { ...
R/diversity_functions.R#L38       return(list(S = rep(NA_real_, leng ...
R/diversity_functions.R#L41   } ...
R/diversity_functions.R#L43   p <- x / sum(x) ...
R/diversity_functions.R#L45   tol <- sqrt(.Machine$double.eps) ...
R/diversity_functions.R#L46   S_vec <- vapply(q, function(qi) { ...
R/diversity_functions.R#L48       sh <- -sum(ifelse(p > 0, p * log(p ...
R/diversity_functions.R#L49       if (norm) sh <- sh / log(n, base = ...
R/diversity_functions.R#L50       return(sh) ...
R/diversity_functions.R#L52       ts <- (1 - sum(p^qi)) / (qi - 1) ...
R/diversity_functions.R#L53       if (norm) { ...
R/diversity_functions.R#L56       } ...
R/diversity_functions.R#L57       return(ts) ...
R/diversity_functions.R#L59   }, numeric(1)) ...
R/diversity_functions.R#L61   D_vec <- vapply(q, function(qi) { ...
R/diversity_functions.R#L63       sh <- -sum(ifelse(p > 0, p * log(p ...
R/diversity_functions.R#L64       D1 <- (log_base)^(sh) ...
R/diversity_functions.R#L65       return(D1) ...
R/diversity_functions.R#L67       spq <- sum(p^qi) ...
R/diversity_functions.R#L68       Dq <- spq^(1 / (1 - qi)) ...
R/diversity_functions.R#L69       return(Dq) ...
R/diversity_functions.R#L71   }, numeric(1)) ...
R/diversity_functions.R#L73   if (what == "S") { ...
R/diversity_functions.R#L77       return(unname(out)) ...
R/diversity_functions.R#L80   } ...
R/diversity_functions.R#L81   if (what == "D") { ...
R/diversity_functions.R#L85       return(unname(out)) ...
R/diversity_functions.R#L88   } ...
R/diversity_functions.R#L89   # both ...
R/diversity_functions.R#L90   names(S_vec) <- paste0("q=", q) ...
R/diversity_functions.R#L91   names(D_vec) <- paste0("q=", q) ...
R/diversity_functions.R#L92   return(list(S = S_vec, D = D_vec)) ...
R/generate_plots.R#L6   utils::globalVariables( ...
R/generate_plots.R#L8       "Gene", ...
R/generate_plots.R#L9       "diversity", ...
R/generate_plots.R#L10       "sample", ...
R/generate_plots.R#L11       "sample_q", ...
R/generate_plots.R#L12       "sample_type", ...
R/generate_plots.R#L13       "fold", ...
R/generate_plots.R#L14       "significant", ...
R/generate_plots.R#L15       "value", ...
R/generate_plots.R#L16       ".", ...
R/generate_plots.R#L17       "group", ...
R/generate_plots.R#L18       "tsallis", ...
R/generate_plots.R#L19       "q", ...
R/generate_plots.R#L20       "median", ...
R/generate_plots.R#L21       "IQR", ...
R/generate_plots.R#L22       "padj_num", ...
R/generate_plots.R#L23       "padj_clean", ...
R/generate_plots.R#L24       "xval", ...
R/generate_plots.R#L25       "label_flag", ...
R/generate_plots.R#L26       "genes", ...
R/generate_plots.R#L27       "mean" ...
R/generate_plots.R#L29   ) ...
R/generate_plots.R#L31   require_pkgs <- function(pkgs) { ...
R/generate_plots.R#L34       stop( ...
R/generate_plots.R#L36           "%s required", ...
R/generate_plots.R#L37           paste(missing, collapse = ", " ...
R/generate_plots.R#L39       ) ...
R/generate_plots.R#L42   } ...
R/generate_plots.R#L44   # Map sample names (without '_q=...')  ...
R/generate_plots.R#L45   # otherwise fall back to `infer_sample ...
R/generate_plots.R#L46   map_samples_to_group <- function( ...
R/generate_plots.R#L51   ) { ...
R/generate_plots.R#L53       sample_type_col %in% colnames(Summ ...
R/generate_plots.R#L54       st_vec <- as.character( ...
R/generate_plots.R#L56       ) ...
R/generate_plots.R#L57       base_names <- sub( ...
R/generate_plots.R#L61       ) ...
R/generate_plots.R#L62       names(st_vec) <- base_names ...
R/generate_plots.R#L63       st_map <- st_vec[!duplicated(names ...
R/generate_plots.R#L64       return(unname(st_map[sample_names] ...
R/generate_plots.R#L69       res[missing_idx] <- vapply( ...
R/generate_plots.R#L73       ) ...
R/generate_plots.R#L76   } ...
R/generate_plots.R#L78   # Prepare a long-format data.frame for ...
R/generate_plots.R#L79   get_assay_long <- function( ...
R/generate_plots.R#L84   ) { ...
R/generate_plots.R#L90       SummarizedExperiment::rowData(se)$ ...
R/generate_plots.R#L92       rownames(df) ...
R/generate_plots.R#L96       df, ...
R/generate_plots.R#L97       -Gene, ...
R/generate_plots.R#L98       names_to = "sample", ...
R/generate_plots.R#L99       values_to = value_name ...
R/generate_plots.R#L104       st <- as.character(SummarizedExper ...
R/generate_plots.R#L105       names(st) <- colnames(mat) ...
R/generate_plots.R#L106       long$sample_type <- unname(st[long ...
R/generate_plots.R#L108       sample_base <- sub("_q=.*", "", lo ...
R/generate_plots.R#L109       long$sample_type <- map_samples_to ...
R/generate_plots.R#L114       ) ...
R/generate_plots.R#L115       missing_idx <- which(is.na(long$sa ...
R/generate_plots.R#L116       if (length(missing_idx) > 0) { ...
R/generate_plots.R#L118           sample_base[missing_idx], ...
R/generate_plots.R#L119           function(s) if (grepl("_", s)) ...
R/generate_plots.R#L120           character(1) ...
R/generate_plots.R#L122       } ...
R/generate_plots.R#L126   } ...
R/generate_plots.R#L128   # Internal small helper: prepare long- ...
R/generate_plots.R#L129   prepare_tsallis_long <- function( ...
R/generate_plots.R#L133   ) { ...
R/generate_plots.R#L139       SummarizedExperiment::rowData(se)$ ...
R/generate_plots.R#L141       rownames(df) ...
R/generate_plots.R#L147       long <- tidyr::separate( ...
R/generate_plots.R#L152       ) ...
R/generate_plots.R#L153       long$q <- as.factor(as.numeric(lon ...
R/generate_plots.R#L155       long$sample <- long$sample_q ...
R/generate_plots.R#L156       long$q <- NA ...
R/generate_plots.R#L160       sample_type_col %in% colnames(Summ ...
R/generate_plots.R#L161       st_vec <- as.character( ...
R/generate_plots.R#L163       ) ...
R/generate_plots.R#L164       names(st_vec) <- sub("_q=.*", "",  ...
R/generate_plots.R#L165       st_map <- st_vec[!duplicated(names ...
R/generate_plots.R#L166       long$group <- unname(st_map[as.cha ...
R/generate_plots.R#L168       sample_base <- as.character(long$s ...
R/generate_plots.R#L169       long$group <- infer_sample_group(s ...
R/generate_plots.R#L170       missing_idx <- which(is.na(long$gr ...
R/generate_plots.R#L171       if (length(missing_idx) > 0) { ...
R/generate_plots.R#L173           sample_base[missing_idx], ...
R/generate_plots.R#L174           function(s) if (grepl("_", s)) ...
R/generate_plots.R#L175           character(1) ...
R/generate_plots.R#L177       } ...
R/generate_plots.R#L181   } ...
R/generate_plots.R#L201   se, ...
R/generate_plots.R#L202   assay_name = "diversity", ...
R/generate_plots.R#L203   sample_type_col = NULL ...
R/generate_plots.R#L205   require_pkgs(c("ggplot2", "tidyr", "dp ...
R/generate_plots.R#L206   long <- get_assay_long( ...
R/generate_plots.R#L211   ) ...
R/generate_plots.R#L213   ggplot2::ggplot( ...
R/generate_plots.R#L216   ) + ...
R/generate_plots.R#L241   se, ...
R/generate_plots.R#L242   assay_name = "diversity", ...
R/generate_plots.R#L243   sample_type_col = NULL ...
R/generate_plots.R#L245   require_pkgs(c("ggplot2", "dplyr", "Su ...
R/generate_plots.R#L246   long <- get_assay_long( ...
R/generate_plots.R#L251   ) ...
R/generate_plots.R#L253   tmp <- as.data.frame(long) ...
R/generate_plots.R#L254   plot_df <- stats::aggregate( ...
R/generate_plots.R#L258   ) ...
R/generate_plots.R#L259   colnames(plot_df)[colnames(plot_df) == ...
R/generate_plots.R#L261   ggplot2::ggplot( ...
R/generate_plots.R#L264   ) + ...
R/generate_plots.R#L295   diff_df, ...
R/generate_plots.R#L296   mean_cols = NULL, ...
R/generate_plots.R#L297   fold_col = "log2_fold_change", ...
R/generate_plots.R#L298   padj_col = "adjusted_p_values", ...
R/generate_plots.R#L299   sig_alpha = 0.05 ...
R/generate_plots.R#L301   if (!requireNamespace("ggplot2", quiet ...
R/generate_plots.R#L303   if (is.null(mean_cols)) { ...
R/generate_plots.R#L307   } ...
R/generate_plots.R#L309   df <- diff_df ...
R/generate_plots.R#L310   df$mean <- apply( ...
R/generate_plots.R#L314   ) ...
R/generate_plots.R#L315   df$padj <- if (padj_col %in% colnames( ...
R/generate_plots.R#L316   df$fold <- if (fold_col %in% colnames( ...
R/generate_plots.R#L317   df$significant <- ifelse( ...
R/generate_plots.R#L321   ) ...
R/generate_plots.R#L323   p <- ggplot2::ggplot(df, ggplot2::aes( ...
R/generate_plots.R#L329   return(p) ...
R/generate_plots.R#L357   readcounts, ...
R/generate_plots.R#L358   genes, ...
R/generate_plots.R#L359   q_values = seq(0.01, 2, by = 0.01), ...
R/generate_plots.R#L360   group_pattern = "_N$", ...
R/generate_plots.R#L361   group_names = c("Normal", "Tumor") ...
R/generate_plots.R#L363   if (!requireNamespace("ggplot2", quiet ...
R/generate_plots.R#L364   if (!requireNamespace("tidyr", quietly ...
R/generate_plots.R#L365   if (!requireNamespace("dplyr", quietly ...
R/generate_plots.R#L367   if (is.data.frame(readcounts)) readcou ...
R/generate_plots.R#L368   if (!is.matrix(readcounts)) stop("`rea ...
R/generate_plots.R#L369   if (length(genes) != nrow(readcounts)) ...
R/generate_plots.R#L371   get_group_stats_iqr <- function(q) { ...
R/generate_plots.R#L374       tapply( ...
R/generate_plots.R#L380       ) ...
R/generate_plots.R#L387       tsallis_df, ...
R/generate_plots.R#L388       -Gene, ...
R/generate_plots.R#L389       names_to = "sample", ...
R/generate_plots.R#L390       values_to = "tsallis" ...
R/generate_plots.R#L393       grepl(group_pattern, long$sample), ...
R/generate_plots.R#L394       group_names[1], ...
R/generate_plots.R#L395       group_names[2] ...
R/generate_plots.R#L399       median = median(tsallis, na.rm = T ...
R/generate_plots.R#L400       IQR = stats::IQR(tsallis, na.rm =  ...
R/generate_plots.R#L404   } ...
R/generate_plots.R#L406   stats_df <- do.call(rbind, lapply(q_va ...
R/generate_plots.R#L408   p <- ggplot2::ggplot( ...
R/generate_plots.R#L411   ) + ...
R/generate_plots.R#L414       ggplot2::aes(ymin = median - IQR / ...
R/generate_plots.R#L415       alpha = 0.2, ...
R/generate_plots.R#L416       color = NA ...
R/generate_plots.R#L421       title = "Median +- IQR of Tsallis  ...
R/generate_plots.R#L422       x = "q value", ...
R/generate_plots.R#L423       y = "Tsallis entropy", ...
R/generate_plots.R#L424       color = "Group", ...
R/generate_plots.R#L425       fill = "Group" ...
R/generate_plots.R#L428   return(p) ...
R/generate_plots.R#L446   if (!requireNamespace("ggplot2", quiet ...
R/generate_plots.R#L447   if (!requireNamespace("tidyr", quietly ...
R/generate_plots.R#L448   if (!requireNamespace("dplyr", quietly ...
R/generate_plots.R#L450   long <- prepare_tsallis_long(se, assay ...
R/generate_plots.R#L452   p <- ggplot2::ggplot( ...
R/generate_plots.R#L455   ) + ...
R/generate_plots.R#L457       alpha = 0.5, ...
R/generate_plots.R#L458       width = 0.9, ...
R/generate_plots.R#L459       position = ggplot2::position_dodge ...
R/generate_plots.R#L462       width = 0.15, ...
R/generate_plots.R#L463       position = ggplot2::position_dodge ...
R/generate_plots.R#L464       outlier.shape = NA ...
R/generate_plots.R#L468       title = "Tsallis entropy by q and  ...
R/generate_plots.R#L469       x = "q value", ...
R/generate_plots.R#L470       y = "Tsallis entropy", ...
R/generate_plots.R#L471       fill = "Group" ...
R/generate_plots.R#L474   return(p) ...
R/generate_plots.R#L492   if (!requireNamespace("ggplot2", quiet ...
R/generate_plots.R#L493   if (!requireNamespace("tidyr", quietly ...
R/generate_plots.R#L494   if (!requireNamespace("dplyr", quietly ...
R/generate_plots.R#L496   long <- prepare_tsallis_long(se, assay ...
R/generate_plots.R#L498   p <- ggplot2::ggplot( ...
R/generate_plots.R#L501   ) + ...
R/generate_plots.R#L506       title = "Tsallis entropy distribut ...
R/generate_plots.R#L507       x = "Tsallis entropy", ...
R/generate_plots.R#L508       y = "Density", ...
R/generate_plots.R#L509       color = "Group", ...
R/generate_plots.R#L510       fill = "Group" ...
R/generate_plots.R#L513   return(p) ...
R/generate_plots.R#L539   diff_df, ...
R/generate_plots.R#L540   x_col = "mean_difference", ...
R/generate_plots.R#L541   padj_col = "adjusted_p_values", ...
R/generate_plots.R#L542   label_thresh = 0.1, ...
R/generate_plots.R#L543   padj_thresh = 0.05, ...
R/generate_plots.R#L544   top_n = 5 ...
R/generate_plots.R#L546   if (!requireNamespace("ggplot2", quiet ...
R/generate_plots.R#L547   df <- as.data.frame(diff_df) ...
R/generate_plots.R#L548   if (!(x_col %in% colnames(df)) || !(pa ...
R/generate_plots.R#L550       "Required columns not found in dif ...
R/generate_plots.R#L552   } ...
R/generate_plots.R#L554   df$padj_num <- as.numeric(df[[padj_col ...
R/generate_plots.R#L555   df$xval <- as.numeric(df[[x_col]]) ...
R/generate_plots.R#L557   # sanitize padj: NA -> 1, zeros -> tin ...
R/generate_plots.R#L558   padj_clean <- df$padj_num ...
R/generate_plots.R#L559   padj_clean[is.na(padj_clean)] <- 1 ...
R/generate_plots.R#L560   padj_clean[padj_clean <= 0] <- .Machin ...
R/generate_plots.R#L561   df$padj_clean <- padj_clean ...
R/generate_plots.R#L563   # prefer user-supplied `label` column; ...
R/generate_plots.R#L564   if ("label" %in% colnames(df)) { ...
R/generate_plots.R#L566   } else { ...
R/generate_plots.R#L568       abs(df$xval) >= label_thresh & df$ ...
R/generate_plots.R#L569       "significant", ...
R/generate_plots.R#L570       "non-significant" ...
R/generate_plots.R#L572   } ...
R/generate_plots.R#L574   # drop rows with non-finite x or y val ...
R/generate_plots.R#L575   finite_idx <- is.finite(df$xval) & is. ...
R/generate_plots.R#L576   df_plot <- df[finite_idx, , drop = FAL ...
R/generate_plots.R#L578   p <- ggplot2::ggplot( ...
R/generate_plots.R#L581   ) + ...
R/generate_plots.R#L584       values = c("non-significant" = "gr ...
R/generate_plots.R#L585       guide = "none" ...
R/generate_plots.R#L591       title = "Volcano: mean difference  ...
R/generate_plots.R#L592       x = x_col, ...
R/generate_plots.R#L593       y = sprintf("-Log10(%s)", padj_col ...
R/generate_plots.R#L596   # annotate top N genes by smallest pad ...
R/generate_plots.R#L597   genes_col <- if ("genes" %in% colnames ...
R/generate_plots.R#L598   if (!is.null(genes_col) && top_n > 0)  ...
R/generate_plots.R#L604       p <- p + ggrepel::geom_text_repel( ...
R/generate_plots.R#L606       p <- p + ggplot2::geom_text(data = ...
R/generate_plots.R#L608   } ...
R/generate_plots.R#L610   return(p) ...
R/generate_plots.R#L662   utils::globalVariables(c("tx", "expr", ...
R/generate_plots.R#L665   counts, ...
R/generate_plots.R#L666   gene, ...
R/generate_plots.R#L667   samples, ...
R/generate_plots.R#L668   tx2gene = NULL, ...
R/generate_plots.R#L669   top_n = 3, ...
R/generate_plots.R#L670   pseudocount = 1e-6, ...
R/generate_plots.R#L671   output_file = NULL ...
R/generate_plots.R#L673   if (!is.matrix(counts) && !is.data.fra ...
R/generate_plots.R#L675       "`counts` must be a matrix or data ...
R/generate_plots.R#L677   } ...
R/generate_plots.R#L678   counts <- as.matrix(counts) ...
R/generate_plots.R#L679   if (is.null(rownames(counts))) { ...
R/generate_plots.R#L681       "`counts` must have rownames corre ...
R/generate_plots.R#L683   } ...
R/generate_plots.R#L684   if (length(samples) != ncol(counts)) { ...
R/generate_plots.R#L686       "Length of `samples` must equal nu ...
R/generate_plots.R#L688   } ...
R/generate_plots.R#L690   # tx2gene must be supplied as a path o ...
R/generate_plots.R#L691   if (is.character(tx2gene) && length(tx ...
R/generate_plots.R#L694       tx2gene, ...
R/generate_plots.R#L695       stringsAsFactors = FALSE, ...
R/generate_plots.R#L696       header = TRUE ...
R/generate_plots.R#L698   } else if (is.data.frame(tx2gene)) { ...
R/generate_plots.R#L700   } else { ...
R/generate_plots.R#L702   } ...
R/generate_plots.R#L704   if (!all(c("Transcript", "Gen") %in% c ...
R/generate_plots.R#L706       "tx2gene must have columns 'Transc ...
R/generate_plots.R#L708   } ...
R/generate_plots.R#L710   if (!requireNamespace("ggplot2", quiet ...
R/generate_plots.R#L712       "ggplot2 required for plotting" ...
R/generate_plots.R#L714   } ...
R/generate_plots.R#L716   if (length(samples) != ncol(counts)) { ...
R/generate_plots.R#L718       "Length of `samples` must equal nu ...
R/generate_plots.R#L720   } ...
R/generate_plots.R#L722   make_plot_for_gene <- function(gene_si ...
R/generate_plots.R#L741       ggplot2::geom_tile(color = "white" ...
R/generate_plots.R#L742       ggplot2::scale_fill_viridis_c( ...
R/generate_plots.R#L747       ) + ...
R/generate_plots.R#L748       ggplot2::theme_minimal(base_size = ...
R/generate_plots.R#L749       ggplot2::labs( ...
R/generate_plots.R#L754       ) + ...
R/generate_plots.R#L755       ggplot2::theme( ...
R/generate_plots.R#L764       ) + ...
R/generate_plots.R#L765       ggplot2::guides( ...
R/generate_plots.R#L767           title.position = "top", ...
R/generate_plots.R#L768           barwidth = 6, ...
R/generate_plots.R#L769           barheight = 0.35 ...
R/generate_plots.R#L771       ) ...
R/generate_plots.R#L774   } ...
R/generate_plots.R#L776   # Produce plots (single or multiple).  ...
R/generate_plots.R#L777   if (length(gene) > 1) { ...
R/generate_plots.R#L782       txs <- mapping$Transcript[mapping$ ...
R/generate_plots.R#L783       txs <- intersect(txs, rownames(cou ...
R/generate_plots.R#L784       if (length(txs) == 0) next ...
R/generate_plots.R#L785       if (!is.null(top_n)) txs <- head(t ...
R/generate_plots.R#L786       mat <- counts[txs, , drop = FALSE] ...
R/generate_plots.R#L787       df_all <- as.data.frame(mat) ...
R/generate_plots.R#L788       df_all$tx <- rownames(mat) ...
R/generate_plots.R#L789       df_long <- tidyr::pivot_longer(df_ ...
R/generate_plots.R#L790       df_long$group <- rep(samples, time ...
R/generate_plots.R#L791       df_summary <- aggregate(expr ~ tx  ...
R/generate_plots.R#L792       df_summary$log2expr <- log2(df_sum ...
R/generate_plots.R#L793       mins <- c(mins, min(df_summary$log ...
R/generate_plots.R#L794       maxs <- c(maxs, max(df_summary$log ...
R/generate_plots.R#L802       combined <- Reduce(`+`, plots) + ...
R/generate_plots.R#L805       result_plot <- combined ...
R/generate_plots.R#L807       # extract legend from first plot ...
R/generate_plots.R#L808       legend <- cowplot::get_legend(plot ...
R/generate_plots.R#L809       plots_nolegend <- lapply(plots, fu ...
R/generate_plots.R#L810       grid <- cowplot::plot_grid(plotlis ...
R/generate_plots.R#L811       result_plot <- cowplot::plot_grid( ...
R/generate_plots.R#L813       # fallback: arrange grobs horizont ...
R/generate_plots.R#L814       # remove legends from individual p ...
R/generate_plots.R#L815       plots_nolegend <- lapply(plots, fu ...
R/generate_plots.R#L816       grobs <- lapply(plots_nolegend, gg ...
R/generate_plots.R#L817       # extract legend from original fir ...
R/generate_plots.R#L818       g_full <- ggplot2::ggplotGrob(plot ...
R/generate_plots.R#L819       legend_idx <- which(vapply(g_full$ ...
R/generate_plots.R#L820       legend_grob <- if (length(legend_i ...
R/generate_plots.R#L821       n <- length(grobs) ...
R/generate_plots.R#L822       # layout: plots in row 1, legend s ...
R/generate_plots.R#L823       if (!is.null(output_file)) { ...
R/generate_plots.R#L827           grid::viewport( ...
R/generate_plots.R#L829               2, n, ...
R/generate_plots.R#L830               heights = grid::unit.c( ...
R/generate_plots.R#L833               ) ...
R/generate_plots.R#L835           ) ...
R/generate_plots.R#L838           vp <- grid::viewport(layout.po ...
R/generate_plots.R#L839           grid::pushViewport(vp) ...
R/generate_plots.R#L840           grid::grid.draw(grobs[[i]]) ...
R/generate_plots.R#L841           grid::upViewport() ...
R/generate_plots.R#L844           vp_leg <- grid::viewport(layou ...
R/generate_plots.R#L845           grid::pushViewport(vp_leg) ...
R/generate_plots.R#L846           grid::grid.draw(legend_grob) ...
R/generate_plots.R#L847           grid::upViewport() ...
R/generate_plots.R#L853       } else { ...
R/generate_plots.R#L856           grid::viewport( ...
R/generate_plots.R#L858               2, n, ...
R/generate_plots.R#L859               heights = grid::unit.c( ...
R/generate_plots.R#L862               ) ...
R/generate_plots.R#L864           ) ...
R/generate_plots.R#L867           vp <- grid::viewport(layout.po ...
R/generate_plots.R#L868           grid::pushViewport(vp) ...
R/generate_plots.R#L869           grid::grid.draw(grobs[[i]]) ...
R/generate_plots.R#L870           grid::upViewport() ...
R/generate_plots.R#L873           vp_leg <- grid::viewport(layou ...
R/generate_plots.R#L874           grid::pushViewport(vp_leg) ...
R/generate_plots.R#L875           grid::grid.draw(legend_grob) ...
R/generate_plots.R#L876           grid::upViewport() ...
R/generate_plots.R#L881       } ...
R/generate_plots.R#L883   } else { ...
R/generate_plots.R#L885   } ...
R/generate_plots.R#L887   if (!is.null(output_file)) { ...
R/generate_plots.R#L890   } else { ...
R/generate_plots.R#L892   } ...
R/globals.R#L3   utils::globalVariables(c("genes", "xva ...
R/map_functions.R#L22   if (is.null(coldata)) { ...
R/map_functions.R#L24   } ...
R/map_functions.R#L25   if (!is.data.frame(coldata) || !all(c( ...
R/map_functions.R#L27   } ...
R/map_functions.R#L28   sample_base_names <- sub("_q=.*", "",  ...
R/map_functions.R#L29   st_map <- setNames(as.character(coldat ...
R/map_functions.R#L30   sample_types <- unname(st_map[sample_b ...
R/map_functions.R#L31   missing_idx <- which(is.na(sample_type ...
R/map_functions.R#L32   if (length(missing_idx) > 0) { ...
R/map_functions.R#L34   } ...
R/map_functions.R#L35   SummarizedExperiment::colData(ts_se)$s ...
R/map_functions.R#L36   return(ts_se) ...
R/map_functions.R#L74                                suffix_se ...
R/map_functions.R#L75                                suffix_ma ...
R/map_functions.R#L76                                tcga_map  ...
R/map_functions.R#L77                                coldata = ...
R/map_functions.R#L78                                coldata_s ...
R/map_functions.R#L79                                coldata_c ...
R/map_functions.R#L80                                prefer_su ...
R/map_functions.R#L81                                default = ...
R/map_functions.R#L82   if (is.null(sample_names)) { ...
R/map_functions.R#L84   } ...
R/map_functions.R#L85   n <- length(sample_names) ...
R/map_functions.R#L86   res <- rep(default, n) ...
R/map_functions.R#L88   # Helper to map tokens using a named m ...
R/map_functions.R#L89   map_token <- function(token, map) { ...
R/map_functions.R#L91       return(NA_character_) ...
R/map_functions.R#L94       return(NA_character_) ...
R/map_functions.R#L100       return(unname(map[ix])) ...
R/map_functions.R#L103   } ...
R/map_functions.R#L105   # If coldata mapping is supplied and i ...
R/map_functions.R#L106   if (!is.null(coldata)) { ...
R/map_functions.R#L108       map <- setNames(as.character(colda ...
R/map_functions.R#L109       mapped <- unname(map[sample_names] ...
R/map_functions.R#L110       # For entries that map successfull ...
R/map_functions.R#L111       ok <- !is.na(mapped) & mapped != " ...
R/map_functions.R#L112       if (any(ok)) res[ok] <- mapped[ok] ...
R/map_functions.R#L114       mapped <- unname(coldata[sample_na ...
R/map_functions.R#L115       ok <- !is.na(mapped) & mapped != " ...
R/map_functions.R#L116       if (any(ok)) res[ok] <- mapped[ok] ...
R/map_functions.R#L118   } ...
R/map_functions.R#L120   # Suffix-based detection ...
R/map_functions.R#L121   if (!is.null(suffix_sep) && nzchar(suf ...
R/map_functions.R#L123       if (grepl(suffix_sep, s, fixed = T ...
R/map_functions.R#L127           return(mapped) ...
R/map_functions.R#L131       } ...
R/map_functions.R#L132       NA_character_ ...
R/map_functions.R#L135       res[!is.na(groups)] <- groups[!is. ...
R/map_functions.R#L137       # Only fill res where not already  ...
R/map_functions.R#L138       to_fill <- which(is.na(res) & !is. ...
R/map_functions.R#L139       res[to_fill] <- groups[to_fill] ...
R/map_functions.R#L141   } ...
R/map_functions.R#L143   # TCGA barcode detection: extract two- ...
R/map_functions.R#L144   has_tcga <- grepl("^TCGA-", sample_nam ...
R/map_functions.R#L145   if (any(has_tcga)) { ...
R/map_functions.R#L150       if (is.na(c)) { ...
R/map_functions.R#L152       } ...
R/map_functions.R#L153       mapped <- map_token(c, tcga_map) ...
R/map_functions.R#L154       if (!is.na(mapped)) { ...
R/map_functions.R#L156       } ...
R/map_functions.R#L157       # if no mapping, return raw TCGA c ...
R/map_functions.R#L158       return(c) ...
R/map_functions.R#L162       to_fill <- which(is.na(res) | (!is ...
R/map_functions.R#L164       to_fill <- which(is.na(res) | (!is ...
R/map_functions.R#L167   } ...
R/map_functions.R#L169   # Ensure length and replace any remain ...
R/map_functions.R#L170   res[is.na(res)] <- default ...
R/map_functions.R#L171   return(unname(res)) ...
vignettes/TSENAT.Rmd#L18   collapse = TRUE, ...
vignettes/TSENAT.Rmd#L19   comment = "#>", ...
vignettes/TSENAT.Rmd#L20   fig.width = 10, ...
vignettes/TSENAT.Rmd#L21   fig.height = 6 ...
vignettes/TSENAT.Rmd#L46    Tsallis entropy across one or more `q ...
vignettes/TSENAT.Rmd#L48    differences between groups (Wilcoxon  ...
vignettes/TSENAT.Rmd#L71   dominant isoforms. Use small `q` (\(<1 ...
vignettes/TSENAT.Rmd#L72   heterogeneity and larger `q` (\(>1\))  ...
vignettes/TSENAT.Rmd#L73   behaviour; plotting `S_q` across a com ...
vignettes/TSENAT.Rmd#L74   reveals scale-dependent differences be ...
vignettes/TSENAT.Rmd#L76   (Shannon at `q=1`, richness-like at `q ...
vignettes/TSENAT.Rmd#L77   it unifies multiple perspectives on is ...
vignettes/TSENAT.Rmd#L78   framework. ...
vignettes/TSENAT.Rmd#L80   q-curves, `S_q` supports concise repor ...
vignettes/TSENAT.Rmd#L81   slope/AUC summaries) and targeted foll ...
vignettes/TSENAT.Rmd#L89   \(S_{q,\max}(m)=\frac{1-m^{1-q}}{q-1}\ ...
vignettes/TSENAT.Rmd#L90   \(\tilde S_q = S_q / S_{q,\max}(m)\). ...
vignettes/TSENAT.Rmd#L95   low-abundance (rare) isoforms; separat ...
vignettes/TSENAT.Rmd#L96   in dominant isoforms. When both regime ...
vignettes/TSENAT.Rmd#L97   divergence across the entire `q` range ...
vignettes/TSENAT.Rmd#L99   clarity: `D_q` converts entropies into ...
vignettes/TSENAT.Rmd#L100   isoforms" that is easy to interpret. ...
vignettes/TSENAT.Rmd#L109   library(TSENAT) ...
vignettes/TSENAT.Rmd#L110   library(ggplot2) ...
vignettes/TSENAT.Rmd#L111   library(SummarizedExperiment) ...
vignettes/TSENAT.Rmd#L112   library(mgcv) ...
vignettes/TSENAT.Rmd#L183   ts_se <- map_coldata_to_se(ts_se, cold ...
vignettes/TSENAT.Rmd#L186   ...
vignettes/TSENAT.Rmd#L197   - Use when you want a distribution-fre ...
vignettes/TSENAT.Rmd#L200   - Assumptions: independent observation ...
vignettes/TSENAT.Rmd#L202   - Handle ties: software returns approx ...
vignettes/TSENAT.Rmd#L205   - Report effect sizes (median differen ...
vignettes/TSENAT.Rmd#L209   - Use when sample sizes are small, dis ...
vignettes/TSENAT.Rmd#L213   - Exchangeability requirement: permuta ...
vignettes/TSENAT.Rmd#L217   - Practical settings: set `randomizati ...
vignettes/TSENAT.Rmd#L246   control = "Normal", ...
vignettes/TSENAT.Rmd#L247   method = "mean", test = "wilcoxon", ...
vignettes/TSENAT.Rmd#L248   paired = TRUE ...
vignettes/TSENAT.Rmd#L252   res <- res[order(res$adjusted_p_values ...
vignettes/TSENAT.Rmd#L260   helping to spot genes with large effec ...
vignettes/TSENAT.Rmd#L262   highlighting candidates by thresholdin ...
vignettes/TSENAT.Rmd#L271   p_volcano <- plot_volcano(res) ...
vignettes/TSENAT.Rmd#L272   print(p_volcano) ...
vignettes/TSENAT.Rmd#L290   gene = top_genes, ...
vignettes/TSENAT.Rmd#L291   samples = samples_vec, tx2gene = txmap ...
vignettes/TSENAT.Rmd#L292   top_n = NULL ...
vignettes/TSENAT.Rmd#L309   q = q, norm = TRUE ...
vignettes/TSENAT.Rmd#L323   ts_se <- map_coldata_to_se(ts_se, cold ...
vignettes/TSENAT.Rmd#L347   q = qvec, norm = TRUE ...
vignettes/TSENAT.Rmd#L356   ts_se <- map_coldata_to_se(ts_se, cold ...
vignettes/TSENAT.Rmd#L381   - Interprets group differences as slop ...
vignettes/TSENAT.Rmd#L384   - Advantages: simple, interpretable in ...
vignettes/TSENAT.Rmd#L385   - Caveats: will miss localized nonline ...
vignettes/TSENAT.Rmd#L389   - Fit smooth functions of `q` with gro ...
vignettes/TSENAT.Rmd#L392   - Choose spline basis dimension `k` re ...
vignettes/TSENAT.Rmd#L396   - Requires sufficient observations per ...
vignettes/TSENAT.Rmd#L400   - Treat each sample's q-curve as a fun ...
vignettes/TSENAT.Rmd#L402   - Fast and robust when dominant curve  ...
vignettes/TSENAT.Rmd#L405   - Address missing q points by sensible ...
vignettes/TSENAT.Rmd#L428   pseudocount (e.g., +1)  this stabiliz ...
vignettes/TSENAT.Rmd#L429   undefined powers when computing `p_i^q ...
vignettes/TSENAT.Rmd#L431   (suggested: 0.1, 0.2, 0.5, 1, 1.5, 2). ...
vignettes/TSENAT.Rmd#L432   groups diverge rather than relying on  ...
vignettes/TSENAT.Rmd#L434   isoforms") and/or normalized entropy \ ...
vignettes/TSENAT.Rmd#L435   effect size (median/mean difference) a ...
vignettes/TSENAT.Rmd#L437   label-shuffle (permutation) for small  ...
vignettes/TSENAT.Rmd#L438   For permutations use `randomizations`  ...
vignettes/TSENAT.Rmd#L439   very small p-values); use paired permu ...
vignettes/TSENAT.Rmd#L441   raw/adjusted p-values alongside effect ...
vignettes/TSENAT.Rmd#L442   practical relevance. ...
vignettes/TSENAT.Rmd#L444   simple slope differences, GAMs for non ...
vignettes/TSENAT.Rmd#L445   low-dimensional summaries  always rep ...
vignettes/TSENAT.Rmd#L446   `randomizations`). ...
vignettes/TSENAT.Rmd#L448   ensure adequate biological replication ...
vignettes/TSENAT.Rmd#L449   (Salmon/kallisto or UMI-based methods) ...
vignettes/TSENAT.Rmd#L450   include them in models. ...
vignettes/TSENAT.Rmd#L452   perturbation gradients (doseresponse) ...
vignettes/TSENAT.Rmd#L453   or spatial (UMI-based) to study hetero ...
vignettes/TSENAT.Rmd#L454   control subject-level variability. ...
vignettes/TSENAT.Rmd#L456   sufficient sequencing depth for isofor ...
vignettes/TSENAT.Rmd#L457   low-abundance transcripts, and apply b ...
vignettes/TSENAT.Rmd#L458   to downstream testing. Test across a c ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration...
Unable to find your email in the Support Site:
  [1m[22mHTTP 404 Not Found.
