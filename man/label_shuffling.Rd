% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/difference_functions.R
\name{label_shuffling}
\alias{label_shuffling}
\title{Calculate p-values using label shuffling.}
\usage{
label_shuffling(
  x,
  samples,
  control,
  method,
  randomizations = 100,
  pcorr = "BH",
  paired = FALSE
)
}
\arguments{
\item{x}{A \code{matrix} with the splicing diversity values.}

\item{samples}{Character vector with an equal length to the number of columns
in the input dataset, specifying the category of each sample.}

\item{control}{Name of the control sample category, defined in the
\code{samples} vector, e.g. \code{control = 'Normal'} or \code{control =
'WT'}.}

\item{method}{Method to use for calculating the average splicing diversity
value in a condition. Can be \code{'mean'} or \code{'median'}.}

\item{randomizations}{The number of random shuffles.}

\item{pcorr}{P-value correction method applied to the results, as defined in
the \\code{p.adjust} function.}

\item{paired}{Logical; if \code{TRUE} perform a paired permutation scheme
(default: \code{FALSE}). When paired is \code{TRUE}, permutations
should preserve pairing between samples; the function currently permutes
sample labels and therefore paired analyses are only meaningful when the
caller has arranged \code{samples} accordingly.}
}
\value{
Raw and corrected p-values.
}
\description{
Calculate p-values using label shuffling.
}
\details{
The permutation p-values are computed two-sided as the proportion
of permuted log2 fold-changes at least as extreme as the observed value,
with a pseudocount added: (count + 1) / (n_perm + 1).
}
\note{
The permutation test returns two-sided empirical p-values using a
pseudocount to avoid zero p-values for small numbers of permutations. See
the function documentation for details.
}
