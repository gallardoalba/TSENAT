% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/difference_functions.R
\name{calculate_fc}
\alias{calculate_fc}
\title{Calculate splicing diversity changes between two conditions.}
\usage{
calculate_fc(x, samples, control, method = "mean", pseudocount = 0)
}
\arguments{
\item{x}{A \code{matrix} with the splicing diversity values.}

\item{samples}{Character vector with an equal length to the number of columns
in the input dataset, specifying the category of each sample.}

\item{control}{Name of the control sample category, defined in the
\code{samples} vector, e.g. \code{control = 'Normal'} or \code{control =
'WT'}.}

\item{method}{Method to use for calculating the average splicing diversity
value in a condition. Can be \code{'mean'} or \code{'median'}.}

\item{pseudocount}{Numeric scalar. Small value added to non-positive
observed group summaries to avoid zeros when computing differences and
log2 fold-changes. If \code{pseudocount <= 0} the function will automatically
choose a scale-aware value equal to half the smallest positive observed
group summary (i.e. half the smallest observed mean/median across groups);
if no positive values are present the fallback is \code{1e-6}. Rows with
insufficient observations remain \code{NA} and are not imputed.}
}
\value{
A \code{data.frame} with mean or median value of splicing diversity
across sample categories, the difference between these values and the log2
fold change values.
}
\description{
Calculate splicing diversity changes between two conditions.
}
\details{
The function uses a matrix of splicing diversity values in order to
calculate mean or median differences and log2 fold changes between two
conditions.
}
\examples{
# Simulate splicing diversity matrix (4 genes x 4 samples)
mat <- matrix(c(
  0.5, 0.6, 0.8, 0.9,  # gene1: low control, high treatment
  0.7, 0.75, 0.6, 0.5  # gene2: high control, low treatment
), nrow = 2, byrow = TRUE)
samples <- c('Normal', 'Normal', 'Tumor', 'Tumor')
result <- calculate_fc(mat, samples, control = 'Normal', method = 'mean')
head(result)
}
