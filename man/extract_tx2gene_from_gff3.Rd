% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_se.R
\name{extract_tx2gene_from_gff3}
\alias{extract_tx2gene_from_gff3}
\title{Extract Transcript-to-Gene Mapping from GFF3 File}
\usage{
extract_tx2gene_from_gff3(gff3_file)
}
\arguments{
\item{gff3_file}{Path to a GFF3 or GFF3.gz file containing transcript/mRNA
features with ID and Parent attributes.}
}
\value{
A data.frame with two columns (Transcript, Gene) containing the
  transcript-to-gene mapping extracted from the GFF3 file.
}
\description{
Internal function that parses GFF3 or GFF3.gz files to extract
transcript-to-gene mappings. This function is called internally by \code{build_se()}
when a GFF3 file path is provided. Users should not call this function directly.
}
\details{
The function expects GFF3 format with the following structure:
\itemize{
  \item 9 tab-separated columns: seqname, source, feature, start, end,
        score, strand, phase, attributes
  \item Feature type column (3rd column) should contain 'transcript' or 'mRNA'
  \item Attributes column (9th column) should contain ID and Parent fields
  \item ID field: unique identifier for the transcript
  \item Parent field: references the gene ID that this transcript belongs to
}
Example GFF3 line:
\preformatted{chr1\tgencode\ttranscript\t1000\t3000\t.\t+\t.\t
ID=ENST00000001;Parent=ENSG00000101;Name=BRCA1-001}

\strong{Performance:} This function is optimized for large GFF3 files:
\itemize{
  \item Reads files in 10,000-line chunks (not line-by-line)
  \item Uses fast pre-filtering (feature type check before regex)
  \item Employs efficient string operations instead of heavy regex on every line
  \item Handles both compressed (.gz) and uncompressed files seamlessly
}
}
\examples{
# Create a temporary GFF3 file with transcript features
gff3_lines <- c(
  'chr1\tgencode\ttranscript\t1000\t3000\t.\t+\t.\tID=ENST001;Parent=ENSG001',
  'chr1\tgencode\ttranscript\t1500\t3500\t.\t+\t.\tID=ENST002;Parent=ENSG001',
  'chr2\tgencode\ttranscript\t5000\t8000\t.\t-\t.\tID=ENST003;Parent=ENSG002'
)
tf <- tempfile(fileext = '.gff3')
writeLines(gff3_lines, tf)

# Extract transcript-to-gene mapping
tx2gene <- extract_tx2gene_from_gff3(tf)
head(tx2gene)
}
