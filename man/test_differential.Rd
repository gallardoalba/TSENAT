% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/difference_functions.R
\name{test_differential}
\alias{test_differential}
\title{Run a differential test by name: Wilcoxon or label-shuffle}
\usage{
test_differential(
  x,
  samples,
  control = NULL,
  method = c("wilcoxon", "shuffle"),
  fc_method = "mean",
  paired = FALSE,
  exact = FALSE,
  randomizations = 100,
  pcorr = "BH",
  seed = 123L,
  paired_method = c("swap", "signflip")
)
}
\arguments{
\item{x}{A matrix with splicing diversity values (rows = features).}

\item{samples}{Character vector of sample group labels (length = ncol(x)).}

\item{control}{Name of the control group (required for label-shuffle).}

\item{method}{Character; one of `'wilcoxon'` or `'shuffle'`.}

\item{fc_method}{Character; aggregation method used by the permutation
test when `method = 'shuffle'` ('mean' or 'median').}

\item{paired}{Logical passed to `wilcoxon()` when using the Wilcoxon test.}

\item{exact}{Logical passed to `wilcoxon()` to request exact p-values.}

\item{randomizations}{Integer number of permutations for `label_shuffling()`.}

\item{pcorr}{P-value adjustment method (passed to `p.adjust`).}

\item{seed}{Integer seed used to make permutations reproducible (default
123). The function sets a temporary RNG seed via `withr::local_seed(seed)`
before running `label_shuffling()` when `method = 'shuffle'`.}

\item{paired_method}{Character; forwarded to `label_shuffling()` when
`method = 'shuffle'`. See `label_shuffling()` for details.}
}
\value{
A two-column matrix with raw and adjusted p-values (as returned by
  the underlying functions).
}
\description{
Thin wrapper that selects between `wilcoxon()` and `label_shuffling()`.
}
\examples{
mat <- matrix(rnorm(20), nrow = 5)
samples <- rep(c('A','B'), length.out = ncol(mat))
test_differential(mat, samples, control = 'A', method = 'wilcoxon')

}
