% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_difference.R
\name{calculate_lm_interaction}
\alias{calculate_lm_interaction}
\title{Linear-model interaction test for Tsallis entropy}
\usage{
calculate_lm_interaction(se, sample_type_col = NULL, min_obs = 10,
  method = c("linear", "gam", "fpca"), nthreads = 1, assay_name = "diversity")
}
\arguments{
\item{se}{A `SummarizedExperiment` containing a `diversity` assay produced
by `calculate_diversity(..., method = "tsallis", q = <vector>)`.}

\item{sample_type_col}{Optional column name in `colData(se)` that contains
a grouping factor for samples (character). If `NULL`, the function will
attempt to infer group from column names (suffix `_N` interpreted as
"Normal").}

\item{min_obs}{Minimum number of non-NA observations required to fit a
model for a gene (default: 10).}

\item{method}{Character; fitting method: "linear", "gam", or "fpca".}

\item{nthreads}{Integer; number of threads to use for parallel processing (currently unused).}

\item{assay_name}{Character; name of the assay in `se` to use (default: "diversity").}
}
\value{
A data.frame with columns `gene`, `p_interaction`, and
  `adj_p_interaction`, ordered by ascending `p_interaction`.
}
\description{
For each gene, fit a linear model of the form `entropy ~ q * group` and
extract the p-value for the interaction term (whether the effect of `q`
differs between groups). The function expects a `SummarizedExperiment`
produced by `calculate_diversity()` when `method = "tsallis"` and multiple
`q` values have been computed (column names contain `_q=`).
}
