<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate splicing diversity changes between two conditions. — calculate_difference • TSENAT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate splicing diversity changes between two conditions. — calculate_difference"><meta name="description" content="Calculate splicing diversity changes between two conditions."><meta property="og:description" content="Calculate splicing diversity changes between two conditions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TSENAT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa far fa-file-code fa-lg"></span> Functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT"><span class="fa fab fa-github fa-lg"></span> Source Code</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/issues"><span class="fa fas fa-question-circle fa-lg"></span> Issues</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html"><span class="fa fas fa-file-contract fa-lg"></span> Vignettes</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignette-files" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book fa-lg"></span> Vignette Files</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignette-files"><li><a class="dropdown-item" href="../articles/TSENAT.pdf">PDF (vignette)</a></li>
    <li><a class="dropdown-item" href="../articles/TSENAT.html">HTML (vignette)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate splicing diversity changes between two conditions.</h1>
      <small class="dont-index">Source: <a href="https://github.com/gallardoalba/TSENAT/blob/HEAD/R/calculate_difference.R" class="external-link"><code>R/calculate_difference.R</code></a></small>
      <div class="d-none name"><code>calculate_difference.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate splicing diversity changes between two conditions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_difference</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">samples</span>,</span>
<span>  <span class="va">control</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  test <span class="op">=</span> <span class="st">"wilcoxon"</span>,</span>
<span>  randomizations <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  pcorr <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  assayno <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>SummarizedExperiment</code> with splicing diversity values for
each gene in each sample or a <code>data.frame</code> with gene names in the
first column and splicing diversity values for each sample in additional
columns.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>A vector of length one, specifying the column name of the
<code>colData</code> annotation column from the <code>SummarizedExperiment</code>
object, that should be used as the category column or a character vector
with an equal length to the number of columns in the input dataset,
specifying the category of each sample in the case of a <code>data.frame</code>
input.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Name of the control sample category, defined in the
<code>samples</code> vector, e.g. <code>control = 'Normal'</code> or <code>control =
'WT'</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method to use for calculating the average splicing diversity
value in a condition. Can be <code>'mean'</code> or <code>'median'</code>.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>Method to use for p-value calculation: use <code>'wilcoxon'</code> for
Wilcoxon rank sum test or <code>'shuffle'</code> for a label shuffling test.</p></dd>


<dt id="arg-randomizations">randomizations<a class="anchor" aria-label="anchor" href="#arg-randomizations"></a></dt>
<dd><p>Number of random shuffles, used for the label shuffling
test (default = 100).</p></dd>


<dt id="arg-pcorr">pcorr<a class="anchor" aria-label="anchor" href="#arg-pcorr"></a></dt>
<dd><p>P-value correction method applied to the Wilcoxon rank sum test
or label shuffling test results, as defined in the <code>p.adjust</code>
function.</p></dd>


<dt id="arg-assayno">assayno<a class="anchor" aria-label="anchor" href="#arg-assayno"></a></dt>
<dd><p>An integer value. In case of multiple assays in a
<code>SummarizedExperiment</code> input, the argument specifies the assay number
to use for difference calculations.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code>, the function will print additional diagnostic
messages.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed on for other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with the mean or median values of splicing
  diversity across sample categories and all samples, log2(fold change) of
  the two different conditions, raw and corrected p-values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function calculates diversity changes between two sample
conditions. It uses the output of the diversity calculation function, which
is a <code>SummarizedExperiment</code> object of splicing diversity values.
Additionally, it can use a <code>data.frame</code> as input, where the first column
contains gene names, and all additional columns contain splicing diversity
values for each sample. A vector of sample conditions also serves as input,
used for aggregating the samples by condition.</p>
<p>It calculates the mean or median of the splicing diversity data per sample
condition, the difference of these values and the log2 fold change of the two
conditions. Furthermore, the user can select a statistical method to
calculate the significance of the changes. The p-values and adjusted p-values
are calculated using a Wilcoxon sum rank test or label shuffling test.</p>
<p>The function will exclude genes of low sample size from the significance
calculation, depending on which statistical test is applied.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># data.frame with splicing diversity values</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Genes <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sample categories</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Healthy"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Pathogenic"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To calculate the difference of splicing diversity changes between the</span></span></span>
<span class="r-in"><span><span class="co"># 'Healthy' and 'Pathogenic' condition together with the significance values,</span></span></span>
<span class="r-in"><span><span class="co"># using mean and Wilcoxon rank sum test, use:</span></span></span>
<span class="r-in"><span><span class="fu">calculate_difference</span><span class="op">(</span><span class="va">x</span>, <span class="va">samples</span>, control <span class="op">=</span> <span class="st">"Healthy"</span>, method <span class="op">=</span> <span class="st">"mean"</span>, test <span class="op">=</span></span></span>
<span class="r-in"><span><span class="st">"wilcoxon"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    genes Pathogenic_mean Healthy_mean mean_difference log2_fold_change</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      a       0.3536153    0.4177882    -0.064172864      -0.24059093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      b       0.4983910    0.3275041     0.170886910       0.60576503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      c       0.3939888    0.4673230    -0.073334138      -0.24626521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      d       0.4391230    0.4589390    -0.019816020      -0.06367737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      e       0.5746470    0.4147989     0.159848098       0.47026392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      f       0.7016257    0.4580544     0.243571275       0.61518255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      g       0.6093560    0.4994365     0.109919512       0.28698410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      h       0.3516991    0.6633813    -0.311682200      -0.91549669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      i       0.5652513    0.4689715     0.096279798       0.26939212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     j       0.3903022    0.3944323    -0.004130123      -0.01518619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    raw_p_values adjusted_p_values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     0.6650055         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0.1939309         0.9696543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1.0000000         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1.0000000         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.6650055         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     0.1939309         0.9696543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     0.6650055         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     0.3123214         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     0.8852339         1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    0.8852339         1.0000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gallardoalba" class="external-link">Cristóbal Gallardo</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

