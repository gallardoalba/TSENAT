<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate splicing diversity changes between two conditions. — calculate_difference • TSENAT</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate splicing diversity changes between two conditions. — calculate_difference"><meta property="og:description" content="Calculate splicing diversity changes between two conditions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TSENAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/TSENAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gallardoalba/TSENAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate splicing diversity changes between two conditions.</h1>
    <small class="dont-index">Source: <a href="https://github.com/gallardoalba/TSENAT/blob/HEAD/R/calculate_difference.R" class="external-link"><code>R/calculate_difference.R</code></a></small>
    <div class="hidden name"><code>calculate_difference.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate splicing diversity changes between two conditions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_difference</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">control</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  test <span class="op">=</span> <span class="st">"wilcoxon"</span>,</span>
<span>  randomizations <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  pcorr <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  assayno <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>SummarizedExperiment</code> with splicing diversity values for
each gene in each sample or a <code>data.frame</code> with gene names in the  first
column and splicing diversity values for each sample in additional  columns.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>A vector of length one, specifying the column name of the
<code>colData</code> annotation column from the <code>SummarizedExperiment</code>
object, that should be used as the category column or a character vector
with an equal length to the number of columns in the input dataset,
specifying the category of each sample in the case of a <code>data.frame</code>
input.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Name of the control sample category, defined in the
<code>samples</code> vector, e.g. <code>control = 'Normal'</code> or <code>control =
'WT'</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method to use for calculating the average splicing diversity
value in a condition. Can be <code>'mean'</code> or <code>'median'</code>.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>Method to use for p-value calculation: use <code>'wilcoxon'</code> for
Wilcoxon rank sum test or <code>'shuffle'</code> for a label shuffling test.</p></dd>


<dt id="arg-randomizations">randomizations<a class="anchor" aria-label="anchor" href="#arg-randomizations"></a></dt>
<dd><p>Number of random shuffles, used for the label shuffling
test (default = 100).</p></dd>


<dt id="arg-pcorr">pcorr<a class="anchor" aria-label="anchor" href="#arg-pcorr"></a></dt>
<dd><p>P-value correction method applied to the Wilcoxon rank sum test
or label shuffling test results, as defined in the <code>p.adjust</code>  function.</p></dd>


<dt id="arg-assayno">assayno<a class="anchor" aria-label="anchor" href="#arg-assayno"></a></dt>
<dd><p>An integer value. In case of multiple assays in a
<code>SummarizedExperiment</code> input, the argument specifies the assay number
to use for difference calculations.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code>, the function will print additional diagnostic
messages.</p></dd>


<dt id="arg-paired">paired<a class="anchor" aria-label="anchor" href="#arg-paired"></a></dt>
<dd><p>Logical; if `TRUE`, run paired versions of tests when
supported (default: `FALSE`).</p></dd>


<dt id="arg-exact">exact<a class="anchor" aria-label="anchor" href="#arg-exact"></a></dt>
<dd><p>Logical; passed to the Wilcoxon test to request exact p-values
when supported (default: `FALSE`).</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>Numeric scalar. Passed to <code>calculate_fc</code> and used to
add a small value to non-positive group summaries before computing
differences and log2 fold-changes. Default <code>1e-6</code>. Rows excluded for
low sample counts remain <code>NA</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data.frame</code> with the mean or median values of splicing
diversity across sample categories and all samples, log2(fold change) of  the
two different conditions, raw and corrected p-values.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function calculates diversity changes between two sample
conditions. It uses the output of the diversity calculation function, which
is a <code>SummarizedExperiment</code> object of splicing diversity values.
Additionally, it can use a <code>data.frame</code> as input, where the first column
contains gene names, and all additional columns contain splicing diversity
values for each sample. A vector of sample conditions also serves as input,
used for aggregating the samples by condition.   It calculates the mean or
median of the splicing diversity data per sample  condition, the difference
of these values and the log2 fold change of the two  conditions. Furthermore,
the user can select a statistical method to  calculate the significance of
the changes. The p-values and adjusted p-values  are calculated using a
Wilcoxon sum rank test or label shuffling test.   The function will exclude
genes of low sample size from the significance  calculation, depending on
which statistical test is applied.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Genes <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Healthy"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Pathogenic"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">calculate_difference</span><span class="op">(</span><span class="va">x</span>, <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    control <span class="op">=</span> <span class="st">"Healthy"</span>, method <span class="op">=</span> <span class="st">"mean"</span>, test <span class="op">=</span></span></span>
<span class="r-in"><span>        <span class="st">"wilcoxon"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    genes Pathogenic_mean Healthy_mean mean_difference log2_fold_change</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      a       0.3939888    0.4673230    -0.073334138      -0.24626521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      b       0.4391230    0.4589390    -0.019816020      -0.06367737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      c       0.5746470    0.4147989     0.159848098       0.47026392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      d       0.7016257    0.4580544     0.243571275       0.61518255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      e       0.6093560    0.4994365     0.109919512       0.28698410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      f       0.3516991    0.6633813    -0.311682200      -0.91549669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      g       0.5652513    0.4689715     0.096279798       0.26939212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      h       0.3903022    0.3944323    -0.004130123      -0.01518619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      i       0.2585383    0.4280178    -0.169479477      -0.72729271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     j       0.4058325    0.4532731    -0.047440614      -0.15949619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    raw_p_values adjusted_p_values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1.0000000                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.0000000                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.6650055                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     0.1939309                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.6650055                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     0.3123214                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     0.8852339                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     0.8852339                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     0.3123214                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    0.8852339                 1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Cristóbal Gallardo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

