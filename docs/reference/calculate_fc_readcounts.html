<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute fold changes from read counts with transcript collapsing. — calculate_fc_readcounts • TSENAT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute fold changes from read counts with transcript collapsing. — calculate_fc_readcounts"><meta name="description" content="This function aggregates read counts at the gene level (collapsing multiple
transcripts per gene) and then computes fold changes between two conditions.
Useful for plotting read count changes in MA plots alongside diversity-based
p-values."><meta property="og:description" content="This function aggregates read counts at the gene level (collapsing multiple
transcripts per gene) and then computes fold changes between two conditions.
Useful for plotting read count changes in MA plots alongside diversity-based
p-values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TSENAT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa far fa-file-code fa-lg"></span> Functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT"><span class="fa fab fa-github fa-lg"></span> Source Code</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/issues"><span class="fa fas fa-question-circle fa-lg"></span> Issues</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html"><span class="fa fas fa-file-contract fa-lg"></span> Vignettes</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignette-files" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book fa-lg"></span> Vignette Files</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignette-files"><li><a class="dropdown-item" href="../articles/TSENAT.pdf">PDF (vignette)</a></li>
    <li><a class="dropdown-item" href="../articles/TSENAT.html">HTML (vignette)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute fold changes from read counts with transcript collapsing.</h1>
      <small class="dont-index">Source: <a href="https://github.com/gallardoalba/TSENAT/blob/HEAD/R/difference_functions.R" class="external-link"><code>R/difference_functions.R</code></a></small>
      <div class="d-none name"><code>calculate_fc_readcounts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function aggregates read counts at the gene level (collapsing multiple
transcripts per gene) and then computes fold changes between two conditions.
Useful for plotting read count changes in MA plots alongside diversity-based
p-values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_fc_readcounts</span><span class="op">(</span></span>
<span>  <span class="va">readcounts</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">samples</span>,</span>
<span>  <span class="va">control</span>,</span>
<span>  agg_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  fc_method <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-readcounts">readcounts<a class="anchor" aria-label="anchor" href="#arg-readcounts"></a></dt>
<dd><p>A data.frame or matrix with read counts. If a data.frame,
the first column should contain gene identifiers. If a matrix, rownames
should contain gene identifiers.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character vector of gene names corresponding to each row of
readcounts. If readcounts is a data.frame with gene names in the first
column, this can be omitted.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Character vector with length equal to the number of count
columns, specifying the category of each sample.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Name of the control sample category, as defined in the
`samples` vector (e.g., `'Normal'` or `'Control'`).</p></dd>


<dt id="arg-agg-method">agg_method<a class="anchor" aria-label="anchor" href="#arg-agg-method"></a></dt>
<dd><p>Method to use for aggregating transcripts to genes.
Can be `'mean'` (default) or `'median'`.</p></dd>


<dt id="arg-fc-method">fc_method<a class="anchor" aria-label="anchor" href="#arg-fc-method"></a></dt>
<dd><p>Method for computing fold changes (default: `'mean'`).
Can be `'mean'` or `'median'`.</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>Numeric scalar passed to `calculate_fc()`. Default is 0
(scale-aware pseudocount).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame with columns:</p><dl><dt>genes</dt>
<dd><p>Gene identifiers.</p></dd>

  <dt>&lt;treatment&gt;_&lt;fc_method&gt;</dt>
<dd><p>Aggregated value for treatment condition.</p></dd>

  <dt>&lt;control&gt;_&lt;fc_method&gt;</dt>
<dd><p>Aggregated value for control condition.</p></dd>

  <dt>&lt;fc_method&gt;_difference</dt>
<dd><p>Simple difference.</p></dd>

  <dt>log2_fold_change</dt>
<dd><p>log2(treatment / control) fold change.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If readcounts contains multiple rows per gene (e.g., different
transcripts), they are first aggregated to the gene level using the specified
aggregation method (mean or median). Then fold changes are computed using
`calculate_fc()`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create example read count data with transcripts</span></span></span>
<span class="r-in"><span><span class="va">rc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GENE1"</span>, <span class="st">"GENE1"</span>, <span class="st">"GENE2"</span>, <span class="st">"GENE2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sample1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">200</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sample2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">60</span>, <span class="fl">180</span>, <span class="fl">90</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sample3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">40</span>, <span class="fl">250</span>, <span class="fl">120</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sample4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">45</span>, <span class="fl">270</span>, <span class="fl">130</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"control"</span>, <span class="st">"treatment"</span>, <span class="st">"treatment"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">calculate_fc_readcounts</span><span class="op">(</span><span class="va">rc_data</span>, samples <span class="op">=</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>                        control <span class="op">=</span> <span class="st">"control"</span>, agg_method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       treatment_mean control_mean mean_difference log2_fold_change genes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GENE1          63.75         82.5          -18.75       -0.3719688 GENE1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GENE2         192.50        142.5           50.00        0.4338965 GENE2</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gallardoalba" class="external-link">Cristóbal Gallardo</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

