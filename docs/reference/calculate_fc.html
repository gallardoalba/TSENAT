<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate fold changes independently of statistical testing. — calculate_fc • TSENAT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate fold changes independently of statistical testing. — calculate_fc"><meta name="description" content="Computes mean or median fold changes and differences between two sample
conditions. This function is independent of statistical testing and can be
used to calculate fold changes for any comparison of interest."><meta property="og:description" content="Computes mean or median fold changes and differences between two sample
conditions. This function is independent of statistical testing and can be
used to calculate fold changes for any comparison of interest."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TSENAT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa far fa-file-code fa-lg"></span> Functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT"><span class="fa fab fa-github fa-lg"></span> Source Code</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/issues"><span class="fa fas fa-question-circle fa-lg"></span> Issues</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html"><span class="fa fas fa-file-contract fa-lg"></span> Vignettes</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignette-files" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book fa-lg"></span> Vignette Files</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignette-files"><li><a class="dropdown-item" href="../articles/TSENAT.pdf">PDF (vignette)</a></li>
    <li><a class="dropdown-item" href="../articles/TSENAT.html">HTML (vignette)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/gallardoalba/TSENAT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate fold changes independently of statistical testing.</h1>
      <small class="dont-index">Source: <a href="https://github.com/gallardoalba/TSENAT/blob/HEAD/R/difference_functions.R" class="external-link"><code>R/difference_functions.R</code></a></small>
      <div class="d-none name"><code>calculate_fc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes mean or median fold changes and differences between two sample
conditions. This function is independent of statistical testing and can be
used to calculate fold changes for any comparison of interest.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_fc</span><span class="op">(</span><span class="va">x</span>, <span class="va">samples</span>, <span class="va">control</span>, method <span class="op">=</span> <span class="st">"mean"</span>, pseudocount <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>matrix</code> with the splicing diversity values (rows = features,
columns = samples).</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Character vector with length equal to the number of columns
in <code>x</code>, specifying the category of each sample.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Name of the control sample category, as defined in the
<code>samples</code> vector (e.g., <code>'Normal'</code> or <code>'WT'</code>). The fold change
is computed as treatment / control.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method to use for aggregating values within each condition.
Can be <code>'mean'</code> or <code>'median'</code>. Default: <code>'mean'</code>.</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>Numeric scalar. Small value added to non-positive
observed group summaries to avoid zeros when computing differences and
log2 fold-changes. If <code>pseudocount &lt;= 0</code> (default), the function
automatically chooses a scale-aware value equal to half the smallest positive
observed group summary across both groups. If no positive values are present,
the fallback is <code>1e-6</code>. Rows with all <code>NA</code> values remain <code>NA</code>
and are not imputed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns:</p><dl><dt>&lt;treatment&gt;_&lt;method&gt;</dt>
<dd><p>Aggregated value (mean or median) for the
    treatment condition.</p></dd>

  <dt>&lt;control&gt;_&lt;method&gt;</dt>
<dd><p>Aggregated value (mean or median) for the
    control condition.</p></dd>

  <dt>&lt;method&gt;_difference</dt>
<dd><p>Simple difference between treatment and control.</p></dd>

  <dt>log2_fold_change</dt>
<dd><p>log2(treatment / control) fold change.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function computes group-wise summaries (mean or median) for each
condition, then calculates the difference and log2 fold change. Pseudocounts
are applied before log-transformation to handle non-positive values.
Rows with insufficient non-NA observations in either condition remain <code>NA</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create example diversity matrix</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">4</span>, <span class="fl">2.5</span>, <span class="fl">1.5</span>, <span class="fl">3.5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"control"</span>, <span class="st">"treatment"</span>, <span class="st">"treatment"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">calculate_fc</span><span class="op">(</span><span class="va">mat</span>, <span class="va">samples</span>, control <span class="op">=</span> <span class="st">"control"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    treatment_mean control_mean mean_difference log2_fold_change</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V1           2.75         1.50            1.25        0.8744691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2           3.00         1.75            1.25        0.7776076</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gallardoalba" class="external-link">Cristóbal Gallardo</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

